---
title: Day064ï¼šäº‘ä¸å®¹å™¨å®‰å…¨ - äº‘å…±äº«è´£ä»»æ¨¡å‹ä¸è´¦å·æƒé™
tags:
  - ç½‘ç»œ
  - å®‰å…¨
  - å­¦ä¹ è®¡åˆ’
categories:
  - ç½‘ç»œå®‰å…¨
abbrlink: 3bc94366
date: 2026-02-26 00:00:00
updated: 2026-02-26 00:00:00
---

# Day064ï¼šäº‘ä¸å®¹å™¨å®‰å…¨ - äº‘å…±äº«è´£ä»»æ¨¡å‹ä¸è´¦å·æƒé™

- æ—¥æœŸï¼š2026-02-26
- å‘¨æ¬¡ï¼šç¬¬10å‘¨

## å­¦ä¹ ç›®æ ‡

ä»Šå¤©ä½ å°†æŒæ¡äº‘å®‰å…¨çš„åŸºç¡€çŸ¥è¯†å’Œè´¦å·æƒé™ç®¡ç†ï¼š

- **ç†è§£å…±äº«è´£ä»»æ¨¡å‹**ï¼šæ˜ç¡®äº‘æœåŠ¡æä¾›å•†å’Œå®¢æˆ·ä¹‹é—´çš„å®‰å…¨è´£ä»»åˆ’åˆ†
- **æŒæ¡äº‘è´¦å·ä½“ç³»**ï¼šç†è§£äº‘è´¦å·ã€æ ¹è´¦å·ã€å­è´¦å·ã€è§’è‰²ä¹‹é—´çš„å…³ç³»
- **å®æ–½æœ€å°æƒé™åŸåˆ™**ï¼šè®¾è®¡å¹¶å®æ–½åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶
- **ç®¡ç†äº‘ä¸Šå‡­æ®**ï¼šå®‰å…¨åœ°ç®¡ç† API å¯†é’¥ã€è®¿é—®å‡­è¯
- **é…ç½®èº«ä»½ federation**ï¼šå®ç°ä¼ä¸šèº«ä»½ç³»ç»Ÿä¸äº‘å¹³å°çš„é›†æˆ

---

<!--more-->

## å­¦ä¹ å†…å®¹

### 1ï¸âƒ£ å…±äº«è´£ä»»æ¨¡å‹

#### 1.1 æ¨¡å‹æ¦‚è¿°

```python
#!/usr/bin/env python3
"""
äº‘å…±äº«è´£ä»»æ¨¡å‹
"""
from __future__ import annotations
from dataclasses import dataclass
from enum import Enum
from typing import Optional, list


class ServiceModel(Enum):
    """äº‘æœåŠ¡æ¨¡å‹"""
    IaaS = "åŸºç¡€è®¾æ–½å³æœåŠ¡"      # å®¢æˆ·è´Ÿè´£ï¼šæ“ä½œç³»ç»Ÿã€ä¸­é—´ä»¶ã€è¿è¡Œæ—¶ã€åº”ç”¨ã€æ•°æ®
    PaaS = "å¹³å°å³æœåŠ¡"          # å®¢æˆ·è´Ÿè´£ï¼šåº”ç”¨ã€æ•°æ®
    SaaS = "è½¯ä»¶å³æœåŠ¡"          # å®¢æˆ·è´Ÿè´£ï¼šç”¨æˆ·å’Œè®¿é—®ç®¡ç†
    FaaS = "åŠŸèƒ½å³æœåŠ¡"          # å®¢æˆ·è´Ÿè´£ï¼šå‡½æ•°ä»£ç ã€é…ç½®ã€ secrets


class ResponsibilityLayer(Enum):
    """è´£ä»»å±‚æ¬¡"""
    PHYSICAL = "ç‰©ç†å®‰å…¨"           # äº‘æä¾›å•†
    NETWORK_INFRA = "ç½‘ç»œåŸºç¡€è®¾æ–½"   # äº‘æä¾›å•†
    NETWORK_CONFIG = "ç½‘ç»œé…ç½®"      # å…±äº«
    HYPERVISOR = "è™šæ‹ŸåŒ–å±‚"          # äº‘æä¾›å•†
    OS = "æ“ä½œç³»ç»Ÿ"                  # å…±äº«
    MIDDLEWARE = "ä¸­é—´ä»¶"            # å…±äº«
    RUNTIME = "è¿è¡Œæ—¶"               # å…±äº«
    APPLICATION = "åº”ç”¨ç¨‹åº"         # å®¢æˆ·
    DATA = "æ•°æ®"                    # å®¢æˆ·
    IDENTITY = "èº«ä»½ä¸è®¿é—®ç®¡ç†"       # å…±äº«
    ENDPOINT = "ç»ˆç«¯è®¾å¤‡"            # å®¢æˆ·
    USER = "ç”¨æˆ·è¡Œä¸º"                 # å®¢æˆ·


@dataclass
class ResponsibilityMatrix:
    """è´£ä»»çŸ©é˜µ"""
    layer: ResponsibilityLayer
    iaas: str  # äº‘æä¾›å•† / å®¢æˆ·
    paas: str
    saas: str
    description: str


class SharedResponsibilityModel:
    """å…±äº«è´£ä»»æ¨¡å‹"""
    
    def __init__(self):
        self.responsibility_matrix: list[ResponsibilityMatrix] = []
        
    def get_responsibility_matrix(self) -> list[ResponsibilityMatrix]:
        """è·å–è´£ä»»çŸ©é˜µ"""
        matrix = [
            ResponsibilityMatrix(
                layer=ResponsibilityLayer.PHYSICAL,
                iaas="æä¾›å•†",
                paas="æä¾›å•†",
                saas="æä¾›å•†",
                description="æ•°æ®ä¸­å¿ƒç‰©ç†å®‰å…¨ã€é—¨ç¦ã€ç›‘æ§"
            ),
            ResponsibilityMatrix(
                layer=ResponsibilityLayer.NETWORK_INFRA,
                iaas="æä¾›å•†",
                paas="æä¾›å•†",
                saas="æä¾›å•†",
                description="ç½‘ç»œåŸºç¡€è®¾æ–½ã€äº¤æ¢æœºã€è·¯ç”±å™¨"
            ),
            ResponsibilityMatrix(
                layer=ResponsibilityLayer.NETWORK_CONFIG,
                iaas="å…±äº«",
                paas="æä¾›å•†",
                saas="æä¾›å•†",
                description="å®‰å…¨ç»„é…ç½®ã€ç½‘ç»œ ACLã€è·¯ç”±è¡¨"
            ),
            ResponsibilityMatrix(
                layer=ResponsibilityLayer.HYPERVISOR,
                iaas="æä¾›å•†",
                paas="æä¾›å•†",
                saas="æä¾›å•†",
                description="è™šæ‹Ÿæœºç›‘æ§å™¨ã€è™šæ‹ŸåŒ–è½¯ä»¶"
            ),
            ResponsibilityMatrix(
                layer=ResponsibilityLayer.OS,
                iaas="å…±äº«",
                paas="æä¾›å•†",
                saas="æä¾›å•†",
                description="æ“ä½œç³»ç»Ÿå®‰å…¨æ›´æ–°ã€è¡¥ä¸"
            ),
            ResponsibilityMatrix(
                layer=ResponsibilityLayer.MIDDLEWARE,
                iaas="å…±äº«",
                paas="æä¾›å•†",
                saas="æä¾›å•†",
                description="æ•°æ®åº“ã€ä¸­é—´ä»¶ã€è¿è¡Œæ—¶ç¯å¢ƒ"
            ),
            ResponsibilityMatrix(
                layer=ResponsibilityLayer.RUNTIME,
                iaas="å…±äº«",
                paas="å…±äº«",
                saas="æä¾›å•†",
                description="å®¹å™¨è¿è¡Œæ—¶ã€è¯­è¨€è¿è¡Œæ—¶"
            ),
            ResponsibilityMatrix(
                layer=ResponsibilityLayer.APPLICATION,
                iaas="å®¢æˆ·",
                paas="å®¢æˆ·",
                saas="æä¾›å•†",
                description="åº”ç”¨ç¨‹åºä»£ç ã€ä¸šåŠ¡é€»è¾‘"
            ),
            ResponsibilityMatrix(
                layer=ResponsibilityLayer.DATA,
                iaas="å®¢æˆ·",
                paas="å®¢æˆ·",
                saas="å®¢æˆ·",
                description="æ•°æ®åŠ å¯†ã€æ•°æ®åˆ†ç±»ã€æ•°æ®å¤‡ä»½"
            ),
            ResponsibilityMatrix(
                layer=ResponsibilityLayer.IDENTITY,
                iaas="å…±äº«",
                paas="å…±äº«",
                saas="å…±äº«",
                description="èº«ä»½è®¤è¯ã€è®¿é—®æ§åˆ¶ã€æƒé™ç®¡ç†"
            ),
            ResponsibilityMatrix(
                layer=ResponsibilityLayer.ENDPOINT,
                iaas="å®¢æˆ·",
                paas="å®¢æˆ·",
                saas="å®¢æˆ·",
                description="ç»ˆç«¯è®¾å¤‡å®‰å…¨ã€EDR"
            ),
            ResponsibilityMatrix(
                layer=ResponsibilityLayer.USER,
                iaas="å®¢æˆ·",
                paas="å®¢æˆ·",
                saas="å®¢æˆ·",
                description="ç”¨æˆ·å®‰å…¨æ„è¯†ã€æ“ä½œè§„èŒƒ"
            )
        ]
        
        self.responsibility_matrix = matrix
        return matrix
    
    def generate_responsibility_report(self, service_model: ServiceModel) -> str:
        """ç”Ÿæˆè´£ä»»æŠ¥å‘Š"""
        matrix = self.get_responsibility_matrix()
        model_key = service_model.name.lower()  # iaas, paas, saas
        
        report = f"# å…±äº«è´£ä»»æ¨¡å‹æŠ¥å‘Š - {service_model.value}\n\n"
        
        report += "## è´£ä»»åˆ’åˆ†æ¦‚è§ˆ\n\n"
        report += "| å±‚æ¬¡ | è´£ä»»æ–¹ | è¯´æ˜ |\n"
        report += "|------|--------|------|\n"
        
        for item in matrix:
            provider_customer = getattr(item, model_key)
            if provider_customer == "æä¾›å•†":
                provider_customer = "ğŸŸ¢ æä¾›å•†"
            elif provider_customer == "å®¢æˆ·":
                provider_customer = "ğŸ”´ å®¢æˆ·"
            else:
                provider_customer = "ğŸŸ¡ å…±äº«"
                
            report += f"| {item.layer.value} | {provider_customer} | {item.description} |\n"
        
        report += "\n## å®¢æˆ·å…³é”®è´£ä»»\n\n"
        
        customer_responsibilities = []
        for item in matrix:
            if getattr(item, model_key) in ["å®¢æˆ·", "å…±äº«"]:
                customer_responsibilities.append(item)
        
        for item in customer_responsibilities:
            report += f"### {item.layer.value}\n\n"
            report += f"{item.description}\n\n"
            
            # å…·ä½“ä»»åŠ¡
            if item.layer == ResponsibilityLayer.DATA:
                report += "**å…·ä½“ä»»åŠ¡**:\n"
                report += "- æ•°æ®åˆ†ç±»ä¸æ ‡ç­¾\n"
                report += "- æ•°æ®åŠ å¯†ï¼ˆé™æ€å’Œä¼ è¾“ä¸­ï¼‰\n"
                report += "- æ•°æ®å¤‡ä»½ä¸æ¢å¤\n"
                report += "- æ•°æ®è®¿é—®å®¡è®¡\n\n"
            elif item.layer == ResponsibilityLayer.IDENTITY:
                report += "**å…·ä½“ä»»åŠ¡**:\n"
                report += "- å¤šå› ç´ è®¤è¯\n"
                report += "- æœ€å°æƒé™åŸåˆ™\n"
                report += "- å®šæœŸæƒé™å®¡æŸ¥\n"
                report += "- å‡­æ®è½®æ¢\n\n"
            elif item.layer == ResponsibilityLayer.OS:
                report += "**å…·ä½“ä»»åŠ¡**:\n"
                report += "- å®‰å…¨è¡¥ä¸ç®¡ç†\n"
                report += "- é˜²ç«å¢™é…ç½®\n"
                report += "- å®‰å…¨åŸºçº¿åŠ å›º\n"
                report += "- æ—¥å¿—æ”¶é›†\n\n"
        
        return report


@dataclass
class CloudProvider:
    """äº‘æä¾›å•†"""
    name: str
    service_models: list[ServiceModel]
    compliance_certifications: list[str]
    shared_responsibility_url: str


class CloudProviderInfo:
    """äº‘æä¾›å•†ä¿¡æ¯"""
    
    def __init__(self):
        self.providers: list[CloudProvider] = []
        
    def get_provider_info(self) -> list[CloudProvider]:
        """è·å–äº‘æä¾›å•†ä¿¡æ¯"""
        providers = [
            CloudProvider(
                name="AWS",
                service_models=[ServiceModel.IaaS, ServiceModel.PaaS, ServiceModel.SaaS],
                compliance_certifications=[
                    "SOC 1/2/3", "ISO 27001", "HIPAA", "PCI DSS", "FedRAMP", "GDPR"
                ],
                shared_responsibility_url="https://aws.amazon.com/compliance/shared-responsibility-model/"
            ),
            CloudProvider(
                name="Azure",
                service_models=[ServiceModel.IaaS, ServiceModel.PaaS, ServiceModel.SaaS, ServiceModel.FaaS],
                compliance_certifications=[
                    "SOC 1/2/3", "ISO 27001", "HIPAA", "PCI DSS", "FedRAMP", "GDPR", "ISO 27018"
                ],
                shared_responsibility_url="https://docs.microsoft.com/azure/security/fundamentals/shared-responsibility"
            ),
            CloudProvider(
                name="GCP",
                service_models=[ServiceModel.IaaS, ServiceModel.PaaS, ServiceModel.SaaS, ServiceModel.FaaS],
                compliance_certifications=[
                    "SOC 1/2/3", "ISO 27001", "HIPAA", "PCI DSS", "FedRAMP", "GDPR", "ISO 27017"
                ],
                shared_responsibility_url="https://cloud.google.com/security/shared-responsibility"
            )
        ]
        
        self.providers = providers
        return providers
```

#### 1.2 è´£ä»»è¾¹ç•Œå¯è§†åŒ–

```python
#!/usr/bin/env python3
"""
è´£ä»»è¾¹ç•Œå¯è§†åŒ–
"""
from __future__ import annotations
from dataclasses import dataclass
from typing import Optional
import json


@dataclass
class SecurityBoundary:
    """å®‰å…¨è¾¹ç•Œ"""
    boundary_id: str
    name: str
    boundary_type: str  # Network, Identity, Data, Application
    owner: str  # Provider, Customer, Shared
    controls: list[str]


class SecurityBoundaryManager:
    """å®‰å…¨è¾¹ç•Œç®¡ç†å™¨"""
    
    def __init__(self):
        self.boundaries: list[SecurityBoundary] = []
        
    def define_cloud_boundaries(self) -> list[SecurityBoundary]:
        """å®šä¹‰äº‘å®‰å…¨è¾¹ç•Œ"""
        boundaries = [
            SecurityBoundary(
                boundary_id="BND-001",
                name="ç‰©ç†è¾¹ç•Œ",
                boundary_type="Physical",
                owner="Provider",
                controls=[
                    "æ•°æ®ä¸­å¿ƒé—¨ç¦",
                    "ç”Ÿç‰©è¯†åˆ«è®¿é—®",
                    "é—­è·¯ç”µè§†ç›‘æ§",
                    "å®‰å…¨äººå‘˜å·¡é€»"
                ]
            ),
            SecurityBoundary(
                boundary_id="BND-002",
                name="è™šæ‹ŸåŒ–è¾¹ç•Œ",
                boundary_type="Infrastructure",
                owner="Provider",
                controls=[
                    "Hypervisor éš”ç¦»",
                    "è™šæ‹Ÿæœºç›‘æ§",
                    "èµ„æºæ± éš”ç¦»"
                ]
            ),
            SecurityBoundary(
                boundary_id="BND-003",
                name="ç½‘ç»œè¾¹ç•Œ",
                boundary_type="Network",
                owner="Shared",
                controls=[
                    "VPC éš”ç¦»",
                    "å®‰å…¨ç»„",
                    "ç½‘ç»œ ACL",
                    "VPN éš§é“",
                    "é˜²ç«å¢™è§„åˆ™"
                ]
            ),
            SecurityBoundary(
                boundary_id="BND-004",
                name="èº«ä»½è¾¹ç•Œ",
                boundary_type="Identity",
                owner="Shared",
                controls=[
                    "IAM ç­–ç•¥",
                    "MFA",
                    "è§’è‰²å®šä¹‰",
                    "æƒé™è¾¹ç•Œ"
                ]
            ),
            SecurityBoundary(
                boundary_id="BND-005",
                name="æ•°æ®è¾¹ç•Œ",
                boundary_type="Data",
                owner="Customer",
                controls=[
                    "æ•°æ®åŠ å¯†",
                    "æ•°æ®åˆ†ç±»",
                    "è®¿é—®æ§åˆ¶",
                    "æ•°æ®è„±æ•"
                ]
            ),
            SecurityBoundary(
                boundary_id="BND-006",
                name="åº”ç”¨è¾¹ç•Œ",
                boundary_type="Application",
                owner="Customer",
                controls=[
                    "åº”ç”¨å®‰å…¨æµ‹è¯•",
                    "ä»£ç å®¡æŸ¥",
                    "ä¾èµ–ç®¡ç†",
                    "é…ç½®ç®¡ç†"
                ]
            )
        ]
        
        self.boundaries = boundaries
        return boundaries
    
    def generate_boundary_diagram(self) -> str:
        """ç”Ÿæˆè¾¹ç•Œå›¾ï¼ˆASCIIï¼‰"""
        diagram = """
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         äº‘å®‰å…¨è¾¹ç•Œæ¨¡å‹                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                    ç‰©ç†è¾¹ç•Œ (Provider)                       â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚
â”‚  â”‚  â”‚              è™šæ‹ŸåŒ–è¾¹ç•Œ (Provider)                   â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚           ç½‘ç»œè¾¹ç•Œ (Shared)                  â”‚    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚         èº«ä»½è¾¹ç•Œ (Shared)           â”‚    â”‚    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚     æ•°æ®è¾¹ç•Œ (Customer)     â”‚    â”‚    â”‚    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  åº”ç”¨è¾¹ç•Œ (Customer) â”‚    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                     â”‚
â”‚  å›¾ä¾‹:                                                              â”‚
â”‚  [Provider] = äº‘æä¾›å•†å…¨è´£                                          â”‚
â”‚  [Shared]   = å…±äº«è´£ä»»                                             â”‚
â”‚  [Customer] = å®¢æˆ·å…¨è´£                                             â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
"""
        return diagram
```

---

### 2ï¸âƒ£ äº‘è´¦å·ä½“ç³»

#### 2.1 è´¦å·æ¶æ„è®¾è®¡

```python
#!/usr/bin/env python3
"""
äº‘è´¦å·æ¶æ„è®¾è®¡
"""
from __future__ import annotations
from dataclasses import dataclass, field
from datetime import datetime
from enum import Enum
from typing import Optional, list


class AccountType(Enum):
    """è´¦å·ç±»å‹"""
    ROOT = "æ ¹è´¦å·"
    IAM_USER = "IAM ç”¨æˆ·"
    IAM_ROLE = "IAM è§’è‰²"
    SERVICE_ACCOUNT = "æœåŠ¡è´¦å·"
    FEDERATED_USER = "è”é‚¦ç”¨æˆ·"


class PermissionLevel(Enum):
    """æƒé™çº§åˆ«"""
    ADMINISTRATOR = "ç®¡ç†å‘˜"
    POWER_USER = "é«˜çº§ç”¨æˆ·"
    DEVELOPER = "å¼€å‘è€…"
    READ_ONLY = "åªè¯»"
    BILLING = "è®¡è´¹"


@dataclass
class CloudAccount:
    """äº‘è´¦å·"""
    account_id: str
    account_name: str
    account_type: AccountType
    parent_id: Optional[str]
    permissions: list[str]
    mfa_enabled: bool
    creation_date: datetime
    last_activity: datetime
    status: str  # Active, Inactive, Suspended


@dataclass
class OrganizationUnit:
    """ç»„ç»‡å•å…ƒ"""
    ou_id: str
    name: str
    parent_ou_id: Optional[str]
    accounts: list[str]
    policies: list[str]
    description: str


@dataclass
class PermissionPolicy:
    """æƒé™ç­–ç•¥"""
    policy_id: str
    policy_name: str
    policy_type: str  # Managed, Inline
    permissions: list[str]
    resources: list[str]
    effect: str  # Allow, Deny


class CloudAccountManager:
    """äº‘è´¦å·ç®¡ç†å™¨"""
    
    def __init__(self):
        self.accounts: list[CloudAccount] = []
        self.organization_units: list[OrganizationUnit] = []
        self.policies: list[PermissionPolicy] = []
        
    def create_account_structure(self) -> dict:
        """åˆ›å»ºè´¦å·ç»“æ„"""
        # ç»„ç»‡å•å…ƒ
        root_ou = OrganizationUnit(
            ou_id="OU-ROOT",
            name="Organization Root",
            parent_ou_id=None,
            accounts=[],
            policies=[],
            description="ç»„ç»‡æ ¹å•å…ƒ"
        )
        
        security_ou = OrganizationUnit(
            ou_id="OU-SECURITY",
            name="Security OU",
            parent_ou_id="OU-ROOT",
            accounts=[],
            policies=["Policy-Deny-Delete-Security-Groups"],
            description="å®‰å…¨ç›¸å…³è´¦å·"
        )
        
        production_ou = OrganizationUnit(
            ou_id="OU-PRODUCTION",
            name="Production OU",
            parent_ou_id="OU-ROOT",
            accounts=[],
            policies=["Policy-Restrict-Delete-Production"],
            description="ç”Ÿäº§ç¯å¢ƒè´¦å·"
        )
        
        development_ou = OrganizationUnit(
            ou_id="OU-DEVELOPMENT",
            name="Development OU",
            parent_ou_id="OU-ROOT",
            accounts=[],
            policies=[],
            description="å¼€å‘ç¯å¢ƒè´¦å·"
        )
        
        self.organization_units = [root_ou, security_ou, production_ou, development_ou]
        
        # è´¦å·
        accounts = [
            CloudAccount(
                account_id="ACC-001",
                account_name="Security-Admin-Account",
                account_type=AccountType.IAM_USER,
                parent_id="OU-SECURITY",
                permissions=["iam:*", "s3:*", "cloudtrail:*"],
                mfa_enabled=True,
                creation_date=datetime(2024, 1, 1),
                last_activity=datetime(2024, 1, 15),
                status="Active"
            ),
            CloudAccount(
                account_id="ACC-002",
                account_name="DevOps-Service-Account",
                account_type=AccountType.SERVICE_ACCOUNT,
                parent_id="OU-PRODUCTION",
                permissions=["ec2:*", "ecs:*", "eks:*", "s3:Read"],
                mfa_enabled=False,
                creation_date=datetime(2024, 1, 5),
                last_activity=datetime(2024, 1, 15),
                status="Active"
            ),
            CloudAccount(
                account_id="ACC-003",
                account_name="Developer-User-001",
                account_type=AccountType.IAM_USER,
                parent_id="OU-DEVELOPMENT",
                permissions=["s3:Read", "ec2:Describe", "lambda:InvokeFunction"],
                mfa_enabled=True,
                creation_date=datetime(2024, 1, 10),
                last_activity=datetime(2024, 1, 14),
                status="Active"
            ),
            CloudAccount(
                account_id="ACC-004",
                account_name="ReadOnly-Auditor",
                account_type=AccountType.IAM_USER,
                parent_id="OU-ROOT",
                permissions=[
                    "ec2:Describe*",
                    "s3:Get*",
                    "s3:List*",
                    "cloudtrail:Lookup"
                ],
                mfa_enabled=True,
                creation_date=datetime(2024, 1, 8),
                last_activity=datetime(2024, 1, 15),
                status="Active"
            )
        ]
        
        self.accounts = accounts
        
        return {
            "organization_units": [
                {"id": ou.ou_id, "name": ou.name, "parent": ou.parent_ou_id}
                for ou in self.organization_units
            ],
            "accounts": [
                {
                    "id": acc.account_id,
                    "name": acc.account_name,
                    "type": acc.account_type.value,
                    "permissions": acc.permissions,
                    "mfa": acc.mfa_enabled
                }
                for acc in self.accounts
            ]
        }
    
    def generate_account_report(self) -> str:
        """ç”Ÿæˆè´¦å·æŠ¥å‘Š"""
        report = "# äº‘è´¦å·æ¶æ„æŠ¥å‘Š\n\n"
        
        report += "## 1. ç»„ç»‡ç»“æ„\n\n"
        report += "| OU ID | åç§° | çˆ¶ OU | è¯´æ˜ |\n"
        report += "|-------|------|-------|------|\n"
        for ou in self.organization_units:
            parent = ou.parent_ou_id or "æ— "
            report += f"| {ou.ou_id} | {ou.name} | {parent} | {ou.description} |\n"
        
        report += "\n## 2. è´¦å·åˆ—è¡¨\n\n"
        report += "| è´¦å· ID | åç§° | ç±»å‹ | MFA | çŠ¶æ€ |\n"
        report += "|---------|------|------|-----|------|\n"
        for acc in self.accounts:
            mfa = "âœ“" if acc.mfa_enabled else "âœ—"
            report += f"| {acc.account_id} | {acc.account_name} | {acc.account_type.value} | {mfa} | {acc.status} |\n"
        
        report += "\n## 3. æƒé™åˆ†æ\n\n"
        
        # æƒé™ç»Ÿè®¡
        permission_stats = {}
        for acc in self.accounts:
            for perm in acc.permissions:
                service = perm.split(":")[0] if ":" in perm else perm
                permission_stats[service] = permission_stats.get(service, 0) + 1
        
        report += "| æœåŠ¡ | ä½¿ç”¨è´¦å·æ•° |\n"
        report += "|------|-----------|\n"
        for service, count in sorted(permission_stats.items(), key=lambda x: x[1], reverse=True):
            report += f"| {service} | {count} |\n"
        
        # é£é™©è´¦å·
        report += "\n## 4. é£é™©è¯„ä¼°\n\n"
        risk_accounts = [acc for acc in self.accounts if not acc.mfa_enabled]
        if risk_accounts:
            report += "âš ï¸ ä»¥ä¸‹è´¦å·æœªå¯ç”¨ MFA:\n\n"
            for acc in risk_accounts:
                report += f"- **{acc.account_name}** ({acc.account_type.value})\n"
        else:
            report = "âœ… æ‰€æœ‰è´¦å·å‡å·²å¯ç”¨ MFA\n"
        
        return report
```

#### 2.2 æœ€å°æƒé™å®ç°

```python
#!/usr/bin/env python3
"""
æœ€å°æƒé™åŸåˆ™å®ç°
"""
from __future__ import annotations
from dataclasses import dataclass
from typing import Optional, list


@dataclass
class RoleDefinition:
    """è§’è‰²å®šä¹‰"""
    role_id: str
    role_name: str
    description: str
    permissions: list[str]
    boundary_policy: Optional[str]
    sessions: int


@dataclass
class PermissionRequest:
    """æƒé™è¯·æ±‚"""
    request_id: str
    user: str
    requested_permissions: list[str]
    justification: str
    duration: str  # Temporary, Permanent
    approval_status: str  # Pending, Approved, Denied


class LeastPrivilegeManager:
    """æœ€å°æƒé™ç®¡ç†å™¨"""
    
    def __init__(self):
        self.roles: list[RoleDefinition] = []
        self.permission_requests: list[PermissionRequest] = []
        
    def define_roles(self) -> list[RoleDefinition]:
        """å®šä¹‰è§’è‰²"""
        roles = [
            RoleDefinition(
                role_id="ROLE-001",
                role_name="SecurityViewer",
                description="å®‰å…¨æŸ¥çœ‹è€… - åªè¯»è®¿é—®å®‰å…¨æœåŠ¡",
                permissions=[
                    "s3:GetObject",
                    "s3:ListBucket",
                    "cloudtrail:LookupEvents",
                    "config:Get*",
                    "securityhub:GetFindings",
                    "guardduty:GetFindings"
                ],
                boundary_policy=None,
                sessions=1
            ),
            RoleDefinition(
                role_id="ROLE-002",
                role_name="SecurityAdmin",
                description="å®‰å…¨ç®¡ç†å‘˜ - ç®¡ç†å®‰å…¨æœåŠ¡",
                permissions=[
                    "s3:GetObject",
                    "s3:PutObject",
                    "cloudtrail:CreateTrail",
                    "cloudtrail:StartLogging",
                    "config:Put*",
                    "securityhub:*",
                    "guardduty:*",
                    "iam:ListAttachedUserPolicies",
                    "iam:ListUsers"
                ],
                boundary_policy="Boundaries-Security-Admin",
                sessions=1
            ),
            RoleDefinition(
                role_id="ROLE-003",
                role_name="EC2Operator",
                description="EC2 æ“ä½œå‘˜ - ç®¡ç† EC2 å®ä¾‹",
                permissions=[
                    "ec2:Describe*",
                    "ec2:StartInstances",
                    "ec2:StopInstances",
                    "ec2:CreateTags",
                    "ec2:RunInstances",
                    "ec2:TerminateInstances",
                    "ec2:CreateSecurityGroup",
                    "ec2:AuthorizeSecurityGroupIngress"
                ],
                boundary_policy="Boundaries-EC2-Operator",
                sessions=1
            ),
            RoleDefinition(
                role_id="ROLE-004",
                role_name="S3DataReader",
                description="S3 æ•°æ®è¯»å–è€… - åªè¯»è®¿é—®ç‰¹å®š S3 æ¡¶",
                permissions=[
                    "s3:GetObject",
                    "s3:ListBucket"
                ],
                boundary_policy="Boundaries-S3-Data-Reader",
                sessions=1
            ),
            RoleDefinition(
                role_id="ROLE-005",
                role_name="LambdaDeveloper",
                description="Lambda å¼€å‘è€… - ç®¡ç† Lambda å‡½æ•°",
                permissions=[
                    "lambda:ListFunctions",
                    "lambda:GetFunction",
                    "lambda:UpdateFunctionCode",
                    "lambda:UpdateFunctionConfiguration",
                    "lambda:CreateFunction",
                    "iam:PassRole"
                ],
                boundary_policy="Boundaries-Lambda-Developer",
                sessions=1
            )
        ]
        
        self.roles = roles
        return roles
    
    def create_permission_boundary(self) -> dict:
        """åˆ›å»ºæƒé™è¾¹ç•Œ"""
        boundary = {
            "boundary_name": "Permissions-Boundary-Production",
            "description": "ç”Ÿäº§ç¯å¢ƒæƒé™è¾¹ç•Œç­–ç•¥",
            "statements": [
                {
                    "Sid": "DenyDeleteProductionResources",
                    "Effect": "Deny",
                    "NotAction": [
                        "s3:GetObject",
                        "s3:ListBucket"
                    ],
                    "Resource": "arn:aws:s3:::production-*",
                    "Condition": {
                        "StringEquals": {
                            "aws:ResourceTag/Environment": "production"
                        }
                    }
                },
                {
                    "Sid": "DenyModifySecurityGroups",
                    "Effect": "Deny",
                    "Action": [
                        "ec2:AuthorizeSecurityGroupIngress",
                        "ec2:ModifySecurityGroupRules",
                        "ec2:DeleteSecurityGroup"
                    ],
                    "Resource": "*",
                    "Condition": {
                        "StringEquals": {
                            "ec2:Vpc": "vpc-production-*"
                        }
                    }
                },
                {
                    "Sid": "RequireTagsOnCreate",
                    "Effect": "Deny",
                    "Action": [
                        "ec2:CreateVolume",
                        "ec2:CreateInstance",
                        "s3:CreateBucket"
                    ],
                    "Resource": "*",
                    "Condition": {
                        "Null": {
                            "aws:RequestTag/Environment": "true"
                        }
                    }
                }
            ]
        }
        
        return boundary
    
    def approve_permission_request(self, request_id: str) -> dict:
        """å®¡æ‰¹æƒé™è¯·æ±‚"""
        for request in self.permission_requests:
            if request.request_id == request_id:
                request.approval_status = "Approved"
                
                return {
                    "request_id": request_id,
                    "status": "Approved",
                    "permissions_granted": request.requested_permissions,
                    "expiration": f"Current time + {request.duration}"
                }
        
        return {"error": "Request not found"}
    
    def generate_privilege_report(self) -> str:
        """ç”Ÿæˆæƒé™æŠ¥å‘Š"""
        report = "# æœ€å°æƒé™å®æ–½æŠ¥å‘Š\n\n"
        
        report += "## 1. è§’è‰²å®šä¹‰\n\n"
        report += "| è§’è‰² ID | è§’è‰²åç§° | æƒé™æ•° | è¾¹ç•Œç­–ç•¥ |\n"
        report += "|---------|----------|--------|----------|\n"
        for role in self.roles:
            boundary = role.boundary_policy or "æ— "
            report += f"| {role.role_id} | {role.role_name} | {len(role.permissions)} | {boundary} |\n"
        
        report += "\n## 2. æƒé™è¯¦æƒ…\n\n"
        for role in self.roles:
            report += f"### {role.role_name}\n\n"
            report += f"{role.description}\n\n"
            report += "**æƒé™åˆ—è¡¨**:\n"
            for perm in role.permissions:
                report += f"- `{perm}`\n"
            report += "\n"
        
        report += "\n## 3. æƒé™è¾¹ç•Œ\n\n"
        boundary = self.create_permission_boundary()
        report += f"**ç­–ç•¥åç§°**: {boundary['boundary_name']}\n\n"
        report += f"**æè¿°**: {boundary['description']}\n\n"
        
        report += "**æ‹’ç»è¯­å¥**:\n"
        for stmt in boundary['statements']:
            report += f"- {stmt['Sid']}: {stmt['Effect']}\n"
        
        report += "\n## 4. æœ€ä½³å®è·µæ£€æŸ¥\n\n"
        checks = [
            ("æ‰€æœ‰ç”Ÿäº§è§’è‰²éƒ½æœ‰è¾¹ç•Œç­–ç•¥", "âœ… é€šè¿‡" if all(r.boundary_policy for r in self.roles) else "âŒ æœªé€šè¿‡"),
            ("æƒé™èŒƒå›´é™å®šåˆ°å…·ä½“æ“ä½œ", "âœ… é€šè¿‡"),
            ("æ•æ„Ÿæ“ä½œæœ‰é¢å¤–ä¿æŠ¤", "âœ… é€šè¿‡"),
            ("ä¸´æ—¶æƒé™æœ‰è‡ªåŠ¨è¿‡æœŸæœºåˆ¶", "âš ï¸ éœ€è¦å®ç°"),
            ("å®šæœŸå®¡æŸ¥æƒé™åˆ†é…", "âš ï¸ éœ€è¦å®ç°")
        ]
        
        for check, result in checks:
            report += f"- {result} {check}\n"
        
        return report
```

---

### 3ï¸âƒ£ å‡­æ®ä¸å¯†é’¥ç®¡ç†

#### 3.1 å¯†é’¥ç®¡ç†æ¶æ„

```python
#!/usr/bin/env python3
"""
å¯†é’¥ä¸å‡­æ®ç®¡ç†
"""
from __future__ import annotations
from dataclasses import dataclass
from datetime import datetime
from enum import Enum
from typing import Optional, list


class CredentialType(Enum):
    """å‡­æ®ç±»å‹"""
    API_KEY = "API å¯†é’¥"
    ACCESS_KEY = "è®¿é—®å¯†é’¥"
    SECRET_KEY = "å¯†é’¥"
    PASSWORD = "å¯†ç "
    CERTIFICATE = "è¯ä¹¦"
    TOKEN = "ä»¤ç‰Œ"


class CredentialStatus(Enum):
    """å‡­æ®çŠ¶æ€"""
    ACTIVE = "æ´»è·ƒ"
    ROTATED = "å·²è½®æ¢"
    EXPIRED = "å·²è¿‡æœŸ"
    REVOKED = "å·²æ’¤é”€"


@dataclass
class Credential:
    """å‡­æ®"""
    credential_id: str
    name: str
    credential_type: CredentialType
    service: str
    created_at: datetime
    last_used: Optional[datetime]
    expires_at: Optional[datetime]
    status: CredentialStatus
    rotation_period: int  # å¤©
    description: str


@dataclass
class Secret:
    """å¯†é’¥"""
    secret_id: str
    name: str
    secret_value: str
    encryption_key: str
    version: str
    created_at: datetime
    updated_at: datetime


class CredentialManager:
    """å‡­æ®ç®¡ç†å™¨"""
    
    def __init__(self):
        self.credentials: list[Credential] = []
        self.secrets: list[Secret] = []
        
    def create_credential_inventory(self) -> list[Credential]:
        """åˆ›å»ºå‡­æ®æ¸…å•"""
        credentials = [
            Credential(
                credential_id="CRED-001",
                name="Production-API-Key",
                credential_type=CredentialType.API_KEY,
                service="AWS",
                created_at=datetime(2024, 1, 1),
                last_used=datetime(2024, 1, 15),
                expires_at=None,
                status=CredentialStatus.ACTIVE,
                rotation_period=90,
                description="ç”Ÿäº§ç¯å¢ƒ AWS è®¿é—®å¯†é’¥"
            ),
            Credential(
                credential_id="CRED-002",
                name="Database-Password",
                credential_type=CredentialType.PASSWORD,
                service="PostgreSQL",
                created_at=datetime(2024, 1, 5),
                last_used=datetime(2024, 1, 15),
                expires_at=None,
                status=CredentialStatus.ACTIVE,
                rotation_period=30,
                description="ç”Ÿäº§æ•°æ®åº“å¯†ç "
            ),
            Credential(
                credential_id="CRED-003",
                name="SSL-Certificate",
                credential_type=CredentialType.CERTIFICATE,
                service="Nginx",
                created_at=datetime(2024, 1, 1),
                last_used=None,
                expires_at=datetime(2024, 12, 31),
                status=CredentialStatus.ACTIVE,
                rotation_period=365,
                description="ç½‘ç«™ SSL è¯ä¹¦"
            ),
            Credential(
                credential_id="CRED-004",
                name="API-Token-Github",
                credential_type=CredentialType.TOKEN,
                service="GitHub",
                created_at=datetime(2024, 1, 10),
                last_used=datetime(2024, 1, 14),
                expires_at=None,
                status=CredentialStatus.ACTIVE,
                rotation_period=180,
                description="GitHub API Token"
            )
        ]
        
        self.credentials = credentials
        return credentials
    
    def check_credential_health(self) -> dict:
        """æ£€æŸ¥å‡­æ®å¥åº·çŠ¶æ€"""
        health = {
            "total_credentials": len(self.credentials),
            "active": 0,
            "expired": 0,
            "needs_rotation": 0,
            "unused": 0,
            "issues": []
        }
        
        for cred in self.credentials:
            if cred.status == CredentialStatus.ACTIVE:
                health["active"] += 1
                
                # æ£€æŸ¥æ˜¯å¦éœ€è¦è½®æ¢
                days_since_creation = (datetime.now() - cred.created_at).days
                if days_since_creation >= cred.rotation_period:
                    health["needs_rotation"] += 1
                    health["issues"].append({
                        "credential": cred.name,
                        "issue": "éœ€è¦è½®æ¢",
                        "days_since_creation": days_since_creation,
                        "rotation_period": cred.rotation_period
                    })
                
                # æ£€æŸ¥æ˜¯å¦æœªä½¿ç”¨
                if cred.last_used and (datetime.now() - cred.last_used).days > 30:
                    health["unused"] += 1
                    health["issues"].append({
                        "credential": cred.name,
                        "issue": "è¶…è¿‡ 30 å¤©æœªä½¿ç”¨",
                        "days_since_last_use": (datetime.now() - cred.last_used).days
                    })
            
            if cred.expires_at and cred.expires_at < datetime.now():
                health["expired"] += 1
                health["issues"].append({
                    "credential": cred.name,
                    "issue": "å·²è¿‡æœŸ"
                })
        
        return health
    
    def generate_credential_policy(self) -> str:
        """ç”Ÿæˆå‡­æ®ç­–ç•¥"""
        policy = """
# å‡­æ®ç®¡ç†ç­–ç•¥

## 1. å‡­æ®åˆ†ç±»

| ç±»åˆ« | æè¿° | ç¤ºä¾‹ | è½®æ¢å‘¨æœŸ |
|------|------|------|----------|
| å…³é”®å‡­æ® | æ ¹è´¦å·ã€ç®¡ç†å‘˜å‡­æ® | AWS Root, Admin Keys | 30 å¤© |
| é«˜æ•æ„Ÿå‡­æ® | ç”Ÿäº§æ•°æ®åº“ã€æœåŠ¡è´¦æˆ· | DB Password, Service Account | 30 å¤© |
| ä¸­æ•æ„Ÿå‡­æ® | API å¯†é’¥ã€Token | GitHub Token, API Key | 90 å¤© |
| ä½æ•æ„Ÿå‡­æ® | åªè¯»å‡­æ®ã€è¯ä¹¦ | Read-only Key, SSL Cert | 365 å¤© |

## 2. è½®æ¢ç­–ç•¥

### è‡ªåŠ¨è½®æ¢
- AWS KMS å¯†é’¥ï¼šè‡ªåŠ¨è½®æ¢ï¼ˆæ¯å¹´ï¼‰
- ACM è¯ä¹¦ï¼šè‡ªåŠ¨ç»­æœŸ
- Secrets Manager å¯†é’¥ï¼šå¯é…ç½®è‡ªåŠ¨è½®æ¢

### æ‰‹åŠ¨è½®æ¢
- API å¯†é’¥ï¼š90 å¤©æ‰‹åŠ¨è½®æ¢
- æ•°æ®åº“å¯†ç ï¼š30 å¤©æ‰‹åŠ¨è½®æ¢
- æœåŠ¡è´¦æˆ·ï¼š90 å¤©æ‰‹åŠ¨è½®æ¢

## 3. å­˜å‚¨è¦æ±‚

- **ç¦æ­¢**å°†å‡­æ®ç¡¬ç¼–ç åœ¨ä»£ç ä¸­
- **å¿…é¡»**ä½¿ç”¨å¯†é’¥ç®¡ç†æœåŠ¡
- **å¿…é¡»**å¯ç”¨åŠ å¯†å­˜å‚¨
- **å¿…é¡»**é™åˆ¶è®¿é—®æƒé™

## 4. ç›‘æ§è¦æ±‚

- è®°å½•æ‰€æœ‰å‡­æ®è®¿é—®æ—¥å¿—
- ç›‘æ§å¼‚å¸¸è®¿é—®æ¨¡å¼
- è®¾ç½®æœªä½¿ç”¨å‡­æ®å‘Šè­¦
- å®šæœŸå®¡è®¡å‡­æ®ä½¿ç”¨æƒ…å†µ

## 5. åº”æ€¥æµç¨‹

1. å‘ç°æ³„éœ²åç«‹å³æ’¤é”€å‡­æ®
2. ç”Ÿæˆæ–°å‡­æ®
3. æ›´æ–°æ‰€æœ‰ä½¿ç”¨è¯¥å‡­æ®çš„ç³»ç»Ÿ
4. å®¡æŸ¥æ—¥å¿—ç¡®è®¤å½±å“èŒƒå›´
5. æ›´æ–°å®‰å…¨ç­–ç•¥
"""
        return policy
    
    def generate_credential_report(self) -> str:
        """ç”Ÿæˆå‡­æ®æŠ¥å‘Š"""
        report = "# å‡­æ®ç®¡ç†æŠ¥å‘Š\n\n"
        
        # å‡­æ®æ¸…å•
        report += "## 1. å‡­æ®æ¸…å•\n\n"
        report += "| å‡­æ® ID | åç§° | ç±»å‹ | æœåŠ¡ | çŠ¶æ€ | è½®æ¢å‘¨æœŸ |\n"
        report += "|---------|------|------|------|------|----------|\n"
        for cred in self.credentials:
            status_icon = "âœ…" if cred.status == CredentialStatus.ACTIVE else "âš ï¸"
            report += f"| {cred.credential_id} | {cred.name} | {cred.credential_type.value} | {cred.service} | {status_icon} {cred.status.value} | {cred.rotation_period} å¤© |\n"
        
        # å¥åº·çŠ¶æ€
        health = self.check_credential_health()
        report += "\n## 2. å¥åº·çŠ¶æ€\n\n"
        report += f"- **æ€»å‡­æ®æ•°**: {health['total_credentials']}\n"
        report += f"- **æ´»è·ƒ**: {health['active']}\n"
        report += f"- **éœ€è¦è½®æ¢**: {health['needs_rotation']}\n"
        report += f"- **æœªä½¿ç”¨**: {health['unused']}\n"
        
        # é—®é¢˜åˆ—è¡¨
        if health['issues']:
            report += "\n## 3. éœ€è¦å…³æ³¨çš„é—®é¢˜\n\n"
            for issue in health['issues']:
                report += f"- **{issue['credential']}**: {issue['issue']}\n"
        
        # ç­–ç•¥
        report += "\n## 4. å‡­æ®ç­–ç•¥\n\n"
        report += self.generate_credential_policy()
        
        return report
```

#### 3.2 å¯†é’¥ç®¡ç†æœåŠ¡é…ç½®

```python
#!/usr/bin/env python3
"""
å¯†é’¥ç®¡ç†æœåŠ¡é…ç½®
"""
from __future__ import annotations
from dataclasses import dataclass
from typing import Optional


@dataclass
class KMSConfig:
    """KMS é…ç½®"""
    key_id: str
    key_alias: str
    description: str
    key_usage: str
    key_spec: str
    enable_key_rotation: bool
    rotation_period: int  # å¤©


@dataclass
class SecretManagerConfig:
    """å¯†é’¥ç®¡ç†å™¨é…ç½®"""
    secret_id: str
    name: string
    description: str
    encryption_key: str
    replication: str
    auto_rotation: bool
    rotation_period: int  # å¤©


class KeyManagementConfigurator:
    """å¯†é’¥ç®¡ç†é…ç½®å™¨"""
    
    def __init__(self):
        self.kms_configs: list[KMSConfig] = []
        self.secret_configs: list[SecretManagerConfig] = []
        
    def configure_kms_keys(self) -> list[KMSConfig]:
        """é…ç½® KMS å¯†é’¥"""
        configs = [
            KMSConfig(
                key_id="key-001",
                key_alias="alias/production-data-key",
                description="ç”Ÿäº§ç¯å¢ƒæ•°æ®åŠ å¯†å¯†é’¥",
                key_usage="ENCRYPT_DECRYPT",
                key_spec="SYMMETRIC_DEFAULT",
                enable_key_rotation=True,
                rotation_period=365
            ),
            KMSConfig(
                key_id="key-002",
                key_alias="alias/database-encryption-key",
                description="æ•°æ®åº“åŠ å¯†å¯†é’¥",
                key_usage="ENCRYPT_DECRYPT",
                key_spec="SYMMETRIC_DEFAULT",
                enable_key_rotation=True,
                rotation_period=365
            ),
            KMSConfig(
                key_id="key-003",
                key_alias="alias/signing-key",
                description="ç­¾åå¯†é’¥",
                key_usage="SIGN_VERIFY",
                key_spec="ECC_NIST_P256",
                enable_key_rotation=False,
                rotation_period=0
            )
        ]
        
        self.kms_configs = configs
        return configs
    
    def configure_secrets(self) -> list[SecretManagerConfig]:
        """é…ç½®å¯†é’¥"""
        configs = [
            SecretManagerConfig(
                secret_id="secret-001",
                name="production/database/credentials",
                description="ç”Ÿäº§æ•°æ®åº“å‡­æ®",
                encryption_key="key-002",
                replication="automatic",
                auto_rotation=True,
                rotation_period=30
            ),
            SecretManagerConfig(
                secret_id="secret-002",
                name="production/api/tokens",
                description="API Token",
                encryption_key="key-001",
                replication="automatic",
                auto_rotation=False,
                rotation_period=90
            ),
            SecretManagerConfig(
                secret_id="secret-003",
                name="production/ssl/private-key",
                description="SSL ç§é’¥",
                encryption_key="key-001",
                replication="manual",
                auto_rotation=False,
                rotation_period=365
            )
        ]
        
        self.secret_configs = configs
        return configs
    
    def generate_key_policy(self) -> str:
        """ç”Ÿæˆå¯†é’¥ç­–ç•¥"""
        policy = """
{
  "Version": "2012-10-17",
  "Id": "key-policy-production",
  "Statement": [
    {
      "Sid": "Enable IAM policies for key management",
      "Effect": "Allow",
      "Principal": {
        "AWS": "arn:aws:iam::123456789012:role/SecurityAdminRole"
      },
      "Action": [
        "kms:Create*",
        "kms:Describe*",
        "kms:Enable*",
        "kms:List*",
        "kms:Put*",
        "kms:Update*",
        "kms:Revoke*",
        "kms:Disable*",
        "kms:Get*",
        "kms:TagResource",
        "kms:UntagResource"
      ],
      "Resource": "*",
      "Condition": {
        "StringEquals": {
          "kms:CallerAccount": "123456789012"
        }
      }
    },
    {
      "Sid": "Allow use of the key for encryption",
      "Effect": "Allow",
      "Principal": {
        "AWS": [
          "arn:aws:iam::123456789012:role/EC2Role",
          "arn:aws:iam::123456789012:role/LambdaRole",
          "arn:aws:iam::123456789012:user/ApplicationUser"
        ]
      },
      "Action": [
        "kms:Encrypt",
        "kms:Decrypt",
        "kms:ReEncrypt*",
        "kms:GenerateDataKey*",
        "kms:DescribeKey"
      ],
      "Resource": "*"
    },
    {
      "Sid": "Allow cryptographic operations for signing",
      "Effect": "Allow",
      "Principal": {
        "AWS": [
          "arn:aws:iam::123456789012:role/SigningRole"
        ]
      },
      "Action": [
        "kms:Sign",
        "kms:Verify",
        "kms:GetPublicKey",
        "kms:DescribeKey"
      ],
      "Resource": "*"
    }
  ]
}
"""
        return policy
```

---

### 4ï¸âƒ£ èº«ä»½è”é‚¦

#### 4.1 ä¼ä¸šèº«ä»½é›†æˆ

```python
#!/usr/bin/env python3
"""
èº«ä»½è”é‚¦é…ç½®
"""
from __future__ import annotations
from dataclasses import dataclass
from typing import Optional, list


@dataclass
class IdentityProvider:
    """èº«ä»½æä¾›å•†"""
    provider_id: str
    provider_type: str  # SAML, OIDC, OAuth
    provider_name: string
    metadata_url: str
    enabled: bool
    claims_mapping: dict


@dataclass
class FederationConfig:
    """è”é‚¦é…ç½®"""
    config_id: str
    provider_id: str
    sso_url: str
    logout_url: str
    session_duration: int  # å°æ—¶
    attribute_mappings: dict


class IdentityFederationManager:
    """èº«ä»½è”é‚¦ç®¡ç†å™¨"""
    
    def __init__(self):
        self.providers: list[IdentityProvider] = []
        self.configs: list[FederationConfig] = []
        
    def configure_saml_federation(self) -> dict:
        """é…ç½® SAML è”é‚¦"""
        provider = IdentityProvider(
            provider_id="IDP-001",
            provider_type="SAML",
            provider_name="Azure AD",
            metadata_url="https://login.microsoftonline.com/tenant-id/federationmetadata/2007-06/federationmetadata.xml",
            enabled=True,
            claims_mapping={
                "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress": "email",
                "http://schemas.microsoft.com/identity/claims/displayname": "name",
                "http://schemas.microsoft.com/identity/claims/objectidentifier": "oid"
            }
        )
        
        config = FederationConfig(
            config_id="FED-001",
            provider_id="IDP-001",
            sso_url="https://signin.aws.amazon.com/saml",
            logout_url="https://login.microsoftonline.com/tenant-id/saml2",
            session_duration=12,
            attribute_mappings={
                "email": "https://aws.amazon.com/SAML/Attributes/PrincipalTag:email",
                "groups": "https://aws.amazon.com/SAML/Attributes/PrincipalTag:groups",
                "role": "https://aws.amazon.com/SAML/Attributes/Role"
            }
        )
        
        self.providers.append(provider)
        self.configs.append(config)
        
        return {
            "provider": {
                "id": provider.provider_id,
                "name": provider.provider_name,
                "type": provider.provider_type,
                "enabled": provider.enabled
            },
            "config": {
                "sso_url": config.sso_url,
                "session_duration": f"{config.session_duration} å°æ—¶",
                "attribute_mappings": config.attribute_mappings
            }
        }
    
    def configure_oidc_federation(self) -> dict:
        """é…ç½® OIDC è”é‚¦"""
        provider = IdentityProvider(
            provider_id="IDP-002",
            provider_type="OIDC",
            provider_name="Okta",
            metadata_url="https://dev-example.okta.com/.well-known/openid-configuration",
            enabled=True,
            claims_mapping={
                "sub": "sub",
                "email": "email",
                "groups": "groups"
            }
        )
        
        config = FederationConfig(
            config_id="FED-002",
            provider_id="IDP-002",
            sso_url="https://signin.aws.amazon.com/oauth",
            logout_url="https://dev-example.okta.com/oauth2/default/v1/logout",
            session_duration=8,
            attribute_mappings={
                "email": "email",
                "department": "department",
                "role": "role_arns"
            }
        )
        
        self.providers.append(provider)
        self.configs.append(config)
        
        return {
            "provider": {
                "id": provider.provider_id,
                "name": provider.provider_name,
                "type": provider.provider_type,
                "enabled": provider.enabled
            },
            "config": {
                "sso_url": config.sso_url,
                "session_duration": f"{config.session_duration} å°æ—¶",
                "attribute_mappings": config.attribute_mappings
            }
        }
    
    def generate_federation_policy(self) -> str:
        """ç”Ÿæˆè”é‚¦ç­–ç•¥"""
        policy = """
# èº«ä»½è”é‚¦ç­–ç•¥

## 1. æ”¯æŒçš„ IdP ç±»å‹

| IdP ç±»å‹ | æ”¯æŒçŠ¶æ€ | ä½¿ç”¨åœºæ™¯ |
|----------|----------|----------|
| SAML 2.0 | âœ… æ”¯æŒ | ä¼ä¸š AD é›†æˆ |
| OIDC | âœ… æ”¯æŒ | SaaS åº”ç”¨é›†æˆ |
| OAuth 2.0 | âœ… æ”¯æŒ | ç¬¬ä¸‰æ–¹åº”ç”¨æˆæƒ |
| WS-Federation | âš ï¸ è€ƒè™‘ä¸­ | é—ç•™ç³»ç»Ÿ |

## 2. å±æ€§æ˜ å°„è§„åˆ™

### å¿…éœ€å±æ€§
- `email`: ç”¨æˆ·é‚®ç®±åœ°å€
- `name`: ç”¨æˆ·æ˜¾ç¤ºåç§°
- `sub`: å”¯ä¸€æ ‡è¯†ç¬¦

### å¯é€‰å±æ€§
- `groups`: ç”¨æˆ·æ‰€å±ç»„
- `department`: éƒ¨é—¨
- `role`: è§’è‰² ARN

## 3. ä¼šè¯ç®¡ç†

| è®¾ç½® | å€¼ | è¯´æ˜ |
|------|-----|------|
| ä¼šè¯æŒç»­æ—¶é—´ | 12 å°æ—¶ | SAML é»˜è®¤ |
| ä»¤ç‰Œåˆ·æ–° | å¯ç”¨ | é¿å…é‡å¤ç™»å½• |
| å¼ºåˆ¶é‡æ–°è®¤è¯ | å¯é€‰ | æ•æ„Ÿæ“ä½œ |
| å¹¶å‘ä¼šè¯é™åˆ¶ | 1 | é˜²æ­¢å…±äº«è´¦æˆ· |

## 4. å®‰å…¨è¦æ±‚

### IdP è¦æ±‚
- å¼ºåˆ¶ MFA
- æ”¯æŒæ¡ä»¶è®¿é—®
- åˆè§„è®¤è¯ï¼ˆSOC 2, ISO 27001ï¼‰

### å±æ€§è¦æ±‚
- åŠ å¯†ä¼ è¾“
- ç­¾åéªŒè¯
- å£°æ˜è¿‡æ»¤

## 5. æ•…éšœè½¬ç§»

- IdP ä¸å¯ç”¨æ—¶ï¼šä½¿ç”¨å¤‡ç”¨ IdP
- é…ç½®ç¼“å­˜ï¼šæœ€å¤š 24 å°æ—¶
- æ‰‹åŠ¨é™çº§ï¼šå…è®¸æœ¬åœ° IAM ç”¨æˆ·
"""
        return policy
```

---

## å®è·µä»»åŠ¡ï¼ˆåˆæ³•æˆæƒèŒƒå›´å†…ï¼‰

> **æ³¨æ„**ï¼šä»¥ä¸‹ä»»åŠ¡è¯·åœ¨ä½ è‡ªå·±çš„æµ‹è¯•ç¯å¢ƒã€è™šæ‹Ÿæœºæˆ–æˆæƒé¶åœºä¸­æ‰§è¡Œã€‚

---

### ä»»åŠ¡ 1ï¼ˆå¿…åšï¼‰ï¼šå…±äº«è´£ä»»æ¨¡å‹åˆ†æ

**ç›®æ ‡**ï¼šåˆ†æä¸åŒäº‘æœåŠ¡æ¨¡å‹ä¸‹çš„è´£ä»»åˆ’åˆ†ã€‚

**æ­¥éª¤**ï¼š

```python
#!/usr/bin/env python3

from shared_responsibility_model import SharedResponsibilityModel, ServiceModel

# 1. åˆ›å»ºè´£ä»»æ¨¡å‹
print("=== å…±äº«è´£ä»»æ¨¡å‹åˆ†æ ===")
model = SharedResponsibilityModel()

# 2. ç”Ÿæˆ IaaS è´£ä»»æŠ¥å‘Š
print("\n--- IaaS æ¨¡å¼è´£ä»»åˆ’åˆ† ---")
iaas_report = model.generate_responsibility_report(ServiceModel.IaaS)
print(iaas_report)

# 3. ç”Ÿæˆ PaaS è´£ä»»æŠ¥å‘Š
print("\n--- PaaS æ¨¡å¼è´£ä»»åˆ’åˆ† ---")
paas_report = model.generate_responsibility_report(ServiceModel.PaaS)
print(paas_report)

# 4. ç”Ÿæˆ SaaS è´£ä»»æŠ¥å‘Š
print("\n--- SaaS æ¨¡å¼è´£ä»»åˆ’åˆ† ---")
saas_report = model.generate_responsibility_report(ServiceModel.SaaS)
print(saas_report)

# 5. ç”Ÿæˆè¾¹ç•Œå›¾
print("\n--- äº‘å®‰å…¨è¾¹ç•Œæ¨¡å‹ ---")
boundary_manager = SecurityBoundaryManager()
boundaries = boundary_manager.define_cloud_boundaries()
diagram = boundary_manager.generate_boundary_diagram()
print(diagram)
```

---

### ä»»åŠ¡ 2ï¼ˆå¿…åšï¼‰ï¼šè´¦å·æ¶æ„è®¾è®¡

**ç›®æ ‡**ï¼šè®¾è®¡äº‘è´¦å·æ¶æ„å¹¶å®æ–½æœ€å°æƒé™ã€‚

**æ­¥éª¤**ï¼š

```python
#!/usr/bin/env python3

from cloud_account_manager import CloudAccountManager

# 1. åˆ›å»ºè´¦å·ç»“æ„
print("=== äº‘è´¦å·æ¶æ„è®¾è®¡ ===")
manager = CloudAccountManager()
structure = manager.create_account_structure()

print("\nç»„ç»‡å•å…ƒ:")
for ou in structure["organization_units"]:
    print(f"  - {ou['id']}: {ou['name']} (çˆ¶: {ou['parent']})")

print("\nè´¦å·:")
for acc in structure["accounts"]:
    mfa = "MFA" if acc["mfa"] else "æ—  MFA"
    print(f"  - {acc['name']}: {acc['type']} - {mfa}")

# 2. ç”Ÿæˆè´¦å·æŠ¥å‘Š
print("\n=== è´¦å·æŠ¥å‘Š ===")
report = manager.generate_account_report()
print(report)
```

---

### ä»»åŠ¡ 3ï¼ˆå¿…åšï¼‰ï¼šå‡­æ®ç®¡ç†é…ç½®

**ç›®æ ‡**ï¼šé…ç½®å¯†é’¥ç®¡ç†å’Œå‡­æ®è½®æ¢ç­–ç•¥ã€‚

**æ­¥éª¤**ï¼š

```python
#!/usr/bin/env python3

from credential_manager import CredentialManager

# 1. åˆ›å»ºå‡­æ®æ¸…å•
print("=== å‡­æ®ç®¡ç† ===")
manager = CredentialManager()
credentials = manager.create_credential_inventory()

print("\nå‡­æ®æ¸…å•:")
for cred in credentials:
    status = "ğŸ”´" if cred.status.value == "æ´»è·ƒ" else "âš ï¸"
    print(f"  {status} {cred.name} ({cred.credential_type.value}) - {cred.service}")

# 2. æ£€æŸ¥å¥åº·çŠ¶æ€
print("\n=== å‡­æ®å¥åº·æ£€æŸ¥ ===")
health = manager.check_credential_health()
print(f"æ€»å‡­æ®æ•°: {health['total_credentials']}")
print(f"éœ€è¦è½®æ¢: {health['needs_rotation']}")
print(f"æœªä½¿ç”¨: {health['unused']}")

if health['issues']:
    print("\né—®é¢˜:")
    for issue in health['issues']:
        print(f"  - {issue['credential']}: {issue['issue']}")

# 3. ç”Ÿæˆå‡­æ®æŠ¥å‘Š
print("\n=== å‡­æ®æŠ¥å‘Š ===")
report = manager.generate_credential_report()
print(report)
```

---

### ä»»åŠ¡ 4ï¼ˆå¿…åšï¼‰ï¼šèº«ä»½è”é‚¦é…ç½®

**ç›®æ ‡**ï¼šé…ç½®ä¼ä¸šèº«ä»½è”é‚¦ã€‚

**æ­¥éª¤**ï¼š

```python
#!/usr/bin/env python3

from identity_federation_manager import IdentityFederationManager

# 1. é…ç½® SAML è”é‚¦
print("=== èº«ä»½è”é‚¦é…ç½® ===")
federation = IdentityFederationManager()

print("\n--- SAML è”é‚¦ (Azure AD) ---")
saml_config = federation.configure_saml_federation()
print(f"IdP: {saml_config['provider']['name']}")
print(f"SSO URL: {saml_config['config']['sso_url']}")
print(f"ä¼šè¯æ—¶é•¿: {saml_config['config']['session_duration']}")

print("\n--- OIDC è”é‚¦ (Okta) ---")
oidc_config = federation.configure_oidc_federation()
print(f"IdP: {oidc_config['provider']['name']}")
print(f"SSO URL: {oidc_config['config']['sso_url']}")
print(f"ä¼šè¯æ—¶é•¿: {oidc_config['config']['session_duration']}")

# 2. ç”Ÿæˆè”é‚¦ç­–ç•¥
print("\n=== è”é‚¦ç­–ç•¥ ===")
policy = federation.generate_federation_policy()
print(policy)
```

---

## å·©å›ºç»ƒä¹ ï¼ˆé¢˜ä¸å¤ç›˜ï¼‰

---

### ç»ƒä¹  1ï¼šè´£ä»»è¾¹ç•Œåˆ†æ

**é—®é¢˜**ï¼šåœ¨ IaaS æ¨¡å¼ä¸‹ï¼Œå®¢æˆ·è´Ÿè´£å“ªäº›å®‰å…¨æ§åˆ¶ï¼Ÿäº‘æä¾›å•†è´Ÿè´£å“ªäº›ï¼Ÿ

**æ€è·¯æç¤º**ï¼š

| è´£ä»»æ–¹ | è´Ÿè´£é¢†åŸŸ | å…·ä½“æ§åˆ¶ |
|--------|----------|----------|
| **æä¾›å•†** | ç‰©ç†å®‰å…¨ | æ•°æ®ä¸­å¿ƒã€ç¡¬ä»¶ã€ç½‘ç»œåŸºç¡€è®¾æ–½ |
| **æä¾›å•†** | è™šæ‹ŸåŒ– | Hypervisorã€åº•å±‚ç½‘ç»œ |
| **å…±äº«** | ç½‘ç»œ | å®‰å…¨ç»„é…ç½®ã€VPC è®¾ç½® |
| **å®¢æˆ·** | æ“ä½œç³»ç»Ÿ | è¡¥ä¸ã€é…ç½®ã€ç”¨æˆ·ç®¡ç† |
| **å®¢æˆ·** | åº”ç”¨ç¨‹åº | ä»£ç å®‰å…¨ã€ä¾èµ–ç®¡ç† |
| **å®¢æˆ·** | æ•°æ® | åŠ å¯†ã€å¤‡ä»½ã€è®¿é—®æ§åˆ¶ |

---

### ç»ƒä¹  2ï¼šæœ€å°æƒé™è®¾è®¡

**é—®é¢˜**ï¼šä¸ºä¸€ä¸ªå¼€å‘å›¢é˜Ÿè®¾è®¡æœ€å°æƒé™æ–¹æ¡ˆï¼ŒåŒ…å«ä»¥ä¸‹è§’è‰²ï¼š
- å¼€å‘äººå‘˜ï¼šéœ€è¦éƒ¨ç½²å’Œæµ‹è¯•åº”ç”¨
- ä»£ç å®¡æŸ¥å‘˜ï¼šéœ€è¦æŸ¥çœ‹ä»£ç å’Œæ„å»ºè®°å½•
- DevOpsï¼šéœ€è¦ç®¡ç† CI/CD æµæ°´çº¿

**ç¤ºä¾‹ç­”æ¡ˆ**ï¼š

```python
# è§’è‰²æƒé™è®¾è®¡
ROLE_PERMISSIONS = {
    "Developer": {
        "description": "å¼€å‘äººå‘˜ - éƒ¨ç½²å’Œæµ‹è¯•åº”ç”¨",
        "permissions": [
            "ecr:BatchCheckLayerAvailability",
            "ecr:BatchGetImage",
            "ecr:GetDownloadUrlForLayer",
            "ecr:InitiateLayerUpload",
            "ecr:UploadLayerPart",
            "ecs:RunTask",
            "ecs:DescribeTasks",
            "lambda:ListFunctions",
            "lambda:InvokeFunction",
            "s3:GetObject",
            "s3:PutObject"
        ],
        "restrictions": [
            "ä¸èƒ½åˆ é™¤ç”Ÿäº§èµ„æº",
            "ä¸èƒ½ä¿®æ”¹å®‰å…¨ç»„",
            "ä¸èƒ½è®¿é—®å…¶ä»–é¡¹ç›®çš„èµ„æº"
        ]
    },
    "CodeReviewer": {
        "description": "ä»£ç å®¡æŸ¥å‘˜ - æŸ¥çœ‹ä»£ç å’Œæ„å»ºè®°å½•",
        "permissions": [
            "codecommit:GetBranch",
            "codecommit:GetFile",
            "codecommit:ListPullRequests",
            "codecommit:GetPullRequest",
            "codebuild:BatchGetBuilds",
            "codebuild:ListBuildsForProject",
            "s3:GetObject",
            "s3:ListBucket"
        ],
        "restrictions": [
            "ä¸èƒ½ä¿®æ”¹ä»£ç ",
            "ä¸èƒ½è§¦å‘æ„å»º",
            "ä¸èƒ½è®¿é—®ç”Ÿäº§å¯†é’¥"
        ]
    },
    "DevOps": {
        "description": "DevOps - ç®¡ç† CI/CD æµæ°´çº¿",
        "permissions": [
            "codebuild:CreateProject",
            "codebuild:UpdateProject",
            "codebuild:StartBuild",
            "codepipeline:CreatePipeline",
            "codepipeline:UpdatePipeline",
            "codepipeline:StartPipelineExecution",
            "ecs:RegisterTaskDefinition",
            "ecs:UpdateService",
            "iam:PassRole",
            "s3:*",
            "cloudformation:*"
        ],
        "restrictions": [
            "éœ€è¦å®¡æ‰¹æ‰èƒ½ä¿®æ”¹ç”Ÿäº§æœåŠ¡",
            "ä¸èƒ½ç›´æ¥è®¿é—®ç”Ÿäº§æ•°æ®åº“",
            "æ‰€æœ‰å˜æ›´éœ€è¦è®°å½•"
        ]
    }
}
```

---

### ç»ƒä¹  3ï¼šå‡­æ®å®‰å…¨è¯„ä¼°

**é—®é¢˜**ï¼šè¯„ä¼°ä»¥ä¸‹å‡­æ®é…ç½®çš„å®‰å…¨é£é™©å¹¶æå‡ºæ”¹è¿›å»ºè®®ã€‚

**å‡­æ®é…ç½®**ï¼š
1. API å¯†é’¥ç¡¬ç¼–ç åœ¨ä»£ç ä¸­
2. æ•°æ®åº“å¯†ç æ¯ 6 ä¸ªæœˆè½®æ¢ä¸€æ¬¡
3. åªæœ‰ä¸€ä¸ªç®¡ç†å‘˜è´¦å·
4. æœªå¯ç”¨ MFA

**ç¤ºä¾‹ç­”æ¡ˆ**ï¼š

```python
# å‡­æ®å®‰å…¨è¯„ä¼°
SECURITY_ASSESSMENT = {
    "findings": [
        {
            "issue": "API å¯†é’¥ç¡¬ç¼–ç ",
            "risk": "é«˜",
            "impact": "ä»£ç æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿåæ³„éœ²",
            "remediation": "ä½¿ç”¨å¯†é’¥ç®¡ç†æœåŠ¡å­˜å‚¨ API å¯†é’¥"
        },
        {
            "issue": "æ•°æ®åº“å¯†ç è½®æ¢å‘¨æœŸè¿‡é•¿",
            "risk": "é«˜",
            "impact": "å¯†ç æ³„éœ²åæ”»å‡»çª—å£æœŸè¿‡é•¿",
            "remediation": "å°†è½®æ¢å‘¨æœŸç¼©çŸ­åˆ° 30 å¤©ï¼Œå¯ç”¨è‡ªåŠ¨è½®æ¢"
        },
        {
            "issue": "å•ç‚¹ç®¡ç†å‘˜",
            "risk": "ä¸­",
            "impact": "è´¦å·è¢«é”å®šæˆ–æ³„éœ²åæ— æ³•æ¢å¤",
            "remediation": "åˆ›å»ºå¤šä¸ªç®¡ç†å‘˜è´¦å·ï¼Œå®æ–½èŒè´£åˆ†ç¦»"
        },
        {
            "issue": "æœªå¯ç”¨ MFA",
            "risk": "é«˜",
            "impact": "å¯†ç æ³„éœ²åè´¦å·ç›´æ¥è¢«æ¥ç®¡",
            "remediation": "å¯¹æ‰€æœ‰è´¦å·å¼ºåˆ¶å¯ç”¨ MFA"
        }
    ],
    "overall_risk": "é«˜",
    "priority_actions": [
        "1. ç§»é™¤ä»£ç ä¸­çš„ç¡¬ç¼–ç å¯†é’¥",
        "2. ä¸ºæ‰€æœ‰è´¦å·å¯ç”¨ MFA",
        "3. å¯ç”¨æ•°æ®åº“å¯†ç è‡ªåŠ¨è½®æ¢",
        "4. åˆ›å»ºå¤‡ç”¨ç®¡ç†å‘˜è´¦å·"
    ]
}
```

---

## è¯„ä¼°æ ‡å‡†ï¼ˆè¾¾æˆåˆ¤å®šï¼‰

- âœ… èƒ½è§£é‡Šå…±äº«è´£ä»»æ¨¡å‹å¹¶è¯†åˆ«è´£ä»»è¾¹ç•Œ
- âœ… èƒ½è®¾è®¡äº‘è´¦å·æ¶æ„å’Œè§’è‰²æƒé™
- âœ… èƒ½å®æ–½æœ€å°æƒé™åŸåˆ™
- âœ… èƒ½é…ç½®å‡­æ®ç®¡ç†å’Œè½®æ¢ç­–ç•¥
- âœ… èƒ½é…ç½®ä¼ä¸šèº«ä»½è”é‚¦
- âœ… èƒ½è¯†åˆ«å’Œä¿®å¤å‡­æ®å®‰å…¨é£é™©

---

## å­¦ä¹ æˆæœè¾¾æˆæƒ…å†µï¼ˆç”±å­¦ä¹ è€…å¡«å†™ï¼‰

### æˆªå›¾ä¸è¯æ®

- [ ] è´£ä»»æ¨¡å‹åˆ†ææˆªå›¾
- [ ] è´¦å·æ¶æ„è®¾è®¡æˆªå›¾
- [ ] æƒé™é…ç½®æˆªå›¾
- [ ] å‡­æ®ç®¡ç†æˆªå›¾
- [ ] è”é‚¦é…ç½®æˆªå›¾

### å…³é”®å‘½ä»¤ä¸è¾“å‡º

**è´£ä»»æ¨¡å‹åˆ†æ**ï¼š
```bash
$ python3 analyze_responsibility.py
IaaS è´£ä»»åˆ’åˆ†:
  å®¢æˆ·è´Ÿè´£: æ“ä½œç³»ç»Ÿã€åº”ç”¨ç¨‹åºã€æ•°æ®ã€èº«ä»½
  æä¾›å•†è´Ÿè´£: ç‰©ç†å®‰å…¨ã€è™šæ‹ŸåŒ–ã€ç½‘ç»œåŸºç¡€è®¾æ–½
```

**è´¦å·æ¶æ„**ï¼š
```bash
$ python3 account_structure.py
ç»„ç»‡å•å…ƒ:
  - OU-ROOT: Organization Root
  - OU-SECURITY: Security OU
  - OU-PRODUCTION: Production OU

è´¦å·:
  - Security-Admin-Account: IAM ç”¨æˆ· - MFA
  - DevOps-Service-Account: æœåŠ¡è´¦å· - æ—  MFA âš ï¸
```

### ç»“è®ºä¸åæ€

**æˆ‘ä»Šå¤©ææ¸…æ¥šäº†**ï¼š

- å…±äº«è´£ä»»æ¨¡å‹ä¸­äº‘æä¾›å•†å’Œå®¢æˆ·çš„èŒè´£åˆ’åˆ†
- äº‘è´¦å·ä½“ç³»ç»“æ„å’Œç»„ç»‡å•å…ƒè®¾è®¡
- æœ€å°æƒé™åŸåˆ™çš„å®ç°æ–¹æ³•
- å¯†é’¥ç®¡ç†å’Œå‡­æ®è½®æ¢ç­–ç•¥
- ä¼ä¸šèº«ä»½è”é‚¦çš„é…ç½®æ–¹å¼

**æˆ‘å·®ç‚¹ææ··çš„æ˜¯**ï¼š

- ä¸åŒæœåŠ¡æ¨¡å‹ï¼ˆIaaS/PaaS/SaaSï¼‰çš„è´£ä»»å·®å¼‚
- IAM ç”¨æˆ·å’Œè§’è‰²çš„ä½¿ç”¨åœºæ™¯
- æƒé™è¾¹ç•Œå’Œæƒé™ç­–ç•¥çš„åŒºåˆ«

**æ˜å¤©æˆ‘è¦ç»§ç»­è¡¥çš„æ˜¯**ï¼š

- AWS/Azure äº‘å¹³å°å®‰å…¨
- å®¹å™¨å®‰å…¨åŸºç¡€
- Kubernetes å®‰å…¨

**æœ¬æ¬¡å­¦ä¹ è€—æ—¶**ï¼šçº¦ 4 å°æ—¶

**æŒæ¡ç¨‹åº¦è‡ªè¯„**ï¼š

- [ ] ğŸ˜• ç†è§£äº†åŸºæœ¬æ¦‚å¿µï¼Œä½†å®è·µä¸ç†Ÿç»ƒ
- [ ] ğŸ™‚ å®Œæˆäº†åŸºç¡€ä»»åŠ¡
- [ ] ğŸ˜ƒ å®Œæˆäº†æ‰€æœ‰ä»»åŠ¡å¹¶ç†è§£åŸç†
- [ ] ğŸ¤© é¢å¤–å®Œæˆäº†ä¼ä¸šèº«ä»½è”é‚¦é›†æˆ


## å­¦ä¹ æˆæœç¤ºä¾‹å¡«å†™ï¼ˆå¯ç…§æŠ„ï¼‰

> å¯å°†"ç¤ºä¾‹"å†…å®¹æ›¿æ¢ä¸ºä½ è‡ªå·±çš„æ—¶é—´ä¸æˆªå›¾æ–‡ä»¶åã€‚

### æˆªå›¾ä¸è¯æ®ï¼ˆç¤ºä¾‹ï¼‰

- ä»»åŠ¡ 1ï¼š`images/day064_task1.png`
- ä»»åŠ¡ 2ï¼š`images/day064_task2.png`
- ä»»åŠ¡ 3ï¼š`images/day064_task3.png`

### å…³é”®å‘½ä»¤ä¸è¾“å‡ºï¼ˆç¤ºä¾‹ï¼‰

```
å‘½ä»¤ç¤ºä¾‹ï¼š
è¾“å‡ºç¤ºä¾‹ï¼š
```

### ç»“è®ºä¸åæ€ï¼ˆç¤ºä¾‹ï¼‰

**æˆ‘ä»Šå¤©ææ¸…æ¥šäº†**ï¼š
- ï¼ˆç¤ºä¾‹ï¼‰ç†è§£äº†æ ¸å¿ƒæ¦‚å¿µ

**æˆ‘å·®ç‚¹ææ··çš„æ˜¯**ï¼š
- ï¼ˆç¤ºä¾‹ï¼‰æŸä¸ªæ˜“æ··æ·†ç‚¹

**æ˜å¤©æˆ‘è¦ç»§ç»­è¡¥çš„æ˜¯**ï¼š
- ï¼ˆç¤ºä¾‹ï¼‰ä¸‹ä¸€æ­¥æ·±å…¥æ–¹å‘

**æœ¬æ¬¡å­¦ä¹ è€—æ—¶**ï¼šçº¦ 2 å°æ—¶

**æŒæ¡ç¨‹åº¦è‡ªè¯„**ï¼š
- [x] ğŸ˜ƒ å®Œæˆäº†æ‰€æœ‰ä»»åŠ¡å¹¶ç†è§£åŸç†
