---
title: Day054ï¼šæ¸—é€æµ‹è¯•æ–¹æ³•è®º - æŠ¥å‘Šæ’°å†™ä¸è¯„åˆ†å‚è€ƒï¼ˆCVSSï¼‰
tags:
  - ç½‘ç»œ
  - å®‰å…¨
  - å­¦ä¹ è®¡åˆ’
categories:
  - ç½‘ç»œå®‰å…¨
abbrlink: cf5908ca
date: 2026-02-16 00:00:00
updated: 2026-02-16 00:00:00

---
# Day054ï¼šæ¸—é€æµ‹è¯•æ–¹æ³•è®º - æŠ¥å‘Šæ’°å†™ä¸è¯„åˆ†å‚è€ƒï¼ˆCVSSï¼‰

- æ—¥æœŸï¼š2026-02-16
- å‘¨æ¬¡ï¼šç¬¬8å‘¨

## å­¦ä¹ ç›®æ ‡

ä»Šå¤©ä½ å°†æŒæ¡æ¸—é€æµ‹è¯•æŠ¥å‘Šæ’°å†™ä¸é£é™©è¯„åˆ†çš„æ ¸å¿ƒçŸ¥è¯†ï¼š

- **ç†è§£æŠ¥å‘Šç»“æ„**ï¼šæŒæ¡æ¸—é€æµ‹è¯•æŠ¥å‘Šçš„æ ‡å‡†ç»“æ„å’Œå†…å®¹è¦æ±‚
- **æŒæ¡ CVSS è¯„åˆ†**ï¼šèƒ½å‡†ç¡®è®¡ç®—æ¼æ´çš„ CVSS è¯„åˆ†å¹¶ç¡®å®šé£é™©ç­‰çº§
- **åˆ†æä¸šåŠ¡å½±å“**ï¼šèƒ½å°†æŠ€æœ¯æ¼æ´è½¬åŒ–ä¸ºä¸šåŠ¡é£é™©
- **ç¼–å†™ä¿®å¤å»ºè®®**ï¼šèƒ½ç»™å‡ºå¯æ“ä½œçš„æ¼æ´ä¿®å¤å»ºè®®
- **å‘ˆç°æµ‹è¯•æˆæœ**ï¼šèƒ½å‘ä¸åŒå—ä¼—ï¼ˆæŠ€æœ¯å›¢é˜Ÿã€ç®¡ç†å±‚ï¼‰æœ‰æ•ˆä¼ è¾¾ç»“æœ

---

<!--more-->

## å­¦ä¹ å†…å®¹

### 1ï¸âƒ£ æ¸—é€æµ‹è¯•æŠ¥å‘Šç»“æ„

#### 1.1 æ ‡å‡†æŠ¥å‘Šæ¡†æ¶

```python
#!/usr/bin/env python3
"""
æ¸—é€æµ‹è¯•æŠ¥å‘Šç”Ÿæˆå™¨
è‡ªåŠ¨ç”Ÿæˆç¬¦åˆè¡Œä¸šæ ‡å‡†çš„æ¸—é€æµ‹è¯•æŠ¥å‘Š
"""
from __future__ import annotations
from dataclasses import dataclass, field
from datetime import datetime
from typing import Optional
from pathlib import Path
import json


@dataclass
class Finding:
    """å®‰å…¨å‘ç°"""
    id: str
    title: str
    description: str
    severity: str  # Critical, High, Medium, Low
    cvss_score: float
    cvss_vector: str
    affected_asset: str
    affected_component: str
    remediation: str
    status: str  # Open, In Progress, Closed
    discovered_date: datetime
    assigned_to: Optional[str] = None
    due_date: Optional[datetime] = None
    evidence: list[str] = field(default_factory=list)
    references: list[str] = field(default_factory=list)
    business_impact: str = ""
    exploitation_difficulty: str = "Medium"


@dataclass
class EngagementInfo:
    """æµ‹è¯•é¡¹ç›®ä¿¡æ¯"""
    id: str
    client_name: str
    project_name: str
    scope: str
    start_date: datetime
    end_date: datetime
    tester_name: str
    tester_certification: list[str]
    methodology: str = "PTES"


@dataclass
class ExecutiveSummary:
    """æ‰§è¡Œæ‘˜è¦"""
    overall_risk: str  # High, Medium, Low
    total_findings: int
    critical_findings: int
    high_findings: int
    medium_findings: int
    low_findings: int
    key_findings: list[str]
    business_impact_summary: str
    recommendations_summary: str


class PenetrationTestReport:
    """æ¸—é€æµ‹è¯•æŠ¥å‘Š"""
    
    def __init__(self, engagement: EngagementInfo):
        self.engagement = engagement
        self.findings: list[Finding] = []
        self.executive_summary: Optional[ExecutiveSummary] = None
    
    def add_finding(self, finding: Finding) -> None:
        """æ·»åŠ å®‰å…¨å‘ç°"""
        self.findings.append(finding)
    
    def generate_executive_summary(self) -> ExecutiveSummary:
        """ç”Ÿæˆæ‰§è¡Œæ‘˜è¦"""
        critical = len([f for f in self.findings if f.severity == "Critical"])
        high = len([f for f in self.findings if f.severity == "High"])
        medium = len([f for f in self.findings if f.severity == "Medium"])
        low = len([f for f in self.findings if f.severity == "Low"])
        
        # è®¡ç®—æ€»ä½“é£é™©
        if critical > 0 or high > 3:
            overall_risk = "High"
        elif high > 0 or medium > 5:
            overall_risk = "Medium"
        else:
            overall_risk = "Low"
        
        # å…³é”®å‘ç°
        key_findings = [
            f"{f.title} ({f.severity})"
            for f in sorted(
                self.findings, 
                key=lambda x: (-self._severity_weight(x.severity), -x.cvss_score)
            )[:5]
        ]
        
        self.executive_summary = ExecutiveSummary(
            overall_risk=overall_risk,
            total_findings=len(self.findings),
            critical_findings=critical,
            high_findings=high,
            medium_findings=medium,
            low_findings=low,
            key_findings=key_findings,
            business_impact_summary=f"æœ¬æ¬¡æµ‹è¯•å…±å‘ç° {len(self.findings)} ä¸ªå®‰å…¨é—®é¢˜ï¼Œå…¶ä¸­ {critical + high} ä¸ªéœ€è¦ç´§æ€¥å¤„ç†ã€‚",
            recommendations_summary="å»ºè®®ç«‹å³ä¿®å¤ Critical å’Œ High çº§åˆ«æ¼æ´ï¼Œå¹¶åœ¨ 2 å‘¨å†…å®Œæˆ Medium çº§åˆ«æ¼æ´ä¿®å¤ã€‚"
        )
        
        return self.executive_summary
    
    def _severity_weight(self, severity: str) -> int:
        """ä¸¥é‡æ€§æƒé‡"""
        weights = {"Critical": 4, "High": 3, "Medium": 2, "Low": 1, "Info": 0}
        return weights.get(severity, 0)
    
    def generate_markdown_report(self) -> str:
        """ç”Ÿæˆ Markdown æ ¼å¼æŠ¥å‘Š"""
        if not self.executive_summary:
            self.generate_executive_summary()
        
        report_lines = [
            "# æ¸—é€æµ‹è¯•æŠ¥å‘Š",
            "",
            "---",
            "",
            "## é¡¹ç›®ä¿¡æ¯",
            "",
            f"**é¡¹ç›® ID**: {self.engagement.id}",
            f"**å®¢æˆ·åç§°**: {self.engagement.client_name}",
            f"**é¡¹ç›®åç§°**: {self.engagement.project_name}",
            f"**æµ‹è¯•èŒƒå›´**: {self.engagement.scope}",
            f"**æµ‹è¯•æ—¶é—´**: {self.engagement.start_date.strftime('%Y-%m-%d')} è‡³ {self.engagement.end_date.strftime('%Y-%m-%d')}",
            f"**æµ‹è¯•äººå‘˜**: {self.engagement.tester_name}",
            f"**è®¤è¯èµ„è´¨**: {', '.join(self.engagement.tester_certification)}",
            f"**æµ‹è¯•æ–¹æ³•**: {self.engagement.methodology}",
            "",
            "---",
            "",
            "## æ‰§è¡Œæ‘˜è¦",
            "",
            f"**æ€»ä½“é£é™©ç­‰çº§**: {self.executive_summary.overall_risk}",
            "",
            "### å‘ç°ç»Ÿè®¡",
            "",
            "| çº§åˆ« | æ•°é‡ |",
            "|------|------|",
            f"| Critical | {self.executive_summary.critical_findings} |",
            f"| High | {self.executive_summary.high_findings} |",
            f"| Medium | {self.executive_summary.medium_findings} |",
            f"| Low | {self.executive_summary.low_findings} |",
            "",
            "### å…³é”®å‘ç°",
            "",
        ]
        
        for i, finding in enumerate(key_findings, 1):
            report_lines.append(f"{i}. {finding}")
        
        report_lines.extend([
            "",
            "### ä¸šåŠ¡å½±å“æ¦‚è¿°",
            "",
            self.executive_summary.business_impact_summary,
            "",
            "### ä¿®å¤å»ºè®®æ¦‚è¿°",
            "",
            self.executive_summary.recommendations_summary,
            "",
            "---",
            "",
            "## è¯¦ç»†å‘ç°",
            "",
        ])
        
        # æŒ‰ä¸¥é‡æ€§åˆ†ç»„æ˜¾ç¤ºå‘ç°
        for severity in ["Critical", "High", "Medium", "Low"]:
            severity_findings = [
                f for f in self.findings 
                if f.severity == severity
            ]
            
            if severity_findings:
                report_lines.append(f"### {severity} çº§åˆ«æ¼æ´ ({len(severity_findings)}ä¸ª)")
                report_lines.append("")
                
                for finding in sorted(
                    severity_findings, 
                    key=lambda x: -x.cvss_score
                ):
                    report_lines.extend([
                        f"#### {finding.id}: {finding.title}",
                        "",
                        f"**CVSS è¯„åˆ†**: {finding.cvss_score} ({finding.cvss_vector})",
                        f"**é£é™©ç­‰çº§**: {finding.severity}",
                        f"**å½±å“èµ„äº§**: {finding.affected_asset}",
                        f"**å½±å“ç»„ä»¶**: {finding.affected_component}",
                        "",
                        "**æ¼æ´æè¿°**",
                        "",
                        finding.description,
                        "",
                        "**ä¸šåŠ¡å½±å“**",
                        "",
                        finding.business_impact,
                        "",
                        "**åˆ©ç”¨éš¾åº¦**",
                        "",
                        finding.exploitation_difficulty,
                        "",
                        "**ä¿®å¤å»ºè®®**",
                        "",
                        finding.remediation,
                        "",
                        "**è¯æ®**",
                        "",
                    ])
                    
                    if finding.evidence:
                        for evidence in finding.evidence:
                            report_lines.append(f"- {evidence}")
                    else:
                        report_lines.append("ï¼ˆè§é™„ä»¶æˆªå›¾ï¼‰")
                    
                    report_lines.append("")
        
        return '\n'.join(report_lines)
    
    def generate_html_report(self) -> str:
        """ç”Ÿæˆ HTML æ ¼å¼æŠ¥å‘Š"""
        markdown = self.generate_markdown_report()
        
        # ç®€å•è½¬æ¢ Markdown ä¸º HTML
        html = f"""
<!DOCTYPE html>
<html>
<head>
    <title>æ¸—é€æµ‹è¯•æŠ¥å‘Š - {self.engagement.project_name}</title>
    <style>
        body {{ font-family: Arial, sans-serif; margin: 40px; }}
        h1 {{ color: #333; }}
        h2 {{ color: #555; border-bottom: 2px solid #eee; }}
        h3 {{ color: #666; }}
        table {{ border-collapse: collapse; width: 100%; margin: 20px 0; }}
        th: 1px, td {{ border solid #ddd; padding: 12px; text-align: left; }}
        th {{ background-color: #f5f5f5; }}
        .Critical {{ background-color: #ffcccc; color: #990000; }}
        .High {{ background-color: #ffe6cc; color: #994c00; }}
        .Medium {{ background-color: #ffffcc; color: #666600; }}
        .Low {{ background-color: #ccffcc; color: #006600; }}
        .code {{ background-color: #f5f5f5; padding: 10px; font-family: monospace; }}
    </style>
</head>
<body>
    {self._markdown_to_html(markdown)}
</body>
</html>
        """
        
        return html
    
    def _markdown_to_html(self, md: str) -> str:
        """ç®€å• Markdown è½¬ HTML"""
        import re
        
        # æ ‡é¢˜
        md = re.sub(r'^# (.+)$', r'<h1>\1</h1>', md, flags=re.MULTILINE)
        md = re.sub(r'^## (.+)$', r'<h2>\1</h2>', md, flags=re.MULTILINE)
        md = re.sub(r'^### (.+)$', r'<h3>\1</h3>', md, flags=re.MULTILINE)
        
        # ç²—ä½“
        md = re.sub(r'\*\*(.+?)\*\*', r'<strong>\1</strong>', md)
        
        # è¡¨æ ¼
        lines = md.split('\n')
        in_table = False
        html_lines = []
        
        for line in lines:
            if line.startswith('|') and not in_table:
                in_table = True
                html_lines.append('<table>')
            elif not line.startswith('|') and in_table:
                in_table = False
                html_lines.append('</table>')
            
            if in_table:
                if '---' in line:
                    continue
                cells = [c.strip() for c in line.split('|')[1:-1]]
                html_cells = [f'<td>{c}</td>' for c in cells]
                html_lines.append(f'<tr>{"".join(html_cells)}</tr>')
            else:
                html_lines.append(line if line else '<br>')
        
        return '\n'.join(html_lines)
    
    def export_report(self, output_path: str, format: str = "markdown") -> None:
        """å¯¼å‡ºæŠ¥å‘Š"""
        if format == "markdown":
            content = self.generate_markdown_report()
            with open(output_path, 'w', encoding='utf-8') as f:
                f.write(content)
        elif format == "html":
            content = self.generate_html_report()
            with open(output_path, 'w', encoding='utf-8') as f:
                f.write(content)
        elif format == "json":
            self._export_json(output_path)
    
    def _export_json(self, output_path: str) -> None:
        """å¯¼å‡º JSON æ ¼å¼"""
        data = {
            "engagement": {
                "id": self.engagement.id,
                "client": self.engagement.client_name,
                "project": self.engagement.project_name,
                "scope": self.engagement.scope,
                "period": f"{self.engagement.start_date} to {self.engagement.end_date}"
            },
            "executive_summary": {
                "overall_risk": self.executive_summary.overall_risk,
                "total_findings": self.executive_summary.total_findings,
                "by_severity": {
                    "Critical": self.executive_summary.critical_findings,
                    "High": self.executive_summary.high_findings,
                    "Medium": self.executive_summary.medium_findings,
                    "Low": self.executive_summary.low_findings
                }
            },
            "findings": [
                {
                    "id": f.id,
                    "title": f.title,
                    "severity": f.severity,
                    "cvss": f.cvss_score,
                    "cvss_vector": f.cvss_vector,
                    "asset": f.affected_asset,
                    "remediation": f.remediation
                }
                for f in self.findings
            ]
        }
        
        with open(output_path, 'w', encoding='utf-8') as f:
            json.dump(data, f, indent=2, ensure_ascii=False)
```

#### 1.2 æŠ¥å‘Šæ¨¡æ¿ç¤ºä¾‹

```markdown
# æ¸—é€æµ‹è¯•æŠ¥å‘Š

## 1. é¡¹ç›®æ¦‚è¿°

### 1.1 æµ‹è¯•èƒŒæ™¯
æœ¬æ¬¡æ¸—é€æµ‹è¯•æ˜¯ä¸ºäº†è¯„ä¼°ç›®æ ‡ç³»ç»Ÿçš„å®‰å…¨çŠ¶å†µï¼Œè¯†åˆ«æ½œåœ¨çš„å®‰å…¨æ¼æ´ï¼Œå¹¶æä¾›ä¿®å¤å»ºè®®ã€‚

### 1.2 æµ‹è¯•èŒƒå›´
- **æµ‹è¯•ç›®æ ‡**: 10.0.0.0/24 ç½‘æ®µ
- **æµ‹è¯•ç±»å‹**: é»‘ç›’æµ‹è¯•
- **æµ‹è¯•æ—¶é—´**: 2024-01-15 è‡³ 2024-01-20

### 1.3 æµ‹è¯•æ–¹æ³•
æœ¬æ¬¡æµ‹è¯•éµå¾ª PTES (Penetration Testing Execution Standard) æ ‡å‡†ã€‚

---

## 2. æ‰§è¡Œæ‘˜è¦

### 2.1 æ€»ä½“é£é™©è¯„ä¼°
**é£é™©ç­‰çº§**: High

æµ‹è¯•æœŸé—´å…±å‘ç° 15 ä¸ªå®‰å…¨æ¼æ´ï¼Œå…¶ä¸­ï¼š
- Critical: 2 ä¸ª
- High: 5 ä¸ª
- Medium: 6 ä¸ª
- Low: 2 ä¸ª

### 2.2 å…³é”®å‘ç°
1. MS17-010 è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ï¼ˆCriticalï¼‰
2. SQL æ³¨å…¥å¯¼è‡´æ•°æ®åº“æ³„éœ²ï¼ˆHighï¼‰
3. å¼±å£ä»¤é—®é¢˜ï¼ˆHighï¼‰
4. æ•æ„Ÿä¿¡æ¯æ³„éœ²ï¼ˆMediumï¼‰

### 2.3 ä¸šåŠ¡å½±å“
å‘ç°çš„å…³é”®æ¼æ´å¯èƒ½å¯¼è‡´ï¼š
- æœåŠ¡å™¨è¢«å®Œå…¨æ§åˆ¶
- å®¢æˆ·æ•°æ®æ³„éœ²
- ç³»ç»Ÿå¯ç”¨æ€§å—å½±å“

---

## 3. è¯¦ç»†å‘ç°

### 3.1 Critical çº§åˆ«æ¼æ´

#### VULN-001: MS17-010 è¿œç¨‹ä»£ç æ‰§è¡Œ

**CVSS è¯„åˆ†**: 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**å½±å“èµ„äº§**: 10.0.0.10 (Windows Server 2016)

**æ¼æ´æè¿°**:
ç›®æ ‡æœåŠ¡å™¨å­˜åœ¨ MS17-010ï¼ˆæ°¸æ’ä¹‹è“ï¼‰æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„ SMB åŒ…è¿œç¨‹æ‰§è¡Œä»»æ„ä»£ç ã€‚

**é£é™©åˆ†æ**:
- æ”»å‡»è€…å¯ä»¥è·å–ç³»ç»Ÿå®Œå…¨æ§åˆ¶æƒ
- å¯ç”¨äºå†…ç½‘æ¨ªå‘ç§»åŠ¨
- å¯èƒ½å¯¼è‡´æ•°æ®æ³„éœ²å’Œå‹’ç´¢

**éªŒè¯æ–¹æ³•**:
```python
# ä½¿ç”¨ Nmap è„šæœ¬æ£€æµ‹
nmap --script smb-vuln-ms17-010 10.0.0.10
```

**ä¿®å¤å»ºè®®**:
1. å®‰è£…å®‰å…¨æ›´æ–° KB4012598
2. ç¦ç”¨ SMBv1 åè®®
3. åœ¨é˜²ç«å¢™ä¸Šé˜»æ­¢ 445 ç«¯å£

**å‚è€ƒèµ„æ–™**:
- CVE-2017-0144
- Microsoft Security Bulletin MS17-010

---

## 4. ä¿®å¤è®¡åˆ’

### 4.1 ç´§æ€¥ä¿®å¤ï¼ˆ24å°æ—¶å†…ï¼‰
1. ä¿®å¤ MS17-010 æ¼æ´
2. æ›´æ”¹æ‰€æœ‰å¼±å£ä»¤

### 4.2 çŸ­æœŸä¿®å¤ï¼ˆ1å‘¨å†…ï¼‰
1. ä¿®å¤ SQL æ³¨å…¥æ¼æ´
2. é…ç½®å®‰å…¨å“åº”å¤´
3. å®æ–½é€Ÿç‡é™åˆ¶

### 4.3 é•¿æœŸæ”¹è¿›ï¼ˆ1ä¸ªæœˆå†…ï¼‰
1. å»ºç«‹å®‰å…¨å¼€å‘æµç¨‹
2. å®æ–½å®‰å…¨ç¼–ç è§„èŒƒ
3. å»ºç«‹æŒç»­å®‰å…¨ç›‘æ§

---

## 5. é™„å½•

### A. æµ‹è¯•å·¥å…·æ¸…å•
- Nmap 7.94
- Metasploit Framework 6.3
- Burp Suite Professional
- SQLMap 1.7

### B. è¯æ®æ¸…å•
- æˆªå›¾ 23 å¼ 
- æŠ“åŒ…æ–‡ä»¶ 5 ä¸ª
- æ‰«ææŠ¥å‘Š 3 ä»½
```

---

### 2ï¸âƒ£ CVSS è¯„åˆ†è¯¦è§£

#### 2.1 CVSS 3.1 è®¡ç®—å™¨

```python
#!/usr/bin/env python3
"""
CVSS 3.1 è¯„åˆ†è®¡ç®—ä¸é£é™©ç­‰çº§ç¡®å®š
"""
from __future__ import annotations
from dataclasses import dataclass
from enum import Enum
import math


class AttackVector(Enum):
    """æ”»å‡»å‘é‡"""
    NETWORK = "N"
    ADJACENT = "A"
    LOCAL = "L"
    PHYSICAL = "P"


class AttackComplexity(Enum):
    """æ”»å‡»å¤æ‚åº¦"""
    LOW = "L"
    HIGH = "H"


class PrivilegesRequired(Enum):
    """æ‰€éœ€æƒé™"""
    NONE = "N"
    LOW = "L"
    HIGH = "H"


class UserInteraction(Enum):
    """ç”¨æˆ·äº¤äº’"""
    NONE = "N"
    REQUIRED = "R"


class Scope(Enum):
    """å½±å“èŒƒå›´"""
    UNCHANGED = "U"
    CHANGED = "C"


class ImpactLevel(Enum):
    """å½±å“ç¨‹åº¦"""
    HIGH = "H"
    LOW = "L"
    NONE = "N"


@dataclass
class CVSSVector:
    """CVSS å‘é‡"""
    attack_vector: AttackVector
    attack_complexity: AttackComplexity
    privileges_required: PrivilegesRequired
    user_interaction: UserInteraction
    scope: Scope
    confidentiality: ImpactLevel
    integrity: ImpactLevel
    availability: ImpactLevel


class CVSSCalculator:
    """CVSS 3.1 è®¡ç®—å™¨"""
    
    # æƒé‡è¡¨
    WEIGHTS = {
        'AV': {'N': 0.85, 'A': 0.62, 'L': 0.55, 'P': 0.20},
        'AC': {'L': 0.77, 'H': 0.44},
        'PR': {
            'U': {'N': 0.85, 'L': 0.62, 'H': 0.27},
            'C': {'N': 0.85, 'L': 0.68, 'H': 0.50}
        },
        'UI': {'N': 0.85, 'R': 0.62},
        'C': {'H': 0.56, 'L': 0.22, 'N': 0.0},
        'I': {'H': 0.56, 'L': 0.22, 'N': 0.0},
        'A': {'H': 0.56, 'L': 0.22, 'N': 0.0}
    }
    
    @classmethod
    def calculate_base_score(cls, vector: CVSSVector) -> float:
        """è®¡ç®—åŸºç¡€è¯„åˆ†"""
        AV = cls.WEIGHTS['AV'][vector.attack_vector.value]
        AC = cls.WEIGHTS['AC'][vector.attack_complexity.value]
        
        if vector.scope == Scope.UNCHANGED:
            PR = cls.WEIGHTS['PR']['U'][vector.privileges_required.value]
        else:
            PR = cls.WEIGHTS['PR']['C'][vector.privileges_required.value]
        
        UI = cls.WEIGHTS['UI'][vector.user_interaction.value]
        
        C = cls.WEIGHTS['C'][vector.confidentiality.value]
        I = cls.WEIGHTS['I'][vector.integrity.value]
        A = cls.WEIGHTS['A'][vector.availability.value]
        
        # è®¡ç®— ISS
        iss = 1 - ((1 - C) * (1 - I) * (1 - A))
        
        # è®¡ç®— Impact
        if vector.scope == Scope.UNCHANGED:
            impact = 6.42 * iss
        else:
            impact = 7.52 * (iss - 0.029) - 3.25 * (iss - 0.02) ** 15
        
        # è®¡ç®— Exploitability
        exploitability = 8.22 * AV * AC * PR * UI
        
        # è®¡ç®— Base Score
        if impact <= 0:
            base_score = 0
        else:
            if vector.scope == Scope.UNCHANGED:
                base_score = min((impact + exploitability), 10)
            else:
                base_score = min(1.08 * (impact + exploitability), 10)
        
        return round(base_score, 1)
    
    @classmethod
    def get_severity(cls, score: float) -> str:
        """è·å–ä¸¥é‡æ€§ç­‰çº§"""
        if score >= 9.0:
            return "Critical"
        elif score >= 7.0:
            return "High"
        elif score >= 4.0:
            return "Medium"
        elif score > 0:
            return "Low"
        else:
            return "None"
    
    @classmethod
    def generate_vector_string(cls, vector: CVSSVector) -> str:
        """ç”Ÿæˆ CVSS å‘é‡å­—ç¬¦ä¸²"""
        return (
            f"CVSS:3.1/AV:{vector.attack_vector.value}/"
            f"AC:{vector.attack_complexity.value}/"
            f"PR:{vector.privileges_required.value}/"
            f"UI:{vector.user_interaction.value}/"
            f"S:{vector.scope.value}/"
            f"C:{vector.confidentiality.value}/"
            f"I:{vector.integrity.value}/"
            f"A:{vector.availability.value}"
        )


# ç¤ºä¾‹ï¼šå¸¸è§æ¼æ´çš„ CVSS è®¡ç®—
EXAMPLES = {
    "è¿œç¨‹ä»£ç æ‰§è¡Œ (RCE)": CVSSVector(
        attack_vector=AttackVector.NETWORK,
        attack_complexity=AttackComplexity.LOW,
        privileges_required=PrivilegesRequired.NONE,
        user_interaction=UserInteraction.NONE,
        scope=Scope.UNCHANGED,
        confidentiality=ImpactLevel.HIGH,
        integrity=ImpactLevel.HIGH,
        availability=ImpactLevel.HIGH
    ),
    "SQL æ³¨å…¥ (æ•°æ®æ³„éœ²)": CVSSVector(
        attack_vector=AttackVector.NETWORK,
        attack_complexity=AttackComplexity.LOW,
        privileges_required=PrivilegesRequired.NONE,
        user_interaction=UserInteraction.NONE,
        scope=Scope.UNCHANGED,
        confidentiality=ImpactLevel.HIGH,
        integrity=ImpactLevel.NONE,
        availability=ImpactLevel.NONE
    ),
    "XSS (å­˜å‚¨å‹)": CVSSVector(
        attack_vector=AttackVector.NETWORK,
        attack_complexity=AttackComplexity.LOW,
        privileges_required=PrivilegesRequired.NONE,
        user_interaction=UserInteraction.REQUIRED,
        scope=Scope.CHANGED,
        confidentiality=ImpactLevel.LOW,
        integrity=ImpactLevel.LOW,
        availability=ImpactLevel.NONE
    ),
    "å¼±å£ä»¤": CVSSVector(
        attack_vector=AttackVector.NETWORK,
        attack_complexity=AttackComplexity.LOW,
        privileges_required=PrivilegesRequired.NONE,
        user_interaction=UserInteraction.NONE,
        scope=Scope.UNCHANGED,
        confidentiality=ImpactLevel.HIGH,
        integrity=ImpactLevel.HIGH,
        availability=ImpactLevel.HIGH
    )
}

if __name__ == "__main__":
    print("CVSS 3.1 è¯„åˆ†ç¤ºä¾‹:")
    print("=" * 60)
    
    for name, vector in EXAMPLES.items():
        score = CVSSCalculator.calculate_base_score(vector)
        severity = CVSSCalculator.get_severity(score)
        vector_str = CVSSCalculator.generate_vector_string(vector)
        
        print(f"\n{name}:")
        print(f"  è¯„åˆ†: {score}")
        print(f"  ä¸¥é‡æ€§: {severity}")
        print(f"  å‘é‡: {vector_str}")
```

#### 2.2 ä¸šåŠ¡å½±å“æ˜ å°„

```python
#!/usr/bin/env python3
"""
æ¼æ´ä¸šåŠ¡å½±å“åˆ†æ
"""
from __future__ import annotations
from dataclasses import dataclass
from enum import Enum
from typing import Optional


class BusinessImpact(Enum):
    """ä¸šåŠ¡å½±å“ç­‰çº§"""
    CRITICAL = "å¯¼è‡´é‡å¤§ä¸šåŠ¡ä¸­æ–­æˆ–å·¨é¢æŸå¤±"
    HIGH = "å¯¼è‡´ä¸¥é‡ä¸šåŠ¡å½±å“æˆ–é‡å¤§æ•°æ®æ³„éœ²"
    MEDIUM = "å¯¼è‡´ä¸€å®šä¸šåŠ¡å½±å“æˆ–æ•°æ®æ³„éœ²é£é™©"
    LOW = "è½»å¾®ä¸šåŠ¡å½±å“"
    MINIMAL = "å‡ ä¹æ— ä¸šåŠ¡å½±å“"


@dataclass
class ImpactFactor:
    """å½±å“å› å­"""
    financial_loss: float  # 0-10
    data_breach: float     # 0-10
    reputation_damage: float  # 0-10
    regulatory_compliance: float  # 0-10
    operational_impact: float  # 0-10


class BusinessImpactAnalyzer:
    """ä¸šåŠ¡å½±å“åˆ†æå™¨"""
    
    # è¡Œä¸šç³»æ•°
    INDUSTRY_MULTIPLIERS = {
        "finance": 1.5,      # é‡‘èè¡Œä¸šå½±å“æ›´å¤§
        "healthcare": 1.4,   # åŒ»ç–—è¡Œä¸šå½±å“å¤§
        "ecommerce": 1.3,    # ç”µå•†å½±å“è¾ƒå¤§
        "technology": 1.2,   # ç§‘æŠ€è¡Œä¸šå½±å“ä¸€èˆ¬
        "government": 1.4,   # æ”¿åºœå½±å“å¤§
        "education": 1.1     # æ•™è‚²è¡Œä¸šå½±å“è¾ƒå°
    }
    
    @classmethod
    def calculate_business_impact(
        cls,
        cvss_score: float,
        data_sensitivity: str,  # public, internal, confidential, restricted
        asset_criticality: str,  # low, medium, high, critical
        industry: str,
        exploitability: str  # easy, medium, hard
    ) -> dict:
        """è®¡ç®—ä¸šåŠ¡å½±å“"""
        
        # åŸºç¡€ä¸šåŠ¡å½±å“åˆ†æ•°
        base_impact = cvss_score
        
        # æ•°æ®æ•æ„Ÿåº¦è°ƒæ•´
        sensitivity_multipliers = {
            "public": 0.8,
            "internal": 1.0,
            "confidential": 1.3,
            "restricted": 1.5
        }
        base_impact *= sensitivity_multipliers.get(data_sensitivity, 1.0)
        
        # èµ„äº§å…³é”®æ€§è°ƒæ•´
        criticality_multipliers = {
            "low": 0.8,
            "medium": 1.0,
            "high": 1.3,
            "critical": 1.5
        }
        base_impact *= criticality_multipliers.get(asset_criticality, 1.0)
        
        # è¡Œä¸šè°ƒæ•´
        base_impact *= cls.INDUSTRY_MULTIPLIERS.get(industry, 1.0)
        
        # åˆ©ç”¨éš¾åº¦è°ƒæ•´
        exploitability_multipliers = {
            "easy": 1.3,
            "medium": 1.0,
            "hard": 0.7
        }
        base_impact *= exploitability_multipliers.get(exploitability, 1.0)
        
        # æœ€ç»ˆè¯„åˆ†
        final_score = min(10, base_impact)
        
        # ç¡®å®šå½±å“ç­‰çº§
        if final_score >= 9:
            impact_level = BusinessImpact.CRITICAL
        elif final_score >= 7:
            impact_level = BusinessImpact.HIGH
        elif final_score >= 5:
            impact_level = BusinessImpact.MEDIUM
        elif final_score >= 3:
            impact_level = BusinessImpact.LOW
        else:
            impact_level = BusinessImpact.MINIMAL
        
        return {
            "cvss_score": cvss_score,
            "business_impact_score": round(final_score, 1),
            "impact_level": impact_level.value,
            "recommendation": cls._get_recommendation(final_score),
            "remediation_timeline": cls._get_timeline(final_score)
        }
    
    @classmethod
    def _get_recommendation(cls, score: float) -> str:
        """è·å–å¤„ç†å»ºè®®"""
        if score >= 9:
            return "ç«‹å³å¤„ç† - éœ€è¦åœ¨24å°æ—¶å†…å®Œæˆä¿®å¤"
        elif score >= 7:
            return "ç´§æ€¥å¤„ç† - éœ€è¦åœ¨72å°æ—¶å†…å®Œæˆä¿®å¤"
        elif score >= 5:
            return "ä¼˜å…ˆå¤„ç† - éœ€è¦åœ¨2å‘¨å†…å®Œæˆä¿®å¤"
        elif score >= 3:
            return "è®¡åˆ’å¤„ç† - åœ¨ä¸‹ä¸€ä¸ªç»´æŠ¤çª—å£ä¿®å¤"
        else:
            return "å¸¸è§„å¤„ç† - èµ„æºå…è®¸æ—¶ä¿®å¤"
    
    @classmethod
    def _get_timeline(cls, score: float) -> str:
        """è·å–ä¿®å¤æ—¶é—´çº¿"""
        if score >= 9:
            return "24å°æ—¶"
        elif score >= 7:
            return "72å°æ—¶"
        elif score >= 5:
            return "2å‘¨"
        elif score >= 3:
            return "1ä¸ªæœˆ"
        else:
            return "3ä¸ªæœˆ"
```

---

### 3ï¸âƒ£ ä¿®å¤å»ºè®®ç¼–å†™

#### 3.1 ä¿®å¤å»ºè®®æ¨¡æ¿

```python
#!/usr/bin/env python3
"""
ä¿®å¤å»ºè®®ç”Ÿæˆå™¨
"""
from __future__ import annotations
from dataclasses import dataclass
from typing import list


@dataclass
class Remediation:
    """ä¿®å¤å»ºè®®"""
    id: str
    vulnerability_type: str
    title: str
    priority: str  # P1-P4
    effort: str    # Small, Medium, Large
    steps: list[str]
    code_examples: list[str]
    references: list[str]
    verification: str


class RemediationGenerator:
    """ä¿®å¤å»ºè®®ç”Ÿæˆå™¨"""
    
    REMEDIATIONS = {
        "sql_injection": Remediation(
            id="REM-SQL-001",
            vulnerability_type="SQL Injection",
            title="ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢é˜²æ­¢ SQL æ³¨å…¥",
            priority="P1",
            effort="Small",
            steps=[
                "è¯†åˆ«æ‰€æœ‰æ•°æ®åº“äº¤äº’ä»£ç ",
                "å°†åŠ¨æ€ SQL æŸ¥è¯¢æ›¿æ¢ä¸ºå‚æ•°åŒ–æŸ¥è¯¢",
                "ä½¿ç”¨ ORM æ¡†æ¶ï¼ˆå¦‚ SQLAlchemyã€Django ORMï¼‰",
                "å®æ–½è¾“å…¥éªŒè¯å’Œç™½åå•è¿‡æ»¤"
            ],
            code_examples=[
                "# âŒ é”™è¯¯ç¤ºä¾‹",
                "query = f\"SELECT * FROM users WHERE id = {user_id}\"",
                "",
                "# âœ… æ­£ç¡®ç¤ºä¾‹",
                "cursor.execute(\"SELECT * FROM users WHERE id = %s\", (user_id,))"
            ],
            references=[
                "OWASP SQL Injection Prevention",
                "CWE-89"
            ],
            verification="ä½¿ç”¨ SQLMap ç­‰å·¥å…·éªŒè¯æ¼æ´å·²ä¿®å¤"
        ),
        "xss": Remediation(
            id="REM-XSS-001",
            vulnerability_type="Cross-Site Scripting",
            title="å®æ–½è¾“å‡ºç¼–ç å’Œå†…å®¹å®‰å…¨ç­–ç•¥",
            priority="P1",
            effort="Small",
            steps=[
                "åœ¨æ‰€æœ‰ç”¨æˆ·è¾“å…¥è¾“å‡ºç‚¹å®æ–½ HTML ç¼–ç ",
                "é…ç½® Content-Security-Policy å“åº”å¤´",
                "å¯ç”¨ X-XSS-Protection å“åº”å¤´",
                "ä½¿ç”¨å®‰å…¨çš„ JavaScript æ¡†æ¶ï¼ˆReactã€Vueï¼‰"
            ],
            code_examples=[
                "# Flask ç¤ºä¾‹",
                "from markupsafe import escape",
                "",
                "# ç¼–ç ç”¨æˆ·è¾“å…¥",
                "user_input = escape(request.args.get('input'))",
                "",
                "# CSP å“åº”å¤´",
                "response.headers['Content-Security-Policy'] = \"default-src 'self'\""
            ],
            references=[
                "OWASP XSS Prevention",
                "CWE-79"
            ],
            verification="ä½¿ç”¨ XSS æ‰«æå·¥å…·éªŒè¯æ— åå°„å‹/å­˜å‚¨å‹ XSS"
        ),
        "rce": Remediation(
            id="REM-RCE-001",
            vulnerability_type="Remote Code Execution",
            title="é˜²æ­¢å‘½ä»¤æ³¨å…¥å’Œä»£ç æ‰§è¡Œæ¼æ´",
            priority="P1",
            effort="Medium",
            steps=[
                "é¿å…ä½¿ç”¨ system()ã€exec() ç­‰å‡½æ•°æ‰§è¡Œç³»ç»Ÿå‘½ä»¤",
                "å¦‚æœå¿…é¡»ä½¿ç”¨ï¼Œå®æ–½ä¸¥æ ¼çš„è¾“å…¥éªŒè¯",
                "ä½¿ç”¨ç™½åå•éªŒè¯æ‰€æœ‰ç”¨æˆ·è¾“å…¥",
                "å°† Web åº”ç”¨è¿è¡Œåœ¨éš”ç¦»çš„å®¹å™¨ä¸­"
            ],
            code_examples=[
                "# âŒ å±é™©ç¤ºä¾‹",
                "os.system(f\"ping {user_input}\")",
                "",
                "# âœ… å®‰å…¨ç¤ºä¾‹",
                "import subprocess",
                "if re.match(r'^[a-zA-Z0-9.]+$', user_input):",
                "    subprocess.run(['ping', user_input])"
            ],
            references=[
                "OWASP Command Injection",
                "CWE-78"
            ],
            verification="å°è¯•æ³¨å…¥å¸¸è§å‘½ä»¤æ‰§è¡Œ payload éªŒè¯"
        ),
        "broken_auth": Remediation(
            id="REM-AUTH-001",
            vulnerability_type="Broken Authentication",
            title="å¼ºåŒ–è®¤è¯å’Œä¼šè¯ç®¡ç†",
            priority="P1",
            effort="Medium",
            steps=[
                "å®æ–½å¼ºå¯†ç ç­–ç•¥ï¼ˆæœ€å°é•¿åº¦12ï¼ŒåŒ…å«å¤šç§å­—ç¬¦ç±»å‹ï¼‰",
                "ä½¿ç”¨ bcrypt æˆ– Argon2 å­˜å‚¨å¯†ç ",
                "å®æ–½å¤šå› ç´ è®¤è¯",
                "ä¼šè¯ ID ä½¿ç”¨å®‰å…¨çš„éšæœºæ•°ç”Ÿæˆå™¨",
                "è®¾ç½®åˆç†çš„ä¼šè¯è¶…æ—¶æ—¶é—´"
            ],
            code_examples=[
                "# å¯†ç å“ˆå¸Œç¤ºä¾‹",
                "import bcrypt",
                "",
                "password = request.form['password']",
                "hashed = bcrypt.hashpw(password.encode(), bcrypt.gensalt())",
                "",
                "# éªŒè¯å¯†ç ",
                "if bcrypt.checkpw(password.encode(), hashed):",
                "    # ç™»å½•æˆåŠŸ"
            ],
            references=[
                "OWASP Authentication Cheat Sheet",
                "CWE-307"
            ],
            verification="å®¡è®¡ç™»å½•æµç¨‹ï¼Œç¡®è®¤æ— è®¤è¯ç»•è¿‡æ¼æ´"
        )
    }
    
    @classmethod
    def get_remediation(cls, vulnerability_type: str) -> Remediation:
        """è·å–ä¿®å¤å»ºè®®"""
        return cls.REMEDIATIONS.get(vulnerability_type.lower())
    
    @classmethod
    def generate_prioritized_list(cls, findings: list[dict]) -> list[Remediation]:
        """ç”Ÿæˆä¼˜å…ˆçº§æ’åºçš„ä¿®å¤åˆ—è¡¨"""
        remediations = []
        
        for finding in findings:
            vuln_type = finding.get('type', '')
            remediation = cls.get_remediation(vuln_type)
            if remediation:
                remediations.append(remediation)
        
        # å»é‡
        seen = set()
        unique = []
        for r in remediations:
            if r.id not in seen:
                seen.add(r.id)
                unique.append(r)
        
        # æŒ‰ä¼˜å…ˆçº§æ’åº
        priority_order = {"P1": 0, "P2": 1, "P3": 2, "P4": 3}
        return sorted(unique, key=lambda x: priority_order.get(x.priority, 4))
```

---

## å®è·µä»»åŠ¡ï¼ˆåˆæ³•æˆæƒèŒƒå›´å†…ï¼‰

> **æ³¨æ„**ï¼šä»¥ä¸‹ä»»åŠ¡è¯·åœ¨ä½ è‡ªå·±çš„æµ‹è¯•ç¯å¢ƒã€è™šæ‹Ÿæœºæˆ–æˆæƒé¶åœºä¸­æ‰§è¡Œã€‚

---

### ä»»åŠ¡ 1ï¼ˆå¿…åšï¼‰ï¼šç”Ÿæˆæ¸—é€æµ‹è¯•æŠ¥å‘Š

**ç›®æ ‡**ï¼šå°†å‰æœŸæ‰«æå’Œåˆ©ç”¨çš„ç»“æœæ•´ç†æˆå®Œæ•´çš„æ¸—é€æµ‹è¯•æŠ¥å‘Šã€‚

**æ­¥éª¤**ï¼š

1. **æ”¶é›†æµ‹è¯•æ•°æ®**

```bash
# æ”¶é›† Nmap æ‰«æç»“æœ
nmap -sV -sC -oX nmap_results.xml 10.0.0.0/24

# æ”¶é›†æ¼æ´æ‰«æç»“æœ
nessus-cli -c policy.xml --target 10.0.0.0/24 -o nessus_results.csv

# æ”¶é›†æˆªå›¾å’Œè¯æ®
mkdir -p evidence/{screenshots,logs,pcap}
```

2. **ä½¿ç”¨ Python ç”ŸæˆæŠ¥å‘Š**

```python
#!/usr/bin/env python3
from datetime import datetime

# åˆ›å»ºæŠ¥å‘Šå¯¹è±¡
engagement = EngagementInfo(
    id="PEN-2024-001",
    client_name="ç¤ºä¾‹å…¬å¸",
    project_name="ç½‘ç»œå®‰å…¨æ¸—é€æµ‹è¯•",
    scope="10.0.0.0/24",
    start_date=datetime(2024, 1, 15),
    end_date=datetime(2024, 1, 20),
    tester_name="å®‰å…¨æµ‹è¯•å·¥ç¨‹å¸ˆ",
    tester_certification=["OSCP", "CISSP"]
)

report = PenetrationTestReport(engagement)

# æ·»åŠ å‘ç°
report.add_finding(Finding(
    id="VULN-001",
    title="MS17-010 è¿œç¨‹ä»£ç æ‰§è¡Œ",
    description="ç›®æ ‡æœåŠ¡å™¨å­˜åœ¨æ°¸æ’ä¹‹è“æ¼æ´...",
    severity="Critical",
    cvss_score=9.8,
    cvss_vector="CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
    affected_asset="10.0.0.10",
    affected_component="Windows SMB Service",
    remediation="å®‰è£…å®‰å…¨æ›´æ–° KB4012598",
    status="Open",
    discovered_date=datetime.now()
))

# ç”ŸæˆæŠ¥å‘Š
report.generate_executive_summary()
report.export_report("æ¸—é€æµ‹è¯•æŠ¥å‘Š.md", format="markdown")
```

---

### ä»»åŠ¡ 2ï¼ˆå¿…åšï¼‰ï¼šCVSS è¯„åˆ†ç»ƒä¹ 

**ç›®æ ‡**ï¼šä¸ºä¸åŒçš„æ¼æ´åœºæ™¯è®¡ç®— CVSS è¯„åˆ†ã€‚

**æ­¥éª¤**ï¼š

```python
#!/usr/bin/env python3

# åœºæ™¯1: SQL æ³¨å…¥å¯¼è‡´æ•°æ®æ³„éœ²
vector1 = CVSSVector(
    attack_vector=AttackVector.NETWORK,
    attack_complexity=AttackComplexity.LOW,
    privileges_required=PrivilegesRequired.NONE,
    user_interaction=UserInteraction.NONE,
    scope=Scope.UNCHANGED,
    confidentiality=ImpactLevel.HIGH,
    integrity=ImpactLevel.NONE,
    availability=ImpactLevel.NONE
)

score1 = CVSSCalculator.calculate_base_score(vector1)
severity1 = CVSSCalculator.get_severity(score1)
vector_str1 = CVSSCalculator.generate_vector_string(vector1)

print(f"åœºæ™¯1 - SQLæ³¨å…¥:")
print(f"  è¯„åˆ†: {score1}")
print(f"  ä¸¥é‡æ€§: {severity1}")
print(f"  å‘é‡: {vector_str1}")

# åœºæ™¯2: å­˜å‚¨å‹XSS
vector2 = CVSSVector(
    attack_vector=AttackVector.NETWORK,
    attack_complexity=AttackComplexity.LOW,
    privileges_required=PrivilegesRequired.NONE,
    user_interaction=UserInteraction.REQUIRED,
    scope=Scope.CHANGED,
    confidentiality=ImpactLevel.LOW,
    integrity=ImpactLevel.LOW,
    availability=ImpactLevel.NONE
)

score2 = CVSSCalculator.calculate_base_score(vector2)
severity2 = CVSSCalculator.get_severity(score2)

print(f"\nåœºæ™¯2 - å­˜å‚¨å‹XSS:")
print(f"  è¯„åˆ†: {score2}")
print(f"  ä¸¥é‡æ€§: {severity2}")

# åœºæ™¯3: æœ¬åœ°æ–‡ä»¶åŒ…å«
vector3 = CVSSVector(
    attack_vector=AttackVector.NETWORK,
    attack_complexity=AttackComplexity.HIGH,
    privileges_required=PrivilegesRequired.NONE,
    user_interaction=UserInteraction.NONE,
    scope=Scope.UNCHANGED,
    confidentiality=ImpactLevel.HIGH,
    integrity=ImpactLevel.LOW,
    availability=ImpactLevel.NONE
)

score3 = CVSSCalculator.calculate_base_score(vector3)
severity3 = CVSSCalculator.get_severity(score3)

print(f"\nåœºæ™¯3 - æœ¬åœ°æ–‡ä»¶åŒ…å«:")
print(f"  è¯„åˆ†: {score3}")
print(f"  ä¸¥é‡æ€§: {severity3}")
```

---

### ä»»åŠ¡ 3ï¼ˆå¿…å†™ï¼‰ï¼šç¼–å†™ä¿®å¤å»ºè®®

**ç›®æ ‡**ï¼šé’ˆå¯¹å‘ç°çš„æ¼æ´ç¼–å†™å¯æ“ä½œçš„ä¿®å¤å»ºè®®ã€‚

**æ­¥éª¤**ï¼š

```python
#!/usr/bin/env python3

# ä¸ºä¸åŒç±»å‹çš„æ¼æ´ç”Ÿæˆä¿®å¤å»ºè®®
vulnerabilities = [
    {"type": "sql_injection", "title": "SQLæ³¨å…¥æ¼æ´"},
    {"type": "xss", "title": "è·¨ç«™è„šæœ¬æ¼æ´"},
    {"type": "rce", "title": "è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´"},
    {"type": "broken_auth", "title": "è®¤è¯ç¼ºé™·æ¼æ´"}
]

for vuln in vulnerabilities:
    remediation = RemediationGenerator.get_remediation(vuln['type'])
    
    if remediation:
        print(f"\n{'='*60}")
        print(f"æ¼æ´: {vuln['title']}")
        print(f"ä¿®å¤å»ºè®®: {remediation.title}")
        print(f"ä¼˜å…ˆçº§: {remediation.priority}")
        print(f"å·¥ä½œé‡: {remediation.effort}")
        print(f"\nä¿®å¤æ­¥éª¤:")
        for i, step in enumerate(remediation.steps, 1):
            print(f"  {i}. {step}")
        
        print(f"\nä»£ç ç¤ºä¾‹:")
        for code in remediation.code_examples:
            print(f"  {code}")
```

---

## å·©å›ºç»ƒä¹ ï¼ˆé¢˜ä¸å¤ç›˜ï¼‰

---

### ç»ƒä¹  1ï¼šæŠ¥å‘Šé¢å‘ä¸åŒå—ä¼—

**é—®é¢˜**ï¼šå¦‚ä½•ä¸ºæŠ€æœ¯å›¢é˜Ÿå’Œç®¡ç†å±‚åˆ†åˆ«å‡†å¤‡æŠ¥å‘Šå†…å®¹ï¼Ÿ

**æ€è·¯æç¤º**ï¼š

| å—ä¼— | å…³æ³¨ç‚¹ | æŠ¥å‘Šé‡ç‚¹ | å‘ˆç°æ–¹å¼ |
|------|--------|----------|----------|
| **æŠ€æœ¯å›¢é˜Ÿ** | æ¼æ´ç»†èŠ‚ã€åˆ©ç”¨æ–¹æ³• | æŠ€æœ¯ç»†èŠ‚ã€ä¿®å¤ä»£ç  | è¯¦ç»†æŠ€æœ¯æŠ¥å‘Šã€é™„ä»¶ |
| **ç®¡ç†å±‚** | ä¸šåŠ¡å½±å“ã€æŠ•èµ„å›æŠ¥ | é£é™©ç­‰çº§ã€ä¿®å¤æˆæœ¬ | æ‰§è¡Œæ‘˜è¦ã€å›¾è¡¨ |
| **åˆè§„å›¢é˜Ÿ** | åˆè§„è¦æ±‚ã€æ ‡å‡†å¯¹ç…§ | ç¬¦åˆæ€§æ£€æŸ¥ | å¯¹ç…§è¡¨æ ¼ã€å·®è·åˆ†æ |
| **å¼€å‘å›¢é˜Ÿ** | ä¿®å¤æ–¹æ³•ã€æœ€ä½³å®è·µ | å®‰å…¨ç¼–ç è§„èŒƒ | ä»£ç ç¤ºä¾‹ã€æœ€ä½³å®è·µ |

---

### ç»ƒä¹  2ï¼šé£é™©æ²Ÿé€š

**é—®é¢˜**ï¼šå¦‚ä½•å‘éæŠ€æœ¯äººå‘˜è§£é‡Šå®‰å…¨é£é™©ï¼Ÿ

**ç¤ºä¾‹ç­”æ¡ˆ**ï¼š

```python
# æŠ€æœ¯é£é™©åˆ°ä¸šåŠ¡é£é™©çš„è½¬æ¢
RISK_EXPLANATIONS = {
    "SQLæ³¨å…¥": "æ”»å‡»è€…å¯ä»¥é€šè¿‡ç½‘é¡µè¡¨å•è®¿é—®æ•°æ®åº“ï¼Œçªƒå–å®¢æˆ·ä¿¡æ¯ï¼Œå¦‚è´¦æˆ·å¯†ç ã€ä¸ªäººèµ„æ–™ç­‰",
    "XSSæ”»å‡»": "æ”»å‡»è€…å¯ä»¥åœ¨ç½‘é¡µä¸­æ³¨å…¥æ¶æ„è„šæœ¬ï¼Œå½“ç”¨æˆ·è®¿é—®è¯¥é¡µé¢æ—¶ï¼Œçªƒå–ç”¨æˆ·çš„ç™»å½•ä¿¡æ¯æˆ–cookie",
    "å¼±å£ä»¤": "ä½¿ç”¨ç®€å•å¯†ç çš„æ”»å‡»è€…å¯ä»¥è½»æ¾ç™»å½•ç³»ç»Ÿï¼Œå°±åƒç”¨ä¸€æŠŠå®¹æ˜“å¤åˆ¶çš„é’¥åŒ™æ‰“å¼€é—¨é”",
    "è¿œç¨‹ä»£ç æ‰§è¡Œ": "æ”»å‡»è€…å¯ä»¥åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œç›¸å½“äºå®Œå…¨æ§åˆ¶äº†è¿™å°ç”µè„‘",
    "æœªæˆæƒè®¿é—®": "ä»»ä½•äººä¸éœ€è¦è´¦å·å¯†ç å°±èƒ½è®¿é—®æ•æ„Ÿæ•°æ®ï¼Œå°±åƒå›¾ä¹¦é¦†çš„ä¹¦å¯¹å¤–å®Œå…¨å¼€æ”¾"
}

# ä¸šåŠ¡å½±å“é‡åŒ–
BUSINESS_IMPACT_QUANTIFICATION = {
    "æ•°æ®æ³„éœ²": "å¯èƒ½é¢ä¸´GDPRç½šæ¬¾ï¼ˆæœ€é«˜4%å¹´æ”¶å…¥ï¼‰ã€å®¢æˆ·æµå¤±ã€å“ç‰Œå£°èª‰å—æŸ",
    "ç³»ç»Ÿè¢«é»‘": "ä¸šåŠ¡ä¸­æ–­æŸå¤±ã€å®¢æˆ·æŠ•è¯‰ã€æ³•å¾‹è¯‰è®¼ã€åˆè§„å¤„ç½š",
    "å‹’ç´¢è½¯ä»¶": "èµé‡‘æ”¯ä»˜ã€ä¸šåŠ¡æ¢å¤æˆæœ¬ã€é•¿æœŸä¿¡ä»»æŸå¤±"
}
```

---

### ç»ƒä¹  3ï¼šä¿®å¤å»ºè®®è¯„ä¼°

**é—®é¢˜**ï¼šå¦‚ä½•è¯„ä¼°ä¿®å¤å»ºè®®çš„å¯æ‰§è¡Œæ€§å’Œä¼˜å…ˆçº§ï¼Ÿ

**ç¤ºä¾‹ç­”æ¡ˆ**ï¼š

```python
# ä¿®å¤å»ºè®®è¯„ä¼°çŸ©é˜µ
REMEDIATION_ASSESSMENT = {
    "P1 - ç«‹å³ä¿®å¤": [
        "CVSS >= 9.0 çš„æ¼æ´",
        "å¯è¿œç¨‹åˆ©ç”¨çš„ RCE æ¼æ´",
        "æ­£åœ¨è¢«åˆ©ç”¨çš„æ¼æ´",
        "å½±å“æ ¸å¿ƒç³»ç»Ÿçš„æ¼æ´"
    ],
    "P2 - æœ¬å‘¨ä¿®å¤": [
        "CVSS 7.0-8.9 çš„æ¼æ´",
        "é«˜å½±å“çš„è®¤è¯æ¼æ´",
        "æ•æ„Ÿæ•°æ®æ³„éœ²é£é™©",
        "å¯åˆ©ç”¨çš„æ³¨å…¥æ¼æ´"
    ],
    "P3 - ä¸¤å‘¨ä¿®å¤": [
        "CVSS 4.0-6.9 çš„æ¼æ´",
        "ä¸­å½±å“çš„ä¿¡æ¯æ³„éœ²",
        "XSS æ¼æ´",
        "é…ç½®é—®é¢˜"
    ],
    "P4 - è®¡åˆ’ä¿®å¤": [
        "CVSS < 4.0 çš„æ¼æ´",
        "ä½å½±å“çš„æ³„éœ²",
        "ä»£ç è´¨é‡é—®é¢˜",
        "å»ºè®®çš„æœ€ä½³å®è·µ"
    ]
}

# ä¿®å¤å·¥ä½œé‡è¯„ä¼°
EFFORT_ESTIMATION = {
    "å° (1-2å¤©)": [
        "é…ç½®æ›´æ”¹",
        "è¾“å…¥éªŒè¯æ·»åŠ ",
        "å“åº”å¤´é…ç½®",
        "ç®€å•ä»£ç ä¿®å¤"
    ],
    "ä¸­ (1å‘¨)": [
        "æ¨¡å—é‡æ„",
        "è®¤è¯æµç¨‹æ”¹è¿›",
        "API å®‰å…¨åŠ å›º",
        "æ—¥å¿—ç³»ç»Ÿå‡çº§"
    ],
    "å¤§ (1ä¸ªæœˆ+)": [
        "æ¶æ„é‡æ„",
        "å®‰å…¨æ¡†æ¶å‡çº§",
        "åˆè§„æ€§æ”¹é€ ",
        "é—ç•™ç³»ç»Ÿæ›¿æ¢"
    ]
}
```

---

## è¯„ä¼°æ ‡å‡†ï¼ˆè¾¾æˆåˆ¤å®šï¼‰

- âœ… èƒ½ç†è§£å¹¶åº”ç”¨ CVSS 3.1 è¯„åˆ†ä½“ç³»
- âœ… èƒ½ç¼–å†™ç»“æ„æ¸…æ™°çš„æ¸—é€æµ‹è¯•æŠ¥å‘Š
- âœ… èƒ½å°†æŠ€æœ¯æ¼æ´è½¬åŒ–ä¸ºä¸šåŠ¡é£é™©æè¿°
- âœ… èƒ½ç»™å‡ºå¯æ“ä½œçš„ä¿®å¤å»ºè®®
- âœ… èƒ½é’ˆå¯¹ä¸åŒå—ä¼—è°ƒæ•´æŠ¥å‘Šå†…å®¹

---

## å­¦ä¹ æˆæœè¾¾æˆæƒ…å†µï¼ˆç”±å­¦ä¹ è€…å¡«å†™ï¼‰

### æˆªå›¾ä¸è¯æ®

- [ ] æ¸—é€æµ‹è¯•æŠ¥å‘Šæˆªå›¾
- [ ] CVSS è¯„åˆ†è®¡ç®—æˆªå›¾
- [ ] ä¿®å¤å»ºè®®æ–‡æ¡£æˆªå›¾
- [ ] å®¢æˆ·æ²Ÿé€šè®°å½•æˆªå›¾

### å…³é”®å‘½ä»¤ä¸è¾“å‡º

**CVSS è¯„åˆ†è®¡ç®—**ï¼š
```bash
$ python3 cvss_calculator.py
åœºæ™¯1 - SQLæ³¨å…¥:
  è¯„åˆ†: 9.8
  ä¸¥é‡æ€§: Critical
  å‘é‡: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N

åœºæ™¯2 - å­˜å‚¨å‹XSS:
  è¯„åˆ†: 6.1
  ä¸¥é‡æ€§: Medium
```

**æŠ¥å‘Šç”Ÿæˆ**ï¼š
```bash
$ python3 generate_report.py
[+] ç”Ÿæˆæ¸—é€æµ‹è¯•æŠ¥å‘Š: æ¸—é€æµ‹è¯•æŠ¥å‘Š.md
[+] æŠ¥å‘Šé¡µæ•°: 45
[+] å‘ç°æ¼æ´: 15ä¸ª
[+] Critical: 2, High: 5, Medium: 6, Low: 2
```

### ç»“è®ºä¸åæ€

**æˆ‘ä»Šå¤©ææ¸…æ¥šäº†**ï¼š

- æ¸—é€æµ‹è¯•æŠ¥å‘Šçš„æ ‡å‡†ç»“æ„å’Œå†…å®¹è¦æ±‚
- CVSS 3.1 è¯„åˆ†ä½“ç³»çš„è®¡ç®—æ–¹æ³•
- å¦‚ä½•å°†æŠ€æœ¯æ¼æ´è½¬åŒ–ä¸ºä¸šåŠ¡å½±å“
- ä¸åŒå—ä¼—å¯¹æŠ¥å‘Šå†…å®¹çš„éœ€æ±‚å·®å¼‚

**æˆ‘å·®ç‚¹ææ··çš„æ˜¯**ï¼š

- CVSS ä¸åŒç‰ˆæœ¬çš„è¯„åˆ†å·®å¼‚ï¼ˆ2.0 vs 3.0 vs 3.1ï¼‰
- Scope å˜åŒ–å¯¹è¯„åˆ†çš„å½±å“
- æŠ€æœ¯ä¸¥é‡æ€§å’Œä¸šåŠ¡å½±å“çš„å…³ç³»

**æ˜å¤©æˆ‘è¦ç»§ç»­è¡¥çš„æ˜¯**ï¼š

- æƒé™æå‡æŠ€æœ¯
- å†…ç½‘æ¨ªå‘ç§»åŠ¨
- æŒä¹…åŒ–æŠ€æœ¯

**æœ¬æ¬¡å­¦ä¹ è€—æ—¶**ï¼šçº¦ 4 å°æ—¶

**æŒæ¡ç¨‹åº¦è‡ªè¯„**ï¼š

- [ ] ğŸ˜• ç†è§£äº†åŸºæœ¬æ¦‚å¿µï¼Œä½†å®è·µä¸ç†Ÿç»ƒ
- [ ] ğŸ™‚ å®Œæˆäº†åŸºç¡€ä»»åŠ¡
- [ ] ğŸ˜ƒ å®Œæˆäº†æ‰€æœ‰ä»»åŠ¡å¹¶ç†è§£åŸç†
- [ ] ğŸ¤© é¢å¤–å¼€å‘äº†å®Œæ•´çš„æŠ¥å‘Šç”Ÿæˆç³»ç»Ÿ


## å­¦ä¹ æˆæœç¤ºä¾‹å¡«å†™ï¼ˆå¯ç…§æŠ„ï¼‰

> å¯å°†"ç¤ºä¾‹"å†…å®¹æ›¿æ¢ä¸ºä½ è‡ªå·±çš„æ—¶é—´ä¸æˆªå›¾æ–‡ä»¶åã€‚

### æˆªå›¾ä¸è¯æ®ï¼ˆç¤ºä¾‹ï¼‰

- ä»»åŠ¡ 1ï¼š`images/dayXXX_task1.png`

### å…³é”®å‘½ä»¤ä¸è¾“å‡ºï¼ˆç¤ºä¾‹ï¼‰

```
å‘½ä»¤ç¤ºä¾‹ï¼š
è¾“å‡ºç¤ºä¾‹ï¼š
```

### ç»“è®ºä¸åæ€ï¼ˆç¤ºä¾‹ï¼‰

**æˆ‘ä»Šå¤©ææ¸…æ¥šäº†**ï¼š
- ï¼ˆç¤ºä¾‹ï¼‰ç†è§£äº†æ ¸å¿ƒæ¦‚å¿µ

**æˆ‘å·®ç‚¹ææ··çš„æ˜¯**ï¼š
- ï¼ˆç¤ºä¾‹ï¼‰æŸä¸ªæ˜“æ··æ·†ç‚¹

**æ˜å¤©æˆ‘è¦ç»§ç»­è¡¥çš„æ˜¯**ï¼š
- ï¼ˆç¤ºä¾‹ï¼‰ä¸‹ä¸€æ­¥æ·±å…¥æ–¹å‘

**æœ¬æ¬¡å­¦ä¹ è€—æ—¶**ï¼šçº¦ 2 å°æ—¶

**æŒæ¡ç¨‹åº¦è‡ªè¯„**ï¼š
- [x] ğŸ˜ƒ å®Œæˆäº†æ‰€æœ‰ä»»åŠ¡å¹¶ç†è§£åŸç†
