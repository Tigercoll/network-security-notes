---
title: Day027：漏洞扫描与基线 - 常见 Web 漏洞 (2) 越权、上传与弱口令
tags:
  - 网络
  - 安全
  - 学习计划
categories:
  - 网络安全
abbrlink: b2c3d
date: 2026-02-18
updated: 2026-02-18
---

# Day027：漏洞扫描与基线 - 常见 Web 漏洞 (2) 越权、上传与弱口令

- **日期**：2026-02-18
- **周次**：第 4 周
- **模块**：漏洞扫描与基线
- **主题**：常见 Web 漏洞 (2) 越权、上传与弱口令
- **预计学习时间**：3 小时

---

## 🎯 学习目标

学完今天你应该能做到：

- **打破边界**：理解垂直越权（低变高）和水平越权（我看你数据）的区别与测试方法。
- **突破防线**：理解文件上传漏洞原理，能上传 WebShell 并连接。
- **暴力破解**：使用 Burp Intruder 进行账号密码爆破。

<!--more-->

---

## 📚 完整学习内容（必读）

本节包含今天需要学习的全部知识点，请认真阅读并理解。

### 一、概念理解

#### 1.1.1 什么是逻辑漏洞？(Logic Flaws)
如果说 SQL 注入是“技术漏洞”，那越权和弱口令就是“逻辑漏洞”。
扫描器（如 Nessus）很难发现逻辑漏洞，因为从技术上讲，它们是“合法”的操作，只是不符合业务逻辑（比如：普通用户本该只能看自己的订单，结果他看了别人的）。

#### 1.1.2 越权访问 (Broken Access Control)
- **水平越权 (IDOR)**：同级用户互相攻击。
  - **场景**：我是用户 A，我把 URL 里的 `id=100` 改成 `id=101`，看到了用户 B 的数据。
- **垂直越权**：低级用户攻击高级用户。
  - **场景**：我是普通用户，我尝试访问 `/admin.php`，或者修改 Cookie 里的 `role=user` 为 `role=admin`，成功进入后台。

#### 1.1.3 文件上传 (File Upload)
Web 应用允许用户上传图片（头像）。如果后端没检查文件类型，黑客上传了一个 `.php` 文件（木马）。当黑客访问这个文件时，服务器会执行其中的代码。这就是 **GetShell**（获取服务器控制权）。

### 二、原理讲解

#### 1.2.1 暴力破解 (Brute Force) 原理
- **弱口令**：`admin/123456`, `root/root`。这是互联网上最常见的漏洞。
- **字典**：黑客手里有几千万个常用密码列表（Top 10000）。
- **过程**：使用工具（Burp Intruder）不断尝试登录，直到成功。

#### 1.2.2 WebShell 原理
WebShell 就是一个网页版的后门。
PHP 一句话木马：
```php
<?php @eval($_POST['cmd']); ?>
```
黑客用客户端（蚁剑、菜刀）连接这个文件，发送 `cmd=system('whoami')`，服务器就会执行 `whoami` 并返回结果。

### 三、技术细节

#### 1.3.1 Burp Intruder 四种模式
1.  **Sniper (狙击手)**：一个位置，一个字典（如只爆破密码）。最常用。
2.  **Battering Ram (攻城锤)**：两个位置，用同一个字典（如用户名密码相同）。
3.  **Pitchfork (音叉)**：两个位置，两个字典，一一对应（user1 对应 pass1）。
4.  **Cluster Bomb (集束炸弹)**：两个位置，两个字典，笛卡尔积（user1 试完所有 pass，再试 user2）。最慢但最全。

#### 1.3.2 WebShell 管理工具
上传了木马后，怎么用？
-   **中国菜刀 (Chopper)**：经典老牌，一句话木马连接。
-   **蚁剑 (AntSword)**：开源、跨平台，功能强大（推荐）。
-   **冰蝎 (Behinder)**：流量加密，能绕过 WAF。
-   **哥斯拉 (Godzilla)**：基于 Java，更难被查杀。

### 四、进阶知识（选学）

#### 1.4.1 上传绕过技巧
如果服务器禁止上传 `.php` 怎么办？
1.  **大小写绕过**：`shell.PhP`（Windows 服务器）。
2.  **双后缀**：`shell.php.jpg`（Apache 解析漏洞）。
3.  **截断**：`shell.php%00.jpg`（低版本 PHP）。
4.  **MIME 类型欺骗**：抓包修改 `Content-Type: image/jpeg`。

### 五、本日知识点速查表

| 序号 | 核心概念 | 关键点 | 备注 |
|------|----------|--------|------|
| 1 | **IDOR** | 改ID看别人 | 最常见的越权 |
| 2 | **WebShell** | 网页后门 | 拿下服务器权限 |
| 3 | **Brute Force** | 大力出奇迹 | 猜密码 |
| 4 | **MIME** | Content-Type | 上传绕过技巧 |
| 5 | **AntSword** | 蚁剑 | 连马工具 |

---

## 🗺️ 知识图谱

### 今日内容在整体知识体系中的位置

```
网络安全学习路径
├── 第 4 周：漏洞扫描与基线
│   ├── Day026：代码漏洞 (SQLi, XSS)
│   └── Day027：逻辑漏洞 (Logic Flaws)
│       ├── 身份认证失效 (弱口令)
│       ├── 访问控制失效 (越权)
│       └── 危险功能滥用 (上传)
└── 后续衔接
    └── Day028：周综合实验 (DVWA 全通关)
```

### 今日关键词

`IDOR` · `Intruder` · `WebShell` · `MIME Type`

---

## 🔧 实践任务（合法授权范围内）

> ⚠️ **安全提示**：请使用 DVWA 靶场进行测试。

请按顺序完成以下任务：

### 任务 1：DVWA 靶场 - 暴力破解（30 分钟）

**操作步骤**：
1. 进入 **Brute Force** 模块。
2. 随便输账号密码，抓包发送到 **Intruder**。
3. 选中密码字段，点击 **Add §**。
4. 在 **Payloads** 标签加载一个弱口令字典（DVWA 自带或网上下载）。
5. 点击 **Start Attack**。
6. **观察**：看 Response Length（响应长度）。长度不一样的那个通常就是正确密码。

**预期结果**：成功爆破出密码（通常是 `password`）。

### 任务 2：DVWA 靶场 - 文件上传（30 分钟）

**操作步骤**：
1. 进入 **File Upload** 模块 (Security: Low)。
2. 制作一个 `test.php`，内容：`<?php phpinfo(); ?>`。
3. 上传文件。提示上传成功路径 `../../hackable/uploads/test.php`。
4. 浏览器访问该路径（注意路径拼接）。
5. **观察**：如果看到 PHP 配置页面，说明 GetShell 成功。

**预期结果**：成功看到 phpinfo 页面。

### 任务 3：DVWA 靶场 - 越权 (Insecure CAPTCHA)（20 分钟）

**操作步骤**：
1. 进入 **Insecure CAPTCHA** 模块。
2. 这是一个修改密码的页面，需要验证码。
3. 抓包。观察参数里有一个 `step=1`。
4. 把 `step=1` 改成 `step=2`，并删除验证码参数。
5. 发送包。
6. **观察**：是否绕过了验证码检查修改了密码？（这是逻辑漏洞的一种）。

**预期结果**：成功绕过验证码修改密码。

---

## 📝 巩固练习（题目与复盘）

### 练习 1：概念理解（5 分钟）

**题目**：为什么只在前端检查文件后缀名是不安全的？

**参考答案**：因为前端代码运行在用户浏览器里，黑客可以禁用 JS，或者直接用 Burp 抓包修改文件名，轻松绕过前端检查。**所有安全检查必须在后端（服务器）再做一次。**

### 练习 2：实操复盘（5 分钟）

**题目**：我在 Intruder 爆破时，发现所有请求的状态码都是 200，怎么判断哪个成功了？

**参考答案**：看**响应长度 (Length)** 或者 **响应内容**。登录失败通常会返回 "Login failed"，登录成功可能没有这句话，或者会跳转（302）。

---

## ✅ 评估标准（达成判定）

- [ ] 我能解释水平越权和垂直越权的区别。
- [ ] 我知道 WebShell 是什么。
- [ ] 我会用 Burp Intruder 爆破密码。

### 自检清单

- [ ] **概念理解**：能描述 IDOR 漏洞的产生原因。
- [ ] **实际应用**：能用 Intruder 的 Sniper 模式进行爆破。
- [ ] **安全意识**：知道为什么不能用弱口令。

### 学习进度自评

| 评估项目 | 1-5 星 | 备注 |
|----------|--------|------|
| 越权理解 | ⭐⭐⭐⭐⭐ | |
| 上传原理 | ⭐⭐⭐⭐⭐ | |
| 爆破技能 | ⭐⭐⭐⭐⭐ | |

---

## 📊 学习成果记录（由学习者填写）

### 学习信息

| 项目 | 内容 |
|------|------|
| 学习日期 | 2026-02-18 |
| 学习时长 | ___ 小时 |
| 完成情况 | ⬜ 已完成 / ⬜ 部分完成 / ⬜ 未完成 |

### 实践任务完成记录

| 任务 | 完成状态 | 关键证据/截图 |
|------|----------|---------------|
| 任务 1 | ⬜ 已完成 | 截图：Intruder 爆破成功记录 |
| 任务 2 | ⬜ 已完成 | 截图：phpinfo 页面 |
| 任务 3 | ⬜ 已完成 | 截图：越权修改成功提示 |

---

## 💡 知识卡片速查

### 常见弱口令 Top 5

1.  `123456`
2.  `password`
3.  `12345678`
4.  `qwerty`
5.  `12345`

### Burp Intruder 模式

| 模式 | 适用场景 |
|------|----------|
| **Sniper** | 爆破单个参数（如密码） |
| **Cluster Bomb** | 爆破多个参数组合（如用户名+密码） |

---

## ❓ 常见问题与解答

**Q1：上传漏洞怎么防御？**
A1：
1.  **白名单检查**：只允许上传 `.jpg`, `.png`（在后端检查）。
2.  **重命名**：上传后服务器自动改名为 `随机字符串.jpg`，不给黑客猜路径的机会。
3.  **目录权限**：上传目录（uploads）禁止执行脚本权限（No Exec）。

**Q2：越权漏洞怎么扫描？**
A2：很难自动扫描。通常需要人工测试，或者使用 Burp 插件（如 AuthMatrix）配置两个不同账号的 Session 进行对比测试。

---

## 🚀 下一步学习预告

**明日主题预告**：Day028 - 漏洞扫描与基线 - 周综合实验与测评

**学习重点预告**：
- 串联本周所有知识。
- 完整的 DVWA 攻防演练。
- 查漏补缺。

**今日学习为明日做铺垫**：
- 明天我们将把这几天学的 Nmap, Burp, SQLi, XSS, Upload 全部用上，进行一次“大考”。

---

> 💬 **学习提示**：
> 1. 越权漏洞是现在企业最头疼的，因为容易被忽视。
> 2. 文件上传是拿权限最快的，但也是防御最严的。
> 3. **再次强调**：在自己搭建的靶场里怎么玩都行，千万别去公网乱试！

```bash
git add daily/Day027.md
git commit -m "Day027: 完成学习与记录"
```
