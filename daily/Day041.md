---
title: Day041ï¼šWeb å®‰å…¨ - é”™è¯¯å¤„ç†ã€æ—¥å¿—ä¸ WAF è¾¹ç•Œ
tags:
  - ç½‘ç»œ
  - å®‰å…¨
  - å­¦ä¹ è®¡åˆ’
categories:
  - ç½‘ç»œå®‰å…¨
abbrlink: 42e0c097
date: 2026-02-03 00:00:00
updated: 2026-02-03 00:00:00
---

# Day041ï¼šWeb å®‰å…¨ - é”™è¯¯å¤„ç†ã€æ—¥å¿—ä¸ WAF è¾¹ç•Œ

- æ—¥æœŸï¼š2026-02-03
- å‘¨æ¬¡ï¼šç¬¬6å‘¨

## å­¦ä¹ ç›®æ ‡

ä»Šå¤©ä½ å°†æŒæ¡é”™è¯¯å¤„ç†ã€å®‰å…¨æ—¥å¿—ä¸ WAF çš„æ ¸å¿ƒçŸ¥è¯†ï¼š

- **ç†è§£é”™è¯¯ä¿¡æ¯æš´éœ²çš„é£é™©**ï¼šé˜²æ­¢æ•æ„Ÿä¿¡æ¯æ³„éœ²
- **æŒæ¡ç»Ÿä¸€é”™è¯¯å¤„ç†**ï¼šè§„èŒƒåŒ–é”™è¯¯å“åº”æ ¼å¼
- **å®ç°å®‰å…¨æ—¥å¿—è®°å½•**ï¼šè®°å½•å…³é”®å®‰å…¨äº‹ä»¶
- **è®¤è¯† WAF çš„ä½œç”¨ä¸è¾¹ç•Œ**ï¼šç†è§£ WAF çš„èƒ½åŠ›ä¸å±€é™

---

<!--more-->

## å­¦ä¹ å†…å®¹

### 1ï¸âƒ£ é”™è¯¯å¤„ç†å®‰å…¨

#### 1.1 é”™è¯¯ä¿¡æ¯æ³„éœ²é£é™©

```python
# âŒ å±é™©ç¤ºä¾‹ï¼šå‘ç”¨æˆ·æš´éœ²è¯¦ç»†å †æ ˆ
@app.errorhandler(Exception)
def handle_exception(e):
    return jsonify({
        'error': str(e),
        'traceback': traceback.format_exc(),
        'sql_query': e.orig.args[0] if hasattr(e, 'orig') else None
    }), 500

# æ”»å‡»è€…é€šè¿‡é”™è¯¯ä¿¡æ¯è·å–ï¼š
# - æ•°æ®åº“ç»“æ„ï¼ˆè¡¨åã€å­—æ®µåï¼‰
# - æ–‡ä»¶è·¯å¾„ä¿¡æ¯
# - ç¬¬ä¸‰æ–¹æœåŠ¡é…ç½®
# - ä¸šåŠ¡é€»è¾‘æ¼æ´çº¿ç´¢
```

#### 1.2 å®‰å…¨é”™è¯¯å¤„ç†å®ç°

```python
#!/usr/bin/env python3
"""
å®‰å…¨çš„é”™è¯¯å¤„ç†ä¸æ—¥å¿—è®°å½•
"""
from __future__ import annotations
import logging
import traceback
import sys
from typing import Optional, Any
from dataclasses import dataclass, field
from datetime import datetime, timezone
from enum import Enum
import json
import secrets


class ErrorSeverity(Enum):
    """é”™è¯¯ä¸¥é‡ç­‰çº§"""
    LOW = "low"
    MEDIUM = "medium"
    HIGH = "high"
    CRITICAL = "critical"


@dataclass
class APIError:
    """æ ‡å‡†åŒ–é”™è¯¯å“åº”"""
    code: str              # é”™è¯¯ç 
    message: str           # ç”¨æˆ·å‹å¥½æ¶ˆæ¯
    severity: ErrorSeverity = ErrorSeverity.MEDIUM
    details: Optional[dict] = None  # è°ƒè¯•ä¿¡æ¯ï¼ˆä»…å†…éƒ¨ï¼‰
    request_id: Optional[str] = None
    timestamp: str = field(default_factory=lambda: datetime.now(timezone.utc).isoformat())


class SecureErrorHandler:
    """å®‰å…¨é”™è¯¯å¤„ç†å™¨"""
    
    # é”™è¯¯ç æ˜ å°„ - å‘ç”¨æˆ·éšè—å®ç°ç»†èŠ‚
    ERROR_MAPPING = {
        'validation_error': APIError(
            code='VALIDATION_ERROR',
            message='è¯·æ±‚å‚æ•°ä¸åˆæ³•ï¼Œè¯·æ£€æŸ¥è¾“å…¥',
            severity=ErrorSeverity.LOW
        ),
        'authentication_required': APIError(
            code='AUTH_REQUIRED',
            message='è¯·å…ˆç™»å½•',
            severity=ErrorSeverity.LOW
        ),
        'invalid_token': APIError(
            code='AUTH_INVALID_TOKEN',
            message='è®¤è¯å¤±è´¥ï¼Œè¯·é‡æ–°ç™»å½•',
            severity=ErrorSeverity.MEDIUM
        ),
        'insufficient_permissions': APIError(
            code='FORBIDDEN',
            message='æƒé™ä¸è¶³ï¼Œæ— æ³•è®¿é—®æ­¤èµ„æº',
            severity=ErrorSeverity.MEDIUM
        ),
        'resource_not_found': APIError(
            code='NOT_FOUND',
            message='è¯·æ±‚çš„èµ„æºä¸å­˜åœ¨',
            severity=ErrorSeverity.LOW
        ),
        'database_error': APIError(
            code='INTERNAL_ERROR',
            message='æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ï¼Œè¯·ç¨åé‡è¯•',
            severity=ErrorSeverity.HIGH
        ),
        'rate_limit_exceeded': APIError(
            code='RATE_LIMIT_EXCEEDED',
            message='è¯·æ±‚è¿‡äºé¢‘ç¹ï¼Œè¯·ç¨åé‡è¯•',
            severity=ErrorSeverity.LOW
        ),
    }
    
    def __init__(self, logger: logging.Logger):
        self.logger = logger
        self.request_id = None
    
    def set_request_id(self, request_id: str):
        """è®¾ç½®è¯·æ±‚ ID ç”¨äºè¿½è¸ª"""
        self.request_id = request_id
    
    def handle_exception(self, exception: Exception, include_details: bool = False) -> tuple[dict, int]:
        """å®‰å…¨åœ°å¤„ç†å¼‚å¸¸
        
        Args:
            exception: åŸå§‹å¼‚å¸¸
            include_details: æ˜¯å¦åŒ…å«è¯¦ç»†é”™è¯¯ï¼ˆä»…å¼€å‘ç¯å¢ƒï¼‰
            
        Returns:
            (é”™è¯¯å“åº”, HTTP çŠ¶æ€ç )
        """
        # 1. è®°å½•è¯¦ç»†é”™è¯¯æ—¥å¿—ï¼ˆå†…éƒ¨ï¼‰
        error_details = self._log_exception(exception)
        
        # 2. åˆ†ç±»é”™è¯¯
        error_type = self._classify_error(exception)
        
        # 3. ç”Ÿæˆç”¨æˆ·å‹å¥½çš„é”™è¯¯å“åº”
        error_info = self.ERROR_MAPPING.get(error_type, self.ERROR_MAPPING['database_error'])
        
        # 4. æ„å»ºå“åº”
        response = {
            'error': {
                'code': error_info.code,
                'message': error_info.message,
                'request_id': self.request_id,
                'timestamp': error_info.timestamp,
            }
        }
        
        # å¼€å‘ç¯å¢ƒæ·»åŠ è°ƒè¯•ä¿¡æ¯
        if include_details and error_info.severity in [ErrorSeverity.HIGH, ErrorSeverity.CRITICAL]:
            response['error']['details'] = {
                'error_type': error_type,
                'internal_message': error_details.get('message'),
            }
        
        # 5. ç¡®å®š HTTP çŠ¶æ€ç 
        status_code = self._get_status_code(error_type, exception)
        
        return response, status_code
    
    def _log_exception(self, exception: Exception) -> dict:
        """è®°å½•å¼‚å¸¸è¯¦ç»†ä¿¡æ¯"""
        error_id = secrets.token_urlsafe(8)
        
        error_details = {
            'error_id': error_id,
            'error_type': type(exception).__name__,
            'message': str(exception),
            'request_id': self.request_id,
        }
        
        # æ·»åŠ å †æ ˆä¿¡æ¯
        if sys.exc_info()[0]:
            error_details['stack_trace'] = traceback.format_exc()
        
        # æ ¹æ®å¼‚å¸¸ç±»å‹è®¾ç½®æ—¥å¿—çº§åˆ«
        if isinstance(exception, (ValueError, TypeError)):
            self.logger.warning(f"Error {error_id}: {exception}", extra=error_details)
        elif isinstance(exception, PermissionError):
            self.logger.error(f"Permission denied {error_id}: {exception}", extra=error_details)
        elif isinstance(exception, Exception):
            self.logger.error(f"Unhandled exception {error_id}: {exception}", extra=error_details)
        
        return error_details
    
    def _classify_error(self, exception: Exception) -> str:
        """åˆ†ç±»é”™è¯¯ç±»å‹"""
        exception_type = type(exception).__name__
        
        if isinstance(exception, (ValueError, TypeError)):
            return 'validation_error'
        elif isinstance(exception, PermissionError):
            return 'insufficient_permissions'
        elif isinstance(exception, FileNotFoundError):
            return 'resource_not_found'
        elif 'rate limit' in str(exception).lower():
            return 'rate_limit_exceeded'
        elif 'authentication' in str(exception).lower() or 'token' in str(exception).lower():
            return 'invalid_token'
        elif isinstance(exception, (ConnectionError, TimeoutError)):
            return 'database_error'
        else:
            return 'database_error'
    
    def _get_status_code(self, error_type: str, exception: Exception) -> int:
        """ç¡®å®š HTTP çŠ¶æ€ç """
        status_map = {
            'validation_error': 400,
            'authentication_required': 401,
            'invalid_token': 401,
            'insufficient_permissions': 403,
            'resource_not_found': 404,
            'rate_limit_exceeded': 429,
            'database_error': 500,
        }
        return status_map.get(error_type, 500)


# Flask é›†æˆç¤ºä¾‹
from flask import Flask, request, jsonify, g
from functools import wraps

app = Flask(__name__)

# é…ç½®æ—¥å¿—
logging.basicConfig(level=logging.INFO)
logger = logging.getLogger(__name__)

error_handler = SecureErrorHandler(logger)


@app.before_request
def before_request():
    """ä¸ºæ¯ä¸ªè¯·æ±‚ç”Ÿæˆå”¯ä¸€ ID"""
    g.request_id = secrets.token_urlsafe(8)
    g.start_time = datetime.now(timezone.utc)
    error_handler.set_request_id(g.request_id)


@app.after_request
def after_request(response):
    """æ·»åŠ å“åº”å¤´"""
    response.headers['X-Request-ID'] = g.get('request_id', 'unknown')
    return response


@app.errorhandler(Exception)
def handle_exception(e):
    """å…¨å±€å¼‚å¸¸å¤„ç†"""
    include_details = app.debug  # å¼€å‘ç¯å¢ƒæ˜¾ç¤ºè¯¦æƒ…
    error_response, status_code = error_handler.handle_exception(e, include_details)
    return jsonify(error_response), status_code


# ä½¿ç”¨ç¤ºä¾‹
@app.route('/api/users/<user_id>')
def get_user(user_id):
    try:
        user = database.get_user(user_id)
        if not user:
            raise FileNotFoundError(f"User {user_id} not found")
        return jsonify(user)
    except FileNotFoundError:
        raise
    except Exception as e:
        logger.error(f"Error fetching user {user_id}: {e}")
        raise
```

---

### 2ï¸âƒ£ å®‰å…¨æ—¥å¿—è®°å½•

#### 2.1 å®‰å…¨äº‹ä»¶åˆ†ç±»

```python
from __future__ import annotations
from dataclasses import dataclass, field
from datetime import datetime
from enum import Enum
from typing import Optional, Dict, Any


class SecurityEventType(Enum):
    """å®‰å…¨äº‹ä»¶ç±»å‹"""
    # è®¤è¯äº‹ä»¶
    LOGIN_SUCCESS = "login_success"
    LOGIN_FAILED = "login_failed"
    LOGOUT = "logout"
    PASSWORD_CHANGED = "password_changed"
    MFA_ENABLED = "mfa_enabled"
    MFA_DISABLED = "mfa_disabled"
    SESSION_EXPIRED = "session_expired"
    
    # æˆæƒäº‹ä»¶
    ACCESS_DENIED = "access_denied"
    PRIVILEGE_ESCALATION = "privilege_escalation"
    
    # æ•°æ®äº‹ä»¶
    DATA_EXPORT = "data_export"
    DATA_DELETE = "data_delete"
    SENSITIVE_DATA_ACCESS = "sensitive_data_access"
    
    # æ”»å‡»äº‹ä»¶
    BRUTE_FORCE_ATTEMPT = "brute_force_attempt"
    SQL_INJECTION_ATTEMPT = "sql_injection_attempt"
    XSS_ATTEMPT = "xss_attempt"
    RATE_LIMIT_VIOLATION = "rate_limit_violation"
    
    # ç³»ç»Ÿäº‹ä»¶
    CONFIG_CHANGED = "config_changed"
    API_KEY_CREATED = "api_key_created"
    API_KEY_REVOKED = "api_key_revoked"


@dataclass
class SecurityEvent:
    """å®‰å…¨äº‹ä»¶è®°å½•"""
    event_type: SecurityEventType
    timestamp: datetime = field(default_factory=lambda: datetime.now(timezone.utc))
    user_id: Optional[str] = None
    ip_address: Optional[str] = None
    user_agent: Optional[str] = None
    resource: Optional[str] = None
    action: Optional[str] = None
    result: str = "success"  # success, failure, blocked
    details: Optional[Dict[str, Any]] = None
    request_id: Optional[str] = None


class SecurityLogger:
    """å®‰å…¨äº‹ä»¶æ—¥å¿—è®°å½•å™¨"""
    
    def __init__(self, logger: logging.Logger):
        self.logger = logger
    
    def log_event(self, event: SecurityEvent):
        """è®°å½•å®‰å…¨äº‹ä»¶"""
        log_entry = {
            'event_type': event.event_type.value,
            'timestamp': event.timestamp.isoformat(),
            'user_id': event.user_id,
            'ip_address': event.ip_address,
            'user_agent': event.user_agent,
            'resource': event.resource,
            'action': event.action,
            'result': event.result,
            'details': event.details,
            'request_id': event.request_id,
        }
        
        # æ ¹æ®äº‹ä»¶ç±»å‹é€‰æ‹©æ—¥å¿—çº§åˆ«
        if event.event_type in [
            SecurityEventType.BRUTE_FORCE_ATTEMPT,
            SecurityEventType.SQL_INJECTION_ATTEMPT,
            SecurityEventType.PRIVILEGE_ESCALATION,
        ]:
            self.logger.warning(f"Security event: {event.event_type.value}", extra=log_entry)
        elif event.event_type in [
            SecurityEventType.LOGIN_FAILED,
            SecurityEventType.ACCESS_DENIED,
            SecurityEventType.RATE_LIMIT_VIOLATION,
        ]:
            self.logger.info(f"Security event: {event.event_type.value}", extra=log_entry)
        else:
            self.logger.info(f"Security event: {event.event_type.value}", extra=log_entry)
    
    def log_login_attempt(
        self,
        username: str,
        ip_address: str,
        user_agent: str,
        success: bool,
        request_id: str,
        failure_reason: Optional[str] = None
    ):
        """è®°å½•ç™»å½•å°è¯•"""
        event = SecurityEvent(
            event_type=SecurityEventType.LOGIN_SUCCESS if success else SecurityEventType.LOGIN_FAILED,
            user_id=username,
            ip_address=ip_address,
            user_agent=user_agent,
            result="success" if success else "failure",
            details={'reason': failure_reason} if failure_reason else None,
            request_id=request_id,
        )
        self.log_event(event)
    
    def log_access_denied(
        self,
        user_id: str,
        ip_address: str,
        resource: str,
        action: str,
        request_id: str
    ):
        """è®°å½•è®¿é—®æ‹’ç»"""
        event = SecurityEvent(
            event_type=SecurityEventType.ACCESS_DENIED,
            user_id=user_id,
            ip_address=ip_address,
            resource=resource,
            action=action,
            result="blocked",
            request_id=request_id,
        )
        self.log_event(event)
    
    def log_sensitive_access(
        self,
        user_id: str,
        ip_address: str,
        resource: str,
        data_type: str,
        request_id: str
    ):
        """è®°å½•æ•æ„Ÿæ•°æ®è®¿é—®"""
        event = SecurityEvent(
            event_type=SecurityEventType.SENSITIVE_DATA_ACCESS,
            user_id=user_id,
            ip_address=ip_address,
            resource=resource,
            action="read",
            details={'data_type': data_type},
            request_id=request_id,
        )
        self.log_event(event)


# Flask ä¸­é—´ä»¶é›†æˆ
from flask import Flask, request, g

app = Flask(__name__)
security_logger = SecurityLogger(logger)


@app.before_request
def setup_logging_context():
    """å‡†å¤‡æ—¥å¿—ä¸Šä¸‹æ–‡"""
    g.security_event = []


@app.after_request
def log_security_events(response):
    """è®°å½•å®‰å…¨äº‹ä»¶"""
    # è®°å½•è®¿é—®æ—¥å¿—
    security_logger.log_event(SecurityEvent(
        event_type=SecurityEventType.SENSITIVE_DATA_ACCESS if '/api/' in request.path else SecurityEventType.LOGIN_SUCCESS,
        user_id=getattr(g, 'current_user_id', None),
        ip_address=request.remote_addr,
        user_agent=request.headers.get('User-Agent'),
        resource=request.path,
        action=request.method,
        result="success" if response.status_code < 400 else "failure",
        request_id=getattr(g, 'request_id', None),
    ))
    
    return response
```

#### 2.2 æ—¥å¿—å­—æ®µè§„èŒƒ

```python
# æ—¥å¿—å­—æ®µæ ‡å‡†å®šä¹‰
LOG_FIELDS = {
    # åŸºç¡€å­—æ®µï¼ˆå¿…éœ€ï¼‰
    'timestamp': 'ISO 8601 æ ¼å¼æ—¶é—´æˆ³',
    'event_type': 'äº‹ä»¶ç±»å‹æšä¸¾å€¼',
    'severity': 'æ—¥å¿—çº§åˆ«ï¼ˆINFO/WARNING/ERRORï¼‰',
    
    # è¯·æ±‚ä¸Šä¸‹æ–‡
    'request_id': 'å”¯ä¸€è¯·æ±‚ ID',
    'user_id': 'ç”¨æˆ· IDï¼ˆå¦‚æœå·²è®¤è¯ï¼‰',
    'session_id': 'ä¼šè¯ ID',
    'ip_address': 'å®¢æˆ·ç«¯ IP åœ°å€',
    'user_agent': 'å®¢æˆ·ç«¯ User-Agent',
    'method': 'HTTP æ–¹æ³•',
    'path': 'è¯·æ±‚è·¯å¾„',
    'query_params': 'æŸ¥è¯¢å‚æ•°ï¼ˆè„±æ•ï¼‰',
    
    # å“åº”ä¿¡æ¯
    'status_code': 'HTTP çŠ¶æ€ç ',
    'response_time_ms': 'å“åº”æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰',
    
    # å®‰å…¨ç›¸å…³
    'auth_type': 'è®¤è¯ç±»å‹',
    'auth_result': 'è®¤è¯ç»“æœ',
    'error_code': 'é”™è¯¯ç ',
    'error_message': 'é”™è¯¯æ¶ˆæ¯ï¼ˆè„±æ•ï¼‰',
    
    # ä¸šåŠ¡ç›¸å…³
    'resource_type': 'èµ„æºç±»å‹',
    'resource_id': 'èµ„æº ID',
    'action': 'æ‰§è¡Œçš„æ“ä½œ',
}

# æ—¥å¿—è„±æ•è§„åˆ™
SENSITIVE_FIELDS = [
    'password',
    'token',
    'access_token',
    'refresh_token',
    'api_key',
    'credit_card',
    'ssn',
    'secret',
    'private_key',
]

def sanitize_log_data(data: dict) -> dict:
    """è„±æ•æ—¥å¿—æ•°æ®"""
    sanitized = {}
    for key, value in data.items():
        if key in SENSITIVE_FIELDS:
            sanitized[key] = '[REDACTED]'
        elif isinstance(value, dict):
            sanitized[key] = sanitize_log_data(value)
        else:
            sanitized[key] = value
    return sanitized
```

---

### 3ï¸âƒ£ WAF åŸºç¡€

#### 3.1 WAF å·¥ä½œåŸç†

```mermaid
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        WAF å·¥ä½œæµç¨‹                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚                   â”‚                   â”‚
          â–¼                   â–¼                   â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  è¯·æ±‚   â”‚â”€â”€â”€â”€â”€â”€â–ºâ”‚  è§„åˆ™   â”‚â”€â”€â”€â”€â”€â”€â–ºâ”‚  å“åº”   â”‚
    â”‚  æ¥æ”¶   â”‚       â”‚  åŒ¹é…   â”‚       â”‚  è¿‡æ»¤   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚               â”‚               â”‚
              â–¼               â–¼               â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  é€šè¿‡   â”‚   â”‚  é˜»æ–­   â”‚   â”‚  è®°å½•   â”‚
        â”‚  è¯·æ±‚   â”‚   â”‚  è¯·æ±‚   â”‚   â”‚  å‘Šè­¦   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3.2 ModSecurity è§„åˆ™ç¤ºä¾‹

```apache
# ModSecurity æ ¸å¿ƒè§„åˆ™é›†ç¤ºä¾‹

# SQL æ³¨å…¥é˜²æŠ¤
SecRule REQUEST_COOKIES|REQUEST_HEADERS|REQUEST_BODY "@rx (?i)(\%27)|(\')|(%22)|(\")|(--)|(\#)|(\/\*)|(\*\/)" \
    "id:100001,\
    phase:2,\
    deny,\
    status:403,\
    msg:'SQL Injection Attempt Detected',\
    severity:CRITICAL"

# XSS é˜²æŠ¤
SecRule REQUEST_COOKIES|REQUEST_HEADERS|REQUEST_BODY "@rx (?i)(<script>|javascript:|vbscript:|onload=|onerror=)" \
    "id:100002,\
    phase:2,\
    deny,\
    status:403,\
    msg:'XSS Attack Detected',\
    severity:CRITICAL"

# å‘½ä»¤æ³¨å…¥é˜²æŠ¤
SecRule REQUEST_COOKIES|REQUEST_HEADERS|REQUEST_BODY "@rx (?i)(whoami|ls|pwd|cat|grep|wget|curl|nc)" \
    "id:100003,\
    phase:2,\
    deny,\
    status:403,\
    msg:'Command Injection Attempt Detected',\
    severity:CRITICAL"

# è·¯å¾„éå†é˜²æŠ¤
SecRule REQUEST_URI "@rx (\.\./|\.\.\\|%2e%2e/)" \
    "id:100004,\
    phase:1,\
    deny,\
    status:403,\
    msg:'Path Traversal Attempt Detected',\
    severity:HIGH"

# é€Ÿç‡é™åˆ¶ï¼ˆç®€å•ç‰ˆï¼‰
SecAction \
    "id:100005,\
    phase:1,\
    initcol:IP=%{REMOTE_ADDR},\
    nolog"

SecRule IP:COUNT "@gt 100" \
    "id:100006,\
    phase:1,\
    deny,\
    status:429,\
    msg:'Rate Limit Exceeded',\
    severity:MEDIUM"

# æ·»åŠ å®‰å…¨å“åº”å¤´
Header set X-Frame-Options "SAMEORIGIN" "expr=%{REQUEST_STATUS} >= 200 && %{REQUEST_STATUS} < 400"
Header set X-Content-Type-Options "nosniff" "expr=%{REQUEST_STATUS} >= 200 && %{REQUEST_STATUS} < 400"
Header set X-XSS-Protection "1; mode=block" "expr=%{REQUEST_STATUS} >= 200 && %{REQUEST_STATUS} < 400"
```

#### 3.3 Nginx + ModSecurity é…ç½®

```nginx
# nginx.conf
worker_processes auto;
error_log /var/log/nginx/error.log warn;
pid /run/nginx.pid;

events {
    worker_connections 1024;
}

http {
    include /etc/nginx/mime.types;
    default_type application/octet-stream;

    # ModSecurity æ¨¡å—åŠ è½½
    load_module modules/ngx_http_modsecurity_module.so;

    # æ—¥å¿—æ ¼å¼
    log_format main '$remote_addr - $remote_user [$time_local] '
                    '"$request" $status $body_bytes_sent '
                    '"$http_referer" "$http_user_agent" '
                    'rt=$request_time uct="$upstream_connect_time" '
                    'uht="$upstream_header_time" urt="$upstream_response_time"';

    access_log /var/log/nginx/access.log main;

    server {
        listen 80;
        server_name example.com;

        # ModSecurity é…ç½®
        modsecurity on;
        modsecurity_rules_file /etc/nginx/modsecurity/main.conf;

        location / {
            proxy_pass http://127.0.0.1:8080;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Request-ID $request_id;
        }
    }
}
```

---

### 4ï¸âƒ£ WAF è¾¹ç•Œä¸ç»•è¿‡

#### 4.1 WAF çš„èƒ½åŠ›

```mermaid
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            WAF èƒ½åšä»€ä¹ˆ                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âœ… é˜»æ­¢å·²çŸ¥æ”»å‡»æ¨¡å¼ï¼ˆSQLiã€XSSã€CSRFï¼‰    â”‚
â”‚ âœ… é™åˆ¶è¯·æ±‚é€Ÿç‡ï¼ˆDoS é˜²æŠ¤ï¼‰               â”‚
â”‚ âœ… æ·»åŠ å®‰å…¨å“åº”å¤´                         â”‚
â”‚ âœ… è®°å½•å®‰å…¨äº‹ä»¶                           â”‚
â”‚ âœ… é˜»æ­¢æ¶æ„ IP                            â”‚
â”‚ âœ… åŸºæœ¬åè®®åˆè§„æ£€æŸ¥                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â”‚ ä¸èƒ½
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            WAF ä¸èƒ½åšä»€ä¹ˆ                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âŒ è¯†åˆ«ä¸šåŠ¡é€»è¾‘æ¼æ´                       â”‚
â”‚ âŒ é˜²æ­¢è®¤è¯ç»•è¿‡ï¼ˆToken ä¼ªé€ ï¼‰             â”‚
â”‚ âŒ æ£€æµ‹åŠ å¯†æµé‡ä¸­çš„æ”»å‡»ï¼ˆTLS ä¸­é—´è§£å¯†é™¤å¤–ï¼‰â”‚
â”‚ âŒ é˜²æ­¢ç¤¾ä¼šå·¥ç¨‹æ”»å‡»                       â”‚
â”‚ âŒ æ›¿ä»£å®‰å…¨ç¼–ç ï¼ˆä¿®å¤ä»£ç æ¼æ´ï¼‰            â”‚
â”‚ âŒ æ£€æµ‹æ‰€æœ‰ 0-day æ”»å‡»                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4.2 å¸¸è§ WAF ç»•è¿‡æŠ€æœ¯ï¼ˆä»…ä¾›é˜²å¾¡äº†è§£ï¼‰

```python
# äº†è§£æ”»å‡»è€…å¯èƒ½å°è¯•çš„ç»•è¿‡æ–¹å¼ï¼Œç”¨äºä¼˜åŒ– WAF è§„åˆ™

# ç»•è¿‡æŠ€æœ¯ç¤ºä¾‹ï¼ˆé˜²å¾¡è€…è§†è§’ï¼‰
WAF_BYPASS_TECHNIQUES = {
    'sql_injection': [
        'å¤§å°å†™æ··æ·† (UNion SELect â†’ uNiOn sElEcT)',
        'æ³¨é‡Šæ’å…¥ (SELECT/*comment*/1',
        'ç¼–ç ç»•è¿‡ (%27 â†’ &#39; â†’ %2527)',
        'ç­‰ä»·æ›¿æ¢ (AND â†’ &&, OR â†’ ||)',
        'ç©ºæ ¼æ›¿ä»£ (%09, %0a, %0d)',
    ],
    'xss': [
        'äº‹ä»¶å¤„ç†å™¨æ··æ·† (<img/src=x onerror=alert(1)>',
        'ç¼–ç ç»•è¿‡ (<script> â†’ <scr%00ipt>',
        'SVG æ³¨å…¥ (<svg/onload=alert(1)>',
        'DOM XSS (location.hash)',
    ],
    'path_traversal': [
        'åŒé‡ç¼–ç  (%252e%252e%252f)',
        'Unicode å˜ä½“ (..%c0%af â†’ ../)',
        'å­—èŠ‚æˆªæ–­ (....//....//)',
    ],
}

# é˜²å¾¡æªæ–½ï¼šWAF è§„åˆ™ä¼˜åŒ–å»ºè®®
WAF_RULE_OPTIMIZATIONS = [
    'ä¸ä¾èµ–å•ä¸€æ£€æµ‹æ–¹æ³•ï¼ˆæ­£åˆ™ + è¯­æ³•åˆ†æï¼‰',
    'å®æ–½å¤šå±‚æ£€æµ‹ï¼ˆåè®®ã€è¯­ä¹‰ã€è¡Œä¸ºï¼‰',
    'å®šæœŸæ›´æ–°è§„åˆ™é›†ï¼ˆOWASP CRSï¼‰',
    'å¯ç”¨è¯·æ±‚éªŒè¯ï¼ˆContent-Typeã€é•¿åº¦é™åˆ¶ï¼‰',
    'é…ç½®é€‚å½“çš„æ£€æµ‹é˜¶æ®µï¼ˆphase:1ã€phase:2ï¼‰',
    'å¯ç”¨å“åº”ç›‘æ§ï¼ˆä¿¡æ¯æ³„éœ²æ£€æµ‹ï¼‰',
]
```

#### 4.3 WAF éƒ¨ç½²æ¨¡å¼

| æ¨¡å¼ | æè¿° | ä¼˜ç‚¹ | ç¼ºç‚¹ |
|------|------|------|------|
| **åå‘ä»£ç†** | WAF ä½œä¸ºä¸­é—´äºº | é€æ˜éƒ¨ç½²ï¼Œæ— éœ€ä¿®æ”¹åº”ç”¨ | å•ç‚¹æ•…éšœï¼Œéœ€è¦é«˜å¯ç”¨ |
| **é€æ˜æ¡¥æ¥** | ç½‘ç»œå±‚éƒ¨ç½² | ä¸æ”¹å˜ç½‘ç»œæ¶æ„ | åŠŸèƒ½å—é™ |
| **ä¸»æœºå‹** | ModSecurity ç›´æ¥é›†æˆåˆ° Web æœåŠ¡å™¨ | æœ€ä½å»¶è¿Ÿ | éœ€è¦åœ¨æ¯ä¸ªæœåŠ¡å™¨éƒ¨ç½² |
| **äº‘ WAF** | SaaS å½¢å¼ | é›¶ç»´æŠ¤ï¼Œè‡ªåŠ¨æ›´æ–° | ä¾èµ–ç½‘ç»œï¼Œéšç§é¡¾è™‘ |

---

## å®è·µä»»åŠ¡ï¼ˆåˆæ³•æˆæƒèŒƒå›´å†…ï¼‰

### ä»»åŠ¡ 1ï¼ˆå¿…åšï¼‰ï¼šå®ç°ç»Ÿä¸€é”™è¯¯å¤„ç†

**ç›®æ ‡**ï¼šåˆ›å»ºå®‰å…¨çš„é”™è¯¯å¤„ç†æœºåˆ¶ã€‚

**æ­¥éª¤**ï¼š

1. **åˆ›å»ºé”™è¯¯å¤„ç†æ¨¡å—**

```python
# secure_errors.py
import logging
from secure_error_handler import SecureErrorHandler, APIError, ErrorSeverity

logger = logging.getLogger(__name__)
error_handler = SecureErrorHandler(logger)

# æµ‹è¯•é”™è¯¯å¤„ç†
try:
    raise ValueError("Invalid input: username contains special characters")
except Exception as e:
    response, status = error_handler.handle_exception(e, include_details=True)
    print(f"Status: {status}")
    print(f"Response: {response}")
```

2. **é…ç½® Flask åº”ç”¨**

```python
# app.py
from flask import Flask
from secure_error_handler import SecureErrorHandler

app = Flask(__name__)
error_handler = SecureErrorHandler(app.logger)

@app.errorhandler(Exception)
def handle_exception(e):
    response, status = error_handler.handle_exception(e, app.debug)
    return response, status
```

---

### ä»»åŠ¡ 2ï¼ˆå¿…åšï¼‰ï¼šé…ç½®å®‰å…¨æ—¥å¿—

**ç›®æ ‡**ï¼šå®ç°ç»“æ„åŒ–çš„å®‰å…¨äº‹ä»¶æ—¥å¿—ã€‚

**æ­¥éª¤**ï¼š

```python
# security_logging.py
from security_logger import SecurityLogger, SecurityEvent, SecurityEventType

logger = logging.getLogger('security')
security_logger = SecurityLogger(logger)

# æµ‹è¯•æ—¥å¿—è®°å½•
security_logger.log_login_attempt(
    username="testuser",
    ip_address="192.168.1.100",
    user_agent="Mozilla/5.0",
    success=True,
    request_id="abc123"
)

security_logger.log_access_denied(
    user_id="user123",
    ip_address="10.0.0.50",
    resource="/api/admin/users",
    action="read",
    request_id="def456"
)
```

---

### ä»»åŠ¡ 3ï¼ˆè¿›é˜¶ï¼‰ï¼šéƒ¨ç½² ModSecurity

**ç›®æ ‡**ï¼šä½¿ç”¨ Docker éƒ¨ç½²å¸¦ WAF ä¿æŠ¤çš„ Web åº”ç”¨ã€‚

**æ­¥éª¤**ï¼š

```yaml
# docker-compose.yml
version: '3.8'
services:
  nginx-modsecurity:
    image: owasp/modsecurity-crs:v3.3.2-nginx
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - ./modsecurity-rules:/etc/nginx/conf.d:ro
    environment:
      - SERVERNAME=localhost
      - MODSECURITY_CRS_POLICY_FILE=base_ruleset.conf
    networks:
      - webnet

  backend:
    image: my-flask-app:latest
    networks:
      - webnet

networks:
  webnet:
    driver: bridge
```

---

## å·©å›ºç»ƒä¹ ï¼ˆé¢˜ä¸å¤ç›˜ï¼‰

### ç»ƒä¹  1ï¼šä¸ºä»€ä¹ˆä¸èƒ½å‘ç”¨æˆ·è¾“å‡ºå †æ ˆä¿¡æ¯ï¼Ÿ

**é—®é¢˜**ï¼šè¯¦ç»†é”™è¯¯å †æ ˆä¿¡æ¯ä¼šæ³„éœ²å“ªäº›æ•æ„Ÿä¿¡æ¯ï¼Ÿ

**ç­”æ¡ˆ**ï¼š

| æ³„éœ²ä¿¡æ¯ | é£é™©ç­‰çº§ | è¯´æ˜ |
|---------|---------|------|
| æ–‡ä»¶è·¯å¾„ | é«˜ | å¸®åŠ©æ”»å‡»è€…å®šä½æ•æ„Ÿæ–‡ä»¶ |
| æ•°æ®åº“ç»“æ„ | é«˜ | ç”¨äº SQL æ³¨å…¥æ”»å‡» |
| ç¬¬ä¸‰æ–¹åº“ç‰ˆæœ¬ | ä¸­ | ç”¨äºæŸ¥æ‰¾å·²çŸ¥æ¼æ´ |
| å‡½æ•°è°ƒç”¨é“¾ | ä½ | ç†è§£ä¸šåŠ¡é€»è¾‘ |
| å†…éƒ¨ IP/ä¸»æœºå | ä¸­ | å†…ç½‘æ¸—é€çº¿ç´¢ |

### ç»ƒä¹  2ï¼šè®¾è®¡æ—¥å¿—å­—æ®µæ¸…å•

**ä»»åŠ¡**ï¼šä¸º API è®¿é—®æ—¥å¿—è®¾è®¡æ ‡å‡†å­—æ®µã€‚

**ç­”æ¡ˆ**ï¼š

```python
# æ ‡å‡†æ—¥å¿—å­—æ®µå®šä¹‰
LOG_FIELDS = {
    # å¿…éœ€å­—æ®µ
    'timestamp': '2026-01-27T10:30:00Z',
    'event_type': 'api_access',
    'level': 'INFO',
    
    # è¯·æ±‚ä¿¡æ¯
    'request_id': 'req-abc123',
    'method': 'GET',
    'path': '/api/v1/users/123',
    'query_params': {'page': '1'},  # æ•æ„Ÿå‚æ•°è„±æ•
    
    # ç”¨æˆ·ä¿¡æ¯
    'user_id': 'user_456',
    'session_id': 'sess_789',
    'ip_address': '192.168.1.100',
    'user_agent': 'Mozilla/5.0...',
    
    # å“åº”ä¿¡æ¯
    'status_code': 200,
    'response_size': 1024,
    'response_time_ms': 45,
    
    # å®‰å…¨ä¿¡æ¯
    'auth_type': 'Bearer',
    'auth_result': 'success',
    
    # ä¸šåŠ¡ä¿¡æ¯
    'resource_type': 'user',
    'resource_id': '123',
    'action': 'read',
}
```

---

## è¯„ä¼°æ ‡å‡†ï¼ˆè¾¾æˆåˆ¤å®šï¼‰

- âœ… å®ç°äº†ç»Ÿä¸€é”™è¯¯å¤„ç†ï¼Œä¸æ³„éœ²æ•æ„Ÿä¿¡æ¯
- âœ… é…ç½®äº†å®Œæ•´çš„å®‰å…¨å“åº”å¤´
- âœ… å®ç°äº†å®‰å…¨äº‹ä»¶æ—¥å¿—è®°å½•
- âœ… ç†è§£ WAF çš„ä½œç”¨ä¸è¾¹ç•Œ
- âœ… èƒ½è®¾è®¡æ—¥å¿—å­—æ®µæ¸…å•

---

## å­¦ä¹ æˆæœè¾¾æˆæƒ…å†µï¼ˆç”±å­¦ä¹ è€…å¡«å†™ï¼‰

### æˆªå›¾ä¸è¯æ®

- [ ] é”™è¯¯å¤„ç†æµ‹è¯•æˆªå›¾
- [ ] å®‰å…¨æ—¥å¿—è¾“å‡ºæˆªå›¾
- [ ] WAF é˜»æ–­æˆªå›¾

### å…³é”®å‘½ä»¤ä¸è¾“å‡º

**é”™è¯¯å“åº”ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰**ï¼š
```json
{
  "error": {
    "code": "INTERNAL_ERROR",
    "message": "æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ï¼Œè¯·ç¨åé‡è¯•",
    "request_id": "abc123"
  }
}
```

**é”™è¯¯å“åº”ï¼ˆå¼€å‘ç¯å¢ƒï¼‰**ï¼š
```json
{
  "error": {
    "code": "VALIDATION_ERROR",
    "message": "è¯·æ±‚å‚æ•°ä¸åˆæ³•",
    "request_id": "abc123",
    "details": {
      "error_type": "ValueError",
      "internal_message": "Invalid email format: not@valid"
    }
  }
}
```

### ç»“è®ºä¸åæ€

**æˆ‘ä»Šå¤©ææ¸…æ¥šäº†**ï¼š

- é”™è¯¯ä¿¡æ¯æ³„éœ²ä¼šå¯¼è‡´äºŒæ¬¡æ”»å‡»
- WAF æ˜¯é˜²æŠ¤å±‚ï¼Œä¸æ˜¯ä¸‡èƒ½è§£å†³æ–¹æ¡ˆ
- å®‰å…¨æ—¥å¿—å¯¹äºäº‹åæº¯æºè‡³å…³é‡è¦

**æˆ‘å·®ç‚¹ææ··çš„æ˜¯**ï¼š

- å¼€å‘ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒçš„é”™è¯¯å¤„ç†ç­–ç•¥
- WAF çš„æ£€æµ‹æ¨¡å¼å’Œé˜»æ–­æ¨¡å¼çš„åŒºåˆ«

**æ˜å¤©æˆ‘è¦ç»§ç»­è¡¥çš„æ˜¯**ï¼š

- WAF è§„åˆ™ç¼–å†™ä¸è°ƒä¼˜
- æ—¥å¿—åˆ†æä¸å‘Šè­¦è§„åˆ™

**æœ¬æ¬¡å­¦ä¹ è€—æ—¶**ï¼šçº¦ 2.5 å°æ—¶

**æŒæ¡ç¨‹åº¦è‡ªè¯„**ï¼š

- [ ] ğŸ˜• ç†è§£äº†åŸºæœ¬æ¦‚å¿µ
- [ ] ğŸ™‚ å®Œæˆäº†åŸºç¡€ä»»åŠ¡
- [ ] ğŸ˜ƒ å®Œæˆäº†æ‰€æœ‰ä»»åŠ¡
- [ ] ğŸ¤© æ·±å…¥ç ”ç©¶äº† WAF è§„åˆ™ä¼˜åŒ–

---
---
# Day041ï¼šWeb å®‰å…¨ - é”™è¯¯å¤„ç†ã€æ—¥å¿—ä¸ WAF è¾¹ç•Œ

- æ—¥æœŸï¼š2026-02-03
- å‘¨æ¬¡ï¼šç¬¬6å‘¨

## å­¦ä¹ ç›®æ ‡
- ç†è§£é”™è¯¯ä¿¡æ¯æš´éœ²çš„é£é™©
- è®¤è¯† WAF çš„ä½œç”¨ä¸è¾¹ç•Œ

<!--more-->

## å­¦ä¹ å†…å®¹
- ç»Ÿä¸€é”™è¯¯å¤„ç†ä¸å®‰å…¨æ—¥å¿—è®°å½•
- WAF è§„åˆ™åŸºç¡€ä¸ç»•è¿‡å¯èƒ½ï¼ˆç†è®ºï¼‰

## å®è·µä»»åŠ¡ï¼ˆåˆæ³•æˆæƒèŒƒå›´å†…ï¼‰
- å®ç°ç»Ÿä¸€é”™è¯¯è¾“å‡ºå¹¶è®°å½•å®‰å…¨æ—¥å¿—
- é…ç½®åŸºç¡€ WAF è§„åˆ™å¹¶è§‚å¯Ÿæ•ˆæœ

## å·©å›ºç»ƒä¹ ï¼ˆé¢˜ä¸å¤ç›˜ï¼‰
- é¢˜ç›®ï¼šä¸ºä»€ä¹ˆä¸èƒ½è¾“å‡ºå †æ ˆåˆ°ç”¨æˆ·ç•Œé¢ï¼Ÿ
- ç»ƒä¹ ï¼šæ’°å†™æ—¥å¿—å­—æ®µæ¸…å•

## è¯„ä¼°æ ‡å‡†ï¼ˆè¾¾æˆåˆ¤å®šï¼‰
- é”™è¯¯è¾“å‡ºè§„èŒƒåŒ–ï¼Œæ—¥å¿—å­—æ®µå®Œæ•´
- âœ… èƒ½è¯´æ˜ WAF çš„è¾¹ç•Œ

## å­¦ä¹ æˆæœè¾¾æˆæƒ…å†µï¼ˆç”±å­¦ä¹ è€…å¡«å†™ï¼‰
- æˆªå›¾ä¸è¯æ®ï¼š
- å…³é”®å‘½ä»¤ä¸è¾“å‡ºï¼š
- ç»“è®ºä¸åæ€ï¼š


## é›†ä¸­å‚è€ƒç­”æ¡ˆï¼ˆå«æ€è·¯ï¼‰

### é¢˜ 1 å‚è€ƒç­”æ¡ˆ

ï¼ˆå¾…è¡¥å……ï¼‰


## å­¦ä¹ æˆæœç¤ºä¾‹å¡«å†™ï¼ˆå¯ç…§æŠ„ï¼‰

> å¯å°†"ç¤ºä¾‹"å†…å®¹æ›¿æ¢ä¸ºä½ è‡ªå·±çš„æ—¶é—´ä¸æˆªå›¾æ–‡ä»¶åã€‚

### æˆªå›¾ä¸è¯æ®ï¼ˆç¤ºä¾‹ï¼‰

- ä»»åŠ¡ 1ï¼š`images/dayXXX_task1.png`

### å…³é”®å‘½ä»¤ä¸è¾“å‡ºï¼ˆç¤ºä¾‹ï¼‰

```
å‘½ä»¤ç¤ºä¾‹ï¼š
è¾“å‡ºç¤ºä¾‹ï¼š
```

### ç»“è®ºä¸åæ€ï¼ˆç¤ºä¾‹ï¼‰

**æˆ‘ä»Šå¤©ææ¸…æ¥šäº†**ï¼š
- ï¼ˆç¤ºä¾‹ï¼‰ç†è§£äº†æ ¸å¿ƒæ¦‚å¿µ

**æˆ‘å·®ç‚¹ææ··çš„æ˜¯**ï¼š
- ï¼ˆç¤ºä¾‹ï¼‰æŸä¸ªæ˜“æ··æ·†ç‚¹

**æ˜å¤©æˆ‘è¦ç»§ç»­è¡¥çš„æ˜¯**ï¼š
- ï¼ˆç¤ºä¾‹ï¼‰ä¸‹ä¸€æ­¥æ·±å…¥æ–¹å‘

**æœ¬æ¬¡å­¦ä¹ è€—æ—¶**ï¼šçº¦ 2 å°æ—¶

**æŒæ¡ç¨‹åº¦è‡ªè¯„**ï¼š
- [x] ğŸ˜ƒ å®Œæˆäº†æ‰€æœ‰ä»»åŠ¡å¹¶ç†è§£åŸç†
