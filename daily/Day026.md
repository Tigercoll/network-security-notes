---
title: Day026：漏洞扫描与基线 - 常见 Web 漏洞 (1) SQL 注入与 XSS
tags:
  - 网络
  - 安全
  - 学习计划
categories:
  - 网络安全
abbrlink: a1b2c
date: 2026-02-17
updated: 2026-02-17
---

# Day026：漏洞扫描与基线 - 常见 Web 漏洞 (1) SQL 注入与 XSS

- **日期**：2026-02-17
- **周次**：第 4 周
- **模块**：漏洞扫描与基线
- **主题**：常见 Web 漏洞 (1) SQL 注入与 XSS
- **预计学习时间**：3 小时

---

## 🎯 学习目标

学完今天你应该能做到：

- **数据库提权**：理解 SQL 注入原理，能手动闭合单引号，拖库（Dump Database）。
- **脚本攻击**：理解 XSS 原理，能弹窗（alert）并窃取 Cookie。
- **防御思维**：知道预编译（Prepared Statement）和 HTML 转义是防御这两大漏洞的终极武器。

<!--more-->

---

## 📚 完整学习内容（必读）

本节包含今天需要学习的全部知识点，请认真阅读并理解。

### 一、概念理解

#### 1.1.1 核心本质：信任的崩塌
Web 漏洞的核心本质是：**服务器盲目信任了用户的输入**。
当用户输入的数据（Data）被当成代码（Code）执行时，灾难就发生了。

#### 1.1.2 SQL 注入 (SQL Injection)
- **定义**：黑客通过在 Web 表单输入恶意 SQL 语句，骗过服务器，让数据库执行非授权操作。
- **危害**：数据泄露（拖库）、数据篡改、数据库服务器沦陷。

#### 1.1.3 跨站脚本 (Cross-Site Scripting, XSS)
- **定义**：黑客在网页中植入恶意脚本，当受害者访问时，脚本在受害者的浏览器里执行。
- **危害**：窃取 Cookie（盗号）、钓鱼、恶意重定向。

### 二、原理讲解

#### 1.2.1 SQL 注入原理
假设登录代码如下：
```sql
SELECT * FROM users WHERE user='$name' AND pass='$pass'
```
如果用户输入 `name` 为 `admin' --`，SQL 语句就变成了：
```sql
SELECT * FROM users WHERE user='admin' --' AND pass='...'
```
- `'`：闭合了前面的单引号。
- `--`：在 SQL 中表示注释，后面的内容（密码验证）全被忽略了。
**结果**：黑客免密登录了 admin 账号。

#### 1.2.2 XSS 原理
假设评论区代码如下：
```php
echo "<div>" + $comment + "</div>";
```
如果用户输入 `comment` 为 `<script>alert(1)</script>`，HTML 就变成了：
```html
<div><script>alert(1)</script></div>
```
**结果**：浏览器解析到 `<script>` 标签，立即执行其中的 JS 代码，弹出窗口。

### 三、技术细节

#### 1.3.1 SQL 注入 Payload 速查
1.  **万能钥匙**：`' or 1=1 --`
2.  **联合查询 (Union)**：`' UNION SELECT 1, database(), user() --`（查数据库名和用户名）。
3.  **盲注 (Blind)**：
    -   **布尔盲注**：`' and length(database())>5 --`（猜数据库名长度）。
    -   **时间盲注**：`' and sleep(5) --`（如果睡了5秒，说明注入成功）。

#### 1.3.2 XSS 分类与 Payload
1.  **反射型 (Reflected)**：Payload 在 URL 里，发给谁谁中招（一次性）。
    -   场景：搜索框、错误信息页。
2.  **存储型 (Stored)**：Payload 存进数据库，谁看谁中招（持久性，危害大）。
    -   场景：评论区、留言板、个人简介。
3.  **DOM 型**：纯前端逻辑漏洞，不经过服务器。

**常用 Payload**：
-   `<script>alert(1)</script>`
-   `<img src=x onerror=alert(1)>` (绕过 `<script>` 过滤)
-   `javascript:alert(1)` (放在 `<a href="...">` 里)

### 四、进阶知识（选学）

#### 1.4.1 防御方案
1.  **防 SQL 注入**：**参数化查询 (Prepared Statement)**。
    -   原理：先把 SQL 语句编译好（占位符 `?`），再把用户输入当成**纯文本**填进去，绝不解释为代码。
2.  **防 XSS**：**HTML 实体编码 (Encoding)**。
    -   原理：把 `<` 变成 `&lt;`，`>` 变成 `&gt;`。浏览器会显示 `<` 字符，但不会把它当标签执行。

### 五、本日知识点速查表

| 序号 | 核心概念 | 关键点 | 备注 |
|------|----------|--------|------|
| 1 | **SQLi** | 注入 | 数据变代码 |
| 2 | **Union** | 联合查询 | 拼接结果 |
| 3 | **Blind** | 盲注 | 靠猜（时间/布尔） |
| 4 | **XSS** | 跨站脚本 | 偷 Cookie |
| 5 | **Prepared** | 预编译 | SQLi 克星 |

---

## 🗺️ 知识图谱

### 今日内容在整体知识体系中的位置

```
网络安全学习路径
├── 第 4 周：漏洞扫描与基线
│   ├── Day025：Web 协议
│   └── Day026：Web 漏洞 (1)
│       ├── 服务端漏洞：SQLi (数据库)
│       ├── 客户端漏洞：XSS (浏览器)
│       └── 核心成因：输入验证失效
└── 后续衔接
    └── Day027：Web 漏洞 (2) (逻辑漏洞/上传)
```

### 今日关键词

`SQLi` · `XSS` · `Payload` · `Prepared Statement`

---

## 🔧 实践任务（合法授权范围内）

> ⚠️ **安全提示**：请使用 DVWA 靶场进行测试。

请按顺序完成以下任务：

### 任务 1：DVWA 靶场 - SQL 注入（30 分钟）

**操作步骤**：
1. 启动 DVWA 容器，设置 Security Level 为 **Low**。
2. 进入 **SQL Injection** 模块。
3. 输入 `1`，显示 ID=1 的用户。
4. 输入 `1' or 1=1 #`，看看是不是把所有用户都列出来了？
5. **思考**：为什么加了单引号和井号就能绕过？

**预期结果**：成功列出所有用户信息。

### 任务 2：DVWA 靶场 - 反射型 XSS（15 分钟）

**操作步骤**：
1. 进入 **XSS (Reflected)** 模块。
2. 输入 `Bob`，显示 "Hello Bob"。
3. 输入 `<script>alert(document.cookie)</script>`。
4. **观察**：有没有弹窗？弹窗里是不是你的 Session ID？

**预期结果**：成功弹窗显示 Cookie。

### 任务 3：DVWA 靶场 - 存储型 XSS（15 分钟）

**操作步骤**：
1. 进入 **XSS (Stored)** 模块。
2. 在 Name 填 `Hacker`，Message 填 `<script>alert('I am here forever')</script>`。
3. 点击 Sign Guestbook。
4. **关键**：刷新页面，或者换个浏览器访问这个页面，弹窗还在吗？

**预期结果**：每次访问该页面都会弹窗。

---

## 📝 巩固练习（题目与复盘）

### 练习 1：概念理解（5 分钟）

**题目**：为什么 `1' or '1'='1` 被称为“万能密码”？

**参考答案**：因为 `OR` 运算只要有一边为真，结果就是真。`'1'='1'` 永远为真，所以 `WHERE ...` 条件永远成立，直接绕过了密码验证。

### 练习 2：实操复盘（5 分钟）

**题目**：我在测试 XSS 时，发现输入 `<script>` 被变成了 `&lt;script&gt;`，这是什么防御？

**参考答案**：这是 **HTML 实体编码**（转义）。这说明服务器已经做了很好的防御，XSS 攻击失效。

---

## ✅ 评估标准（达成判定）

- [ ] 我能解释 SQL 注入的成因（拼接字符串）。
- [ ] 我能区分反射型和存储型 XSS。
- [ ] 我知道 `alert(document.cookie)` 的危害。

### 自检清单

- [ ] **概念理解**：能手写出 SQL 注入的闭合语句。
- [ ] **实际应用**：能用 Union 查询爆出数据库名。
- [ ] **安全意识**：输入框里永远不要相信用户。

### 学习进度自评

| 评估项目 | 1-5 星 | 备注 |
|----------|--------|------|
| 注入原理 | ⭐⭐⭐⭐⭐ | |
| 脚本原理 | ⭐⭐⭐⭐⭐ | |
| 防御意识 | ⭐⭐⭐⭐⭐ | |

---

## 📊 学习成果记录（由学习者填写）

### 学习信息

| 项目 | 内容 |
|------|------|
| 学习日期 | 2026-02-17 |
| 学习时长 | ___ 小时 |
| 完成情况 | ⬜ 已完成 / ⬜ 部分完成 / ⬜ 未完成 |

### 实践任务完成记录

| 任务 | 完成状态 | 关键证据/截图 |
|------|----------|---------------|
| 任务 1 | ⬜ 已完成 | 截图：SQL 注入成功列表 |
| 任务 2 | ⬜ 已完成 | 截图：XSS 弹窗 |
| 任务 3 | ⬜ 已完成 | 截图：存储型 XSS 页面 |

---

## 💡 知识卡片速查

### SQL 注入常用符号

| 符号 | 作用 |
|------|------|
| `'` | 闭合单引号 |
| `--` | 注释（MySQL） |
| `#` | 注释（MySQL URL编码后） |
| `/*` | 多行注释 |

### XSS 常用标签

| 标签 | Payload |
|------|---------|
| `<script>` | `<script>alert(1)</script>` |
| `<img>` | `<img src=x onerror=alert(1)>` |
| `<body>` | `<body onload=alert(1)>` |

---

## ❓ 常见问题与解答

**Q1：为什么我输入 `' or 1=1 --` 报错了？**
A1：可能是因为这是**数字型注入**（不需要引号闭合），或者是对方用的数据库注释符不一样（比如 Access 数据库不支持 `--`）。

**Q2：XSS 能干什么坏事？**
A2：最常见的是盗取 Cookie（Session 劫持），这能让攻击者直接登录你的账号。还可以配合 CSRF 自动转账，或者重定向到钓鱼网站。

---

## 🚀 下一步学习预告

**明日主题预告**：Day027 - 常见 Web 漏洞 (2) 越权、上传与弱口令

**学习重点预告**：
- 逻辑漏洞：越权访问 (IDOR)。
- 文件上传：WebShell。
- 暴力破解：Burp Intruder。

**今日学习为明日做铺垫**：
- 今天学的是**代码层**的漏洞，明天学的是**业务逻辑层**的漏洞。

---

> 💬 **学习提示**：
> 1. SQL 注入比较抽象，建议多画图理解“拼接”的过程。
> 2. XSS 比较直观，多试几个 Payload 找找感觉。
> 3. **再次强调**：在自己搭建的靶场里怎么玩都行，千万别去公网乱试！

```bash
git add daily/Day026.md
git commit -m "Day026: 完成学习与记录"
```
