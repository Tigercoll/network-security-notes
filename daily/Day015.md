---
title: Day015：操作系统与脚本 - Linux 安全基础
tags:
  - 网络
  - 安全
  - 学习计划
categories:
  - 网络安全
abbrlink: ed2df
date: 2026-02-06
updated: 2026-02-06
---

# Day015：操作系统与脚本 - Linux 安全基础

- **日期**：2026-02-06
- **周次**：第 3 周
- **模块**：操作系统与脚本
- **主题**：Linux 安全基础
- **预计学习时间**：___ 小时

---

## 🎯 学习目标

学完今天你应该能做到：

- 理解 Linux 用户与组的管理机制 (`/etc/passwd`, `/etc/shadow`)
- 熟练掌握文件权限 (`chmod`, `chown`) 与特殊权限 (SUID)
- 掌握系统日志审计 (`/var/log`) 与服务管理 (`systemctl`)
- 能对 Linux 系统进行基础的安全加固

<!--more-->

## 📚 完整学习内容（必读）

本节包含今天需要学习的全部知识点，请认真阅读并理解。

### 一、概念理解

#### 1. 用户与身份 (User & Identity)
- **Root (UID 0)**: 系统的上帝，拥有至高无上的权限。
- **System Users (UID 1-999)**: 运行服务的账号（如 `www-data`, `mysql`），通常禁止登录。
- **Regular Users (UID 1000+)**: 普通人类用户。
- **关键文件**:
    - `/etc/passwd`: 用户信息（公开可读）。
    - `/etc/shadow`: 密码哈希（仅 root 可读，重要！）。

#### 2. 权限模型 (Permissions)
Linux 奉行 "Everything is a file"（一切皆文件）。每个文件都有：
- **所有者 (User)**, **所属组 (Group)**, **其他人 (Others)**
- **读 (r=4)**, **写 (w=2)**, **执行 (x=1)**

#### 3. 特殊权限 (Special Permissions)
- **SUID (4000)**: 让普通用户以文件所有者（通常是 root）的身份执行程序（如 `passwd` 命令）。**这是提权的常见漏洞点。**
- **Sticky Bit (1000)**: 防止用户删除目录中不属于自己的文件（如 `/tmp`）。

### 二、原理讲解

#### 1. 为什么 `/etc/shadow` 如此重要？
早期的 Unix 将密码哈希存在 `/etc/passwd` 中，但该文件必须全员可读（因为 `ls -l` 需要解析用户名）。这导致黑客可以轻易拿到哈希进行离线破解。后来将哈希移至 `/etc/shadow`，并仅限 root 读取，大大提高了安全性。

#### 2. 日志审计机制
Linux 通过 `syslog` 或 `systemd-journald` 记录系统活动。
- `/var/log/auth.log` (或 `secure`): 记录认证成功与失败（**抓爆破必看**）。
- `/var/log/syslog` (或 `messages`): 系统通用日志。
- `/var/log/wtmp`: 记录登录历史（用 `last` 命令查看）。

### 三、技术细节

#### 1. 常用命令
- `id`: 查看当前用户信息。
- `chmod 755 file`: 设置 rwxr-xr-x。
- `chown user:group file`: 修改文件所有者。
- `visudo`: 安全地编辑 `/etc/sudoers`（配置 sudo 权限）。
- `systemctl status ssh`: 查看服务状态。

#### 2. 基础加固 Checklist
1.  **禁用 Root 远程登录**: 修改 `/etc/ssh/sshd_config` -> `PermitRootLogin no`。
2.  **设置密码策略**: 强密码、定期更换（`/etc/login.defs`）。
3.  **最小化服务**: 关闭不必要的端口和服务。
4.  **文件权限回收**: 确保敏感文件（如配置文件）不被 `Others` 读取。

### 四、进阶知识（选学）

#### SUID 提权
如果管理员错误地给 `/bin/bash` 或 `find` 等命令赋予了 SUID 权限，攻击者可以利用它瞬间获得 root shell。
- 查找 SUID 文件: `find / -perm -u=s -type f 2>/dev/null`

### 五、本日知识点速查表

| 序号 | 核心概念 | 关键点 | 备注 |
|------|----------|--------|------|
| 1 | UID 0 | Root 用户 | 系统最高权限 |
| 2 | 777 | rwxrwxrwx | 极度危险，禁止使用 |
| 3 | SUID | s 标志位 | 提权风险点 |
| 4 | auth.log | 认证日志 | 查黑客痕迹 |
| 5 | sudo | 提权执行 | 比直接用 root 安全 |

---

## 🗺️ 知识图谱

### 今日内容在整体知识体系中的位置

```
网络安全学习路径
├── 第 3 周：操作系统与脚本
│   └── Day015：Linux 安全基础
│       ├── 用户管理 (User/Group)
│       ├── 权限控制 (rwx/SUID)
│       ├── 日志审计 (Logs)
│       └── 系统加固 (Hardening)
└── 后续衔接
    └── Day016：Windows 安全基础
```

### 今日关键词

`Linux` · `Permissions` · `Hardening`

---

## 🔧 实践任务（合法授权范围内）

> ⚠️ **安全提示**：所有任务必须在合法授权的实验环境中进行，禁止对未授权目标进行任何测试。

请按顺序完成以下任务：

### 任务 1：环境准备（5 分钟）

启动你的 Kali Linux 或 Ubuntu 虚拟机。

**操作步骤**：
1. 打开终端/命令行
2. 输入命令：`whoami && id`
3. 观察输出结果（当前用户和组 ID）
4. 截图保存

### 任务 2：核心实验（30 分钟）

**体验权限控制与 SUID**

**操作步骤**：
1. 第一步：创建一个只有 root 能写的文件。
   `sudo touch /root/secret.txt`
   `sudo chmod 600 /root/secret.txt`
2. 第二步：尝试用普通用户读取，观察报错。
   `cat /root/secret.txt` (应显示 Permission denied)
3. 第三步：(危险操作演示) 给 `cat` 命令赋予 SUID 权限。
   `sudo chmod u+s /bin/cat` (注意：实验后务必复原！)
4. 第四步：再次尝试用普通用户读取。
   `cat /root/secret.txt` (现在应该能读取了，因为 cat 以 root 身份运行)
5. 第五步：**立刻复原环境！**
   `sudo chmod u-s /bin/cat`

**预期结果**：
- 结果 1：普通状态下无法读取 root 文件。
- 结果 2：SUID 状态下可以越权读取。

### 任务 3：进阶挑战（选做，15 分钟）

**日志分析**

**操作步骤**：
1. 尝试故意输错 sudo 密码 3 次。
2. 查看认证日志：`sudo tail -n 20 /var/log/auth.log` (Ubuntu/Kali) 或 `/var/log/secure` (CentOS)。
3. 找到刚才的失败记录（关键字：authentication failure）。

---

## 📝 巩固练习（题目与复盘）

完成以下练习来检验你的学习效果。

### 练习 1：概念理解（5 分钟）

题目：解释权限 `drwxr-xr--` 的含义 (数字表示是多少？)

**参考答案**（完成后对照）：
- `d`: 这是一个目录。
- `rwx` (Owner): 所有者可读、写、进入目录 (4+2+1=7)。
- `r-x` (Group): 组用户可读、进入目录，不可写 (4+0+1=5)。
- `r--` (Others): 其他人只读 (4+0+0=4)。
- 数字表示：754

### 练习 2：实操应用（10 分钟）

练习：写出 3 个 Linux 系统加固的检查点。

**参考答案**（完成后对照）：
1. 检查是否存在空密码用户 (`awk -F: '($2 == "") {print $1}' /etc/shadow`)。
2. 检查 SSH 是否禁止了 root 远程登录。
3. 检查 `/tmp` 目录是否有 Sticky Bit 权限。

### 练习 3：深度思考（10 分钟）

为什么 Linux 默认创建的文件权限通常是 644 或 664，而不是 666？

**参考答案**（完成后对照）：
这是由 `umask` 值决定的。默认 umask 通常是 022，它会在创建文件时“屏蔽”掉组和其他人的写权限，从而保护文件不被他人意外修改。

---

## ✅ 评估标准（达成判定）

请对照以下标准检查你的学习成果：

- 能流畅使用 `ls -l` 查看权限并用数字法 (`chmod`) 修改权限
- 知道 SUID 是什么以及为什么它很危险
- 知道去哪里看登录失败的日志

### 自检清单

完成学习后，请检查以下项目：

- [ ] **概念理解**：能用自己的话解释今天学到的核心概念
- [ ] **实际应用**：能给出实际应用场景的例子
- [ ] **动手能力**：能独立完成实践任务不需要提示
- [ ] **时间管理**：能在有限时间内完成今日学习内容
- [ ] **知识迁移**：能将在本文学到的知识应用到其他场景

### 学习进度自评

| 评估项目 | 1-5 星 | 备注 |
|----------|--------|------|
| 概念理解 | ⭐⭐⭐⭐⭐ | |
| 动手能力 | ⭐⭐⭐⭐⭐ | |
| 时间控制 | ⭐⭐⭐⭐⭐ | |
| 学习兴趣 | ⭐⭐⭐⭐⭐ | |

---

## 📊 学习成果记录（由学习者填写）

### 学习信息

| 项目 | 内容 |
|------|------|
| 学习日期 | 2026-02-06 |
| 学习时长 | ___ 小时 |
| 完成情况 | ⬜ 已完成 / ⬜ 部分完成 / ⬜ 未完成 |

### 实践任务完成记录

| 任务 | 完成状态 | 关键证据/截图 | 用时 |
|------|----------|---------------|------|
| 任务 1 | ⬜ 已完成 / ⬜ 部分 / ⬜ 未做 | | ___ 分钟 |
| 任务 2 | ⬜ 已完成 / ⬜ 部分 / ⬜ 未做 | | ___ 分钟 |
| 任务 3 | ⬜ 已完成 / ⬜ 部分 / ⬜ 未做 | | ___ 分钟 |

### 命令/代码记录

```bash
# 记录你今天使用的命令
___
___

# 记录重要的输出结果
___
```

### 今日总结与反思

**今日收获**（用 3-5 句话总结今天学到了什么）：

_

**遇到的问题与解决**：

_

**明日待深化的问题**：

_

---

## 💡 知识卡片速查

### 核心概念速记

| 概念 | 定义 | 举例 |
|------|------|------|
| **UID** | 用户ID | Root是0 |
| **SUID** | 以所有者身份执行 | passwd命令 |
| **Umask** | 默认权限掩码 | 022 |

### 常用命令速查

| 场景 | 命令 | 说明 |
|------|------|------|
| 修改权限 | `chmod 755 <file>` | 赋权 |
| 修改所有者 | `chown user:group <file>` | 改名 |
| 查日志 | `tail -f /var/log/auth.log` | 实时看 |

### 常见错误与解决

| 错误现象 | 可能原因 | 解决方法 |
|----------|----------|----------|
| Permission denied | 权限不足 | 使用 sudo 或 chmod |
| 找不到命令 | 未在 PATH 中 | 使用绝对路径 |

---

## ❓ 常见问题与解答

**Q1：777 权限有什么不好？**

A1：777 意味着任何人（包括恶意软件、未授权用户）都可以随意修改、删除、执行该文件。如果是目录，任何人都能在里面删你的文件。这在安全上是灾难性的。

**Q2：sudo 和 su 的区别？**

A2：`su` 是切换到 root 用户（需要 root 密码），`sudo` 是以 root 权限执行命令（需要当前用户的密码，且需配置 sudoers）。`sudo` 审计性更好，更推荐。

---

## 🚀 下一步学习预告

**明日主题预告**：Day016 - Windows 安全基础

**学习重点预告**：
- Windows 的用户组与 SID
- NTFS 权限与 ACL
- 注册表与服务安全

**今日学习为明日做铺垫**：
- 权限控制的思想是通用的，明天对比 Linux 和 Windows 的异同。

---

## 📖 参考资料

- 📖 官方文档：[Linux Filesystem Permissions](https://ubuntu.com/tutorials/command-line-for-beginners#10-permissions)
- 🎥 视频教程：___
- 🛠️ 实践靶场：___
- 📚 参考书籍：___
- 🔗 相关链接：___

---

> 💬 **学习提示**：
> 1. 建议按照文档顺序学习，不要跳跃
> 2. 每个知识点理解后再进行下一步
> 3. 实践任务一定要亲手做，不要只看
> 4. 遇到问题先思考，再查阅资料，最后再问
> 5. 坚持每天完成学习任务并记录成果，90 天后你会感谢现在的自己！
>
> ```bash
> git add daily/Day015.md
> git commit -m "Day015: 完成学习与记录"
> ```
