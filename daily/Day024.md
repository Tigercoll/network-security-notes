---
title: Day024：漏洞扫描与基线 - 主动扫描工具实战 (Nmap/Nessus)
tags:
  - 网络
  - 安全
  - 学习计划
categories:
  - 网络安全
abbrlink: 8c9d2
date: 2026-02-15
updated: 2026-02-15
---

# Day024：漏洞扫描与基线 - 主动扫描工具实战 (Nmap/Nessus)

- **日期**：2026-02-15
- **周次**：第 4 周
- **模块**：漏洞扫描与基线
- **主题**：主动扫描工具实战 (Nmap/Nessus)
- **预计学习时间**：3 小时

---

## 🎯 学习目标

学完今天你应该能做到：

- **诸神之眼**：熟练使用 Nmap 进行全端口扫描、服务版本探测。
- **脚本大师**：利用 NSE (Nmap Scripting Engine) 探测心脏滴血等具体漏洞。
- **自动体检**：安装并使用 Nessus 进行全方位的系统漏洞扫描，看懂扫描报告。

<!--more-->

---

## 📚 完整学习内容（必读）

本节包含今天需要学习的全部知识点，请认真阅读并理解。

### 一、概念理解

#### 1.1.1 端口扫描 (Port Scanning)
如果把服务器比作一栋大楼，端口就是门窗。
- **扫描**：就是去敲每一扇门（1-65535），看哪扇是开着的。
- **状态**：
  - `Open`：门开着，有人应答（服务在运行）。
  - `Closed`：门关着，有人说“没人”（明确拒绝，RST包）。
  - `Filtered`：门前有保安（防火墙），没有任何回应（丢包）。

#### 1.1.2 漏洞扫描 (Vulnerability Scanning)
- **定义**：不仅知道门开着，还进去检查锁是不是坏的（版本过低），窗户是不是没关严（配置错误）。
- **工具**：Nessus (商业老大), OpenVAS (开源), GVM。

### 二、原理讲解

#### 1.2.1 Nmap 工作原理
- **TCP Connect 扫描 (-sT)**：完成三次握手。最可靠，但最慢，且会在服务器日志留下完整记录。
- **SYN 扫描 (-sS)**：只发第一次握手包 (SYN)，服务器回 SYN-ACK 后，立刻发 RST 断开。**不完成连接，隐蔽且快**（需要 root 权限）。
- **版本探测 (-sV)**：发送特定的探测包（如 HTTP 请求），分析服务器的回包特征（如 `Server: Apache/2.4.41`），从而判断软件版本。

#### 1.2.2 Nessus 工作原理
- **插件库 (Plugins)**：Nessus 有几万个插件，每个插件对应一个 CVE。
- **Banner 匹配**：看版本号（如 IIS 6.0 -> 有解析漏洞）。
- **登录扫描 (Credentialed Scan)**：你给它账号密码，它登录进去检查注册表、补丁号和文件版本。**这是最准确的扫描方式**。

### 三、技术细节

#### 1.3.1 Nmap 常用指令集（背诵全文！）
```bash
# 1. 基础体检 (最常用)
nmap -sS -sV -p- -T4 <target>
# -sS: 半连接扫描
# -sV: 显示服务版本
# -p-: 扫描所有 65535 个端口
# -T4: 速度快一点 (0-5, 默认为3)

# 2. 漏洞探测 (NSE)
nmap --script=vuln <target>
# 调用所有属于 vuln 类别的脚本

# 3. 针对性扫描 (比如扫永恒之蓝)
nmap -p 445 --script=smb-vuln-ms17-010 <target>
```

#### 1.3.2 扫描器的局限性
千万不要迷信扫描器！
1.  **误报 (False Positive)**：扫描器说有洞，其实没有。比如 Banner 显示是旧版本，但管理员已经打过补丁了（Backporting）。
2.  **漏报 (False Negative)**：扫描器没扫出来，但其实有洞。比如逻辑漏洞（越权访问），扫描器是扫不出来的，必须靠人。
3.  **危险操作**：有些扫描插件（如拒绝服务检测）可能会把目标扫挂。生产环境请务必使用“安全模式”。

### 四、进阶知识（选学）

#### 1.4.1 逃避防火墙 (Evasion)
- **分片 (-f)**：把数据包切碎发送，绕过简单的包过滤。
- **诱饵 (-D)**：伪造一堆假 IP 一起扫描，让管理员分不清谁是真凶。
- **修改源端口 (--source-port)**：假装自己是 DNS (53) 或 HTTP (80) 流量。

### 五、本日知识点速查表

| 序号 | 核心概念 | 关键点 | 备注 |
|------|----------|--------|------|
| 1 | **-sS** | SYN 扫描 | 默认、快速、隐蔽 |
| 2 | **-sV** | 版本探测 | 识别服务具体版本 |
| 3 | **NSE** | Nmap 脚本 | 让 Nmap 变成漏扫工具 |
| 4 | **误报** | False Positive | 假的漏洞 |
| 5 | **登录扫描** | Credentialed Scan | 给账号进去扫，最准 |

---

## 🗺️ 知识图谱

### 今日内容在整体知识体系中的位置

```
网络安全学习路径
├── 第 4 周：漏洞扫描与基线
│   ├── Day022：理论 (CVE)
│   ├── Day023：侦察 (OSINT)
│   └── Day024：主动扫描 (Nmap/Nessus)
│       ├── 端口发现 (Port Discovery)
│       ├── 服务识别 (Service Version)
│       └── 漏洞验证 (Vuln Script)
└── 后续衔接
    └── Day025：Web 协议与 Burp Suite
```

### 今日关键词

`Nmap` · `-sS` · `Nessus` · `False Positive`

---

## 🔧 实践任务（合法授权范围内）

> ⚠️ **安全提示**：请使用自己的靶机（如 Metasploitable2）或本地虚拟机进行测试。

请按顺序完成以下任务：

### 任务 1：Nmap 进阶实战（30 分钟）

**操作步骤**：
1. 启动你的靶机（如 Metasploitable2）。
2. 使用 NSE 脚本扫描 FTP 服务：
   `nmap -p 21 --script=ftp-anon,ftp-brute <target_ip>`
3. **观察**：能扫出匿名登录允许（Anonymous allowed）吗？

**预期结果**：成功发现 FTP 允许匿名登录。

### 任务 2：安装 Nessus (或 OpenVAS)（60 分钟）

**操作步骤**：
1. 访问 Tenable 官网下载 Nessus Essentials（免费版）。
2. 在虚拟机中安装。
3. 访问 `https://localhost:8834`，完成初始化（下载插件可能需要很久，耐心等待）。
4. **注意**：如果不方便安装，可以找网上的在线演示或截图学习界面。

**预期结果**：成功进入 Nessus 管理界面。

### 任务 3：执行第一次漏扫（30 分钟）

**操作步骤**：
1. 在 Nessus 中新建扫描 -> 选择 "Basic Network Scan"。
2. 目标填你的靶机 IP。
3. 启动扫描。
4. **分析报告**：
    - 有几个红色（Critical）漏洞？
    - 点进去看详情，它建议怎么修？（通常是 Upgrade to version x.x）。

**预期结果**：得到一份图文并茂的漏洞报告。

---

## 📝 巩固练习（题目与复盘）

### 练习 1：概念理解（5 分钟）

**题目**：为什么有时候 Nmap 扫出来的端口状态是 `filtered`？

**参考答案**：表示端口被防火墙挡住了，Nmap 收不到任何回应（既没 ACK 也没 RST），不知道是开还是关。通常是因为防火墙丢弃了入站的 SYN 包。

### 练习 2：实操复盘（5 分钟）

**题目**：Nessus 报告里提示 "Apache Version < 2.4.49"，但管理员发誓已经升级了，这是怎么回事？

**参考答案**：这可能是**误报**。如果管理员只是修补了漏洞但没有修改 Apache 的版本号（或者 Linux 发行版采用了“旧版本内核+安全补丁”的策略），Nessus 这种基于 Banner 的检测就会误判。验证方法是：尝试利用该漏洞（POC），如果利用失败，就是误报。

---

## ✅ 评估标准（达成判定）

- [ ] 我能熟练打出 Nmap 的万能扫描命令 (`-sS -sV -p-`)。
- [ ] 我理解为什么扫描器会有误报。
- [ ] 我成功安装并运行了一次 Nessus 扫描。

### 自检清单

- [ ] **概念理解**：能解释 SYN 扫描和 Connect 扫描的区别。
- [ ] **实际应用**：会用 nmap 脚本扫 smb 漏洞。
- [ ] **安全意识**：不在生产环境盲目使用高强度扫描。

### 学习进度自评

| 评估项目 | 1-5 星 | 备注 |
|----------|--------|------|
| 命令行熟练度 | ⭐⭐⭐⭐⭐ | |
| 报告分析能力 | ⭐⭐⭐⭐⭐ | |
| 工具安装 | ⭐⭐⭐⭐⭐ | |

---

## 📊 学习成果记录（由学习者填写）

### 学习信息

| 项目 | 内容 |
|------|------|
| 学习日期 | 2026-02-15 |
| 学习时长 | ___ 小时 |
| 完成情况 | ⬜ 已完成 / ⬜ 部分完成 / ⬜ 未完成 |

### 实践任务完成记录

| 任务 | 完成状态 | 关键证据/截图 |
|------|----------|---------------|
| 任务 1 | ⬜ 已完成 | 截图：Nmap 扫描结果 |
| 任务 2 | ⬜ 已完成 | 截图：Nessus 登录界面 |
| 任务 3 | ⬜ 已完成 | 截图：Nessus 扫描报告概览 |

---

## 💡 知识卡片速查

### Nmap 常用参数

| 参数 | 含义 | 场景 |
|------|------|------|
| `-sS` | SYN 扫描 | 默认，隐蔽 |
| `-sV` | 版本探测 | 查软件版本 |
| `-O` | 系统探测 | 查是 Linux 还是 Windows |
| `-p-` | 全端口 | 扫所有 65535 个端口 |
| `-A` | 综合扫描 | 版本+系统+脚本+路由 |

### 端口状态速查

| 状态 | 含义 |
|------|------|
| **Open** | 开放，服务在线 |
| **Closed** | 关闭，拒绝连接 |
| **Filtered** | 被防火墙拦截 |

---

## ❓ 常见问题与解答

**Q1：Nmap 扫描速度太慢怎么办？**
A1：可以加 `-T4`（提速），或者 `-n`（不解析域名），或者只扫常见端口 `-F`。

**Q2：Nessus 扫出来全是低危漏洞怎么办？**
A2：说明目标打补丁很勤快，或者你的扫描策略太保守。尝试配置“登录扫描”，或者换个思路去挖逻辑漏洞（这是扫描器的盲区）。

---

## 🚀 下一步学习预告

**明日主题预告**：Day025 - Web 架构与 HTTP 协议

**学习重点预告**：
- 深入 Web 世界，理解 Request 和 Response。
- 学习使用 Burp Suite 抓包改包。
- 理解 Cookie 和 Session。

**今日学习为明日做铺垫**：
- 今天我们扫描到了开放的 80/443 端口，明天我们要“走进”这两个端口，看看 Web 应用内部的秘密。

---

> 💬 **学习提示**：
> 1. Nmap 是基本功，一定要多练，背下来常用参数。
> 2. 扫描器只是辅助，不要过度依赖。真正的高手都是用脑子挖漏洞的。
> 3. **再次强调**：禁止对未授权目标进行扫描！扫描本身就是一种攻击行为。

```bash
git add daily/Day024.md
git commit -m "Day024: 完成学习与记录"
```
